define(["knockout","jquery","ojs/ojvalidationgroup"],function(e,a){return function(o){var l=this;l.props=o.properties,l.dialogTableOptions=e.observable(),l.dialogValue=e.observable(),l.dialogTableDataArray=e.observableArray([]),l.showLabel=e.observable(!0),l.maxColumns=e.observable(2),l.hasFilter=e.observable(!1),l.hasFilter(l.props.dialogQueryParams.length>0),l.valuesVar=e.observable(),l.required=e.observable(!l.props.required||!0!==l.props.required),l.groupValid=e.observable(),l.tracker=e.observable(),console.log("valueDlg_"+l.props.id),l.nameinputtext=document.getElementById("valueDlg_"+l.props.id),l.submit=function(){document.getElementById("valueDlg_"+l.props.id);var e=document.getElementById("tracker");"valid"===e.valid?alert("everything is valid; submit the form"):(e.showMessages(),e.focusOn("@firstInvalidShown"))},l.onClickSearch=function(){l.initializeTableFromService()},l.onClickReset=function(){l.resetValueParams()},l.onClickCancel=function(){l.closeDialog()},l.onClickSelectAndClose=function(){o.element.dispatchEvent(new CustomEvent("selectDialog",l.selectedDlgTableRow())),l.closeDialog()},l.onOpenDialog=function(){l.openDialog(),!0===l.props.initTableOnLoad&&l.initializeTableFromService()},l.onDialogSelectTable=e.observable(),l.selectedDlgTableRow=e.observable(),l.dlgDataSource=new oj.PagingTableDataSource(new oj.ArrayTableDataSource(l.dialogTableDataArray,{idAttribute:l.props.dialogTablePrimaryKey})),l.onDialogSelectTable=function(e,a){var o=a.currentRow.rowIndex;l.dlgDataSource.at(o).then(function(e){l.selectedDlgTableRow(l.getOutputParams(e.data))})},l.activated=function(e){var a={component:"ojTable",data:l.dlgDataSource,columns:l.props.dialogTableColumns,display:"grid",rootAttributes:{style:"width:100%;overflow-x: auto; overflow-y: hidden;"},selectionMode:{row:"single"},scrollPolicyOptions:"auto",columnsDefault:{sortable:"auto"}};a.beforeCurrentRow=l.onDialogSelectTable,a.currentRow={rowKey:l.props.value},l.dialogTableOptions(a)},l.initializeTableFromService=function(){return l.dialogTableDataArray([]),new Promise(function(e,a){var o=[],r=[];l.props.dialogQueryParams.forEach(function(e){o.push(e.paramName),r.push(l.getValueOfParam(e.paramName))}),getRestData(l.props.serviceUrl,o,r,function(a){"ERROR"!==a?a.content.forEach(function(e){l.dialogTableDataArray.push(e)}):l.dialogTableDataArray([]),e(!0)})})},l.openDialog=function(){document.querySelector("#dlgModal_"+l.props.id).open()},l.closeDialog=function(){document.querySelector("#dlgModal_"+l.props.id).close()},l.getOutputParams=function(e){return{bubbles:!0,detail:{value:e}}},l.getValueOfParam=function(e){return a("#input_"+l.props.id+"_"+e).val()},l.setValueOfParam=function(e,o){a("#input_"+l.props.id+"_"+e).val(o)},l.resetValueParams=function(){l.props.dialogQueryParams.forEach(function(e){l.setValueOfParam(e.paramName,"")})}}});
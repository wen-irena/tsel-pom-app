define(["ojs/ojcore","knockout","jquery","../appController","common/constants","common/configService","common/restService","common/rendererService","serviceUtils","ojs/ojdatetimepicker","ojs/ojvalidation-datetime","ojs/ojdiagram"],function(o,e,a,t,r,l,c,n){return function(){var r=this;r.collectionDashboard_bridgingIncoming=e.observable(),r.collectionDashboard_bridgingSuccess=e.observable(0),r.collectionDashboard_bridgingFailed=e.observable(0),r.collectionDashboard_omsIncoming=e.observable(0),r.collectionDashboard_omsSuccess=e.observable(0),r.collectionDashboard_omsFailed=e.observable(0),r.collectionDashboard_proIncoming=e.observable(0),r.collectionDashboard_proSuccess=e.observable(0),r.collectionDashboard_proFailed=e.observable(0),r.collectionDashboard_msisdn=e.observable(),r.collectionDashboard_action=e.observableArray(),r.collectionDashboard_actionLOV=e.observableArray(),r.collectionDashboard_startDateTime=e.observable(),r.collectionDashboard_endDateTime=e.observable();var l=new Date,i=new Date(l.getFullYear(),l.getMonth(),1);new Date(l.getFullYear(),l.getMonth()+1,0),r.collectionDashboard_startDate=e.observable(n.dateLASConverter.format(o.IntlConverterUtils.dateToLocalIso(i))),r.collectionDashboard_endDate=e.observable(n.dateLASConverter.format(o.IntlConverterUtils.dateToLocalIso(l))),r.collectionDashboard_dateConverter=n.dateConverter,r.collectionDashboard_currencyConverter=o.Validation.converterFactory("number").createConverter({pattern:"#,##0"}),r.amountRenderer=function(o){if(o){var e=o;return r.collectionDashboard_currencyConverter.format(e)}return o},getRestData(c.getLOV,["lovName"],["LOV_COLMNT_ACTION"],function(o){if(o){let e=o.filter(o=>o.enable).map(o=>({label:o.lookupValue2,value:o.lookupValue2}));r.collectionDashboard_actionLOV(e)}}),r.collectionDashboard_refreshData=function(){let e=new Date,a=n.backenddateTimeConverter.format(o.IntlConverterUtils.dateToLocalIso(e));r.collectionDashboard_startDateTime(r.collectionDashboard_startDate()+"T00:00:00.000"),a.split("T")[0]===r.collectionDashboard_endDate()?r.collectionDashboard_endDateTime(a):r.collectionDashboard_endDateTime(r.collectionDashboard_endDate()+"T23:59:59.999"),console.log(r.collectionDashboard_endDateTime()),r.collectionDashboard_refreshDataTotal(),r.collectionDashboard_refreshDataDaily()},r.collectionDashboard_refreshDataTotal=function(){r.collectionDashboard_bridgingIncoming(0),r.collectionDashboard_bridgingSuccess(0),r.collectionDashboard_bridgingFailed(0),r.collectionDashboard_omsIncoming(0),r.collectionDashboard_omsSuccess(0),r.collectionDashboard_omsFailed(0),r.collectionDashboard_proIncoming(0),r.collectionDashboard_proSuccess(0),r.collectionDashboard_proFailed(0);let o=[],e=[];r.collectionDashboard_startDateTime&&r.collectionDashboard_startDateTime()&&(o.push("startDate"),e.push(r.collectionDashboard_startDateTime())),r.collectionDashboard_endDateTime&&r.collectionDashboard_endDateTime()&&(o.push("endDate"),e.push(r.collectionDashboard_endDateTime())),r.collectionDashboard_action&&r.collectionDashboard_action()&&(o.push("action"),e.push(r.collectionDashboard_action())),r.collectionDashboard_msisdn&&r.collectionDashboard_msisdn()&&(o.push("msisdn"),e.push(r.collectionDashboard_msisdn())),getRestData(c.getCollectionDashboard,o,e,function(o,e){"ERROR"!==o&&(r.collectionDashboard_bridgingIncoming(o.bridgingTotal?o.bridgingTotal:0),r.collectionDashboard_bridgingSuccess(o.bridgingSuccess?o.bridgingSuccess:0),r.collectionDashboard_bridgingFailed(o.bridgingError?o.bridgingError:0),r.collectionDashboard_omsIncoming(o.omsTotal?o.omsTotal:0),r.collectionDashboard_omsSuccess(o.omsSuccess?o.omsSuccess:0),r.collectionDashboard_omsFailed(o.omsError?o.omsError:0),r.collectionDashboard_proIncoming(o.proTotal?o.proTotal:0),r.collectionDashboard_proSuccess(o.proSuccess?o.proSuccess:0),r.collectionDashboard_proFailed(o.proError?o.proError:0))})},r.collectionDashboard_refreshDataDaily=function(){let o=[],e=[];r.collectionDashboard_startDateTime&&r.collectionDashboard_startDateTime()&&(o.push("startDate"),e.push(r.collectionDashboard_startDateTime())),r.collectionDashboard_endDateTime&&r.collectionDashboard_endDateTime()&&(o.push("endDate"),e.push(r.collectionDashboard_endDateTime())),getRestData(c.getCollectionTotalDaily,o,e,function(o,e){"ERROR"!==o&&r.mixedSeriesValue(o.chartTypeList)})},r.collectionDashboard_onSearch=function(){r.collectionDashboard_refreshData()},r.collectionDashboard_onSearchHourly=function(){r.collectionDashboard_refreshHourly()},r.selectedItemsValue=e.observable();var s=o.Validation.converterFactory(o.ConverterFactory.CONVERTER_TYPE_DATETIME);r.dayMonth=s.createConverter({day:"numeric",month:"numeric"}),r.year=s.createConverter({year:"numeric"}),r.dayMonthYear=s.createConverter({year:"2-digit",month:"numeric",day:"numeric"}),r.hourConverter=s.createConverter({pattern:"HH:mm"});var d=o.Validation.converterFactory("number");r.y2Converter=d.createConverter({style:"percent"}),r.orientationValue=e.observable("vertical"),r.xAxisOptions2=e.observable({tickLabel:{converter:[e.toJS(r.hourConverter)]}}),r.shortDateConverter=o.Validation.converterFactory(o.ConverterFactory.CONVERTER_TYPE_DATETIME).createConverter({pattern:"dd/MM/yy"}),r.xAxisOptions=e.observable({tickLabel:{converter:[e.toJS(r.shortDateConverter)]}}),r.mixedSeriesValue=e.observableArray(),r.mixedGroupsValue=e.observableArray(["test1","test2"]),r.collectionDashboardHourly_startDate=e.observable(),r.collectionDashboardHourly_endDate=e.observable(),r.collectionDashboard_percentageRenderer=function(o){return n.percentageRenderer(o)},r.selectionListener=function(o){var e=o.detail.selectionData[0].data.x.slice(0,10);r.collectionDashboardHourly_startDate(e+"T00:00:00.000"),e===r.collectionDashboard_endDate()?r.collectionDashboardHourly_endDate(r.collectionDashboard_endDateTime()):r.collectionDashboardHourly_endDate(e+"T23:59:59.999"),a("#servicemonitoring_detail").removeClass("oj-sm-hide oj-md-hide oj-lg-hide oj-xl-hide"),r.collectionDashboard_refreshDataDetail()},r.collectionDashboard_refreshDataDetail=function(){let o=[],e=[];r.collectionDashboardHourly_startDate&&r.collectionDashboardHourly_startDate()&&(o.push("startDate"),e.push(r.collectionDashboardHourly_startDate())),r.collectionDashboardHourly_endDate&&r.collectionDashboardHourly_endDate()&&(o.push("endDate"),e.push(r.collectionDashboardHourly_endDate())),getRestData(c.getCollectionTotalHourly,o,e,function(o,e){"ERROR"!==o&&r.mixedSeriesValueHourly(o.chartTypeList)}),getRestData(c.getCollectionTopOrderType,o,e,function(o,e){"ERROR"!==o&&r.collectionDashboard_allData(o.content)})},r.collectionDashboard_refreshDataAll=function(){r.collectionDashboard_refreshData(),r.collectionDashboardHourly_startDate()&&r.collectionDashboardHourly_endDate()&&r.collectionDashboard_refreshDataDetail()},r.mixedSeriesValueHourly=e.observableArray(),r.mixedGroupsValueHourly=e.observableArray(["test1","test2"]),r.collectionDashboard_columns=[{headerText:"Order Type",field:"action"},{headerText:"Target",field:"toSystem"},{headerText:"Total",field:"totalOrder"}],r.collectionDashboard_allData=e.observableArray(),r.collectionDashboard_tableWidth=e.observable("100%"),r.collectionDashboard_display="grid",r.collectionDashboard_columnsDefault={sortable:"auto"},r.collectionDashboard_scrollPolicy="loadMoreOnScroll",r.collectionDashboard_scrollPolicyOptions={fetchSize:10},r.collectionDashboard_rootAttributes={style:"width:100%;overflow-x: auto; overflow-y: hidden;"},r.collectionDashboard_selectionMode={row:"single"},r.collectionDashboard_datasource=new o.PagingTableDataSource(new o.ArrayTableDataSource(r.collectionDashboard_allData,{idAttribute:"seq"})),r.collectionDashboard_fetchSize=e.observable(),r.collectionDashboard_selectedRow=e.observable(),r.collectionDashboardTopSales_columns=[{headerText:"Sales Channel",field:"salesChannel"},{headerText:"<= 5 Min",field:"totalOrderLe5min"},{headerText:"> 5 Min",field:"totalOrderGt5min"},{headerText:"SR",field:"sr",renderer:r.collectionDashboard_percentageRenderer,style:"text-align:right"}],r.collectionDashboardTopSales_allData=e.observableArray(),r.collectionDashboardTopSales_datasource=new o.PagingTableDataSource(new o.ArrayTableDataSource(r.collectionDashboardTopSales_allData,{idAttribute:"seq"})),r.styleDefaults=e.pureComputed(function(){return{barGapRatio:.74,markerDisplayed:"on"}}),r.styleDefaults2=e.pureComputed(function(){return{barGapRatio:.5,markerDisplayed:"on"}}),r.onClickBridgingIncoming=function(){const o={target:null,status:null,startDate:r.collectionDashboard_startDateTime(),endDate:r.collectionDashboard_endDateTime(),msisdn:r.collectionDashboard_msisdn(),action:r.collectionDashboard_action()};t.redirect("collectionmonitoring",o)},r.onClickBridgingSuccess=function(){const o={target:null,status:"SUCCESS",startDate:r.collectionDashboard_startDateTime(),endDate:r.collectionDashboard_endDateTime(),msisdn:r.collectionDashboard_msisdn(),action:r.collectionDashboard_action()};t.redirect("collectionmonitoring",o)},r.onClickBridgingFailed=function(){const o={target:null,status:"ERROR",startDate:r.collectionDashboard_startDateTime(),endDate:r.collectionDashboard_endDateTime(),msisdn:r.collectionDashboard_msisdn(),action:r.collectionDashboard_action()};t.redirect("collectionmonitoring",o)},r.onClickOmsIncoming=function(){const o={target:"OMS",status:null,startDate:r.collectionDashboard_startDateTime(),endDate:r.collectionDashboard_endDateTime(),msisdn:r.collectionDashboard_msisdn(),action:r.collectionDashboard_action()};t.redirect("collectionmonitoring",o)},r.onClickOmsSuccess=function(){const o={target:"OMS",status:"SUCCESS",startDate:r.collectionDashboard_startDateTime(),endDate:r.collectionDashboard_endDateTime(),msisdn:r.collectionDashboard_msisdn(),action:r.collectionDashboard_action()};t.redirect("collectionmonitoring",o)},r.onClickOmsFailed=function(){const o={target:"OMS",status:"ERROR",startDate:r.collectionDashboard_startDateTime(),endDate:r.collectionDashboard_endDateTime(),msisdn:r.collectionDashboard_msisdn(),action:r.collectionDashboard_action()};t.redirect("collectionmonitoring",o)},r.onClickProIncoming=function(){const o={target:"PRO",status:null,startDate:r.collectionDashboard_startDateTime(),endDate:r.collectionDashboard_endDateTime(),msisdn:r.collectionDashboard_msisdn(),action:r.collectionDashboard_action()};t.redirect("collectionmonitoring",o)},r.onClickProSuccess=function(){const o={target:"PRO",status:"SUCCESS",startDate:r.collectionDashboard_startDateTime(),endDate:r.collectionDashboard_endDateTime(),msisdn:r.collectionDashboard_msisdn(),action:r.collectionDashboard_action()};t.redirect("collectionmonitoring",o)},r.onClickProFailed=function(){const o={target:"PRO",status:"ERROR",startDate:r.collectionDashboard_startDateTime(),endDate:r.collectionDashboard_endDateTime(),msisdn:r.collectionDashboard_msisdn(),action:r.collectionDashboard_action()};t.redirect("collectionmonitoring",o)},r.collectionDashboard_refreshData()}});
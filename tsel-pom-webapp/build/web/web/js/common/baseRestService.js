"use strict";define(["ojs/ojcore","knockout","common/configService","ojs/ojmodel"],function(e,r,t){return function(n,o,c,u,l){var i=this;i.fetchSize=u||-1,i.getRestServiceUrl=function(e,r){var n,o=(n=l?t[l]+("/"===t[l][t[l].length-1]?"":"/")+e:t.serviceUrl+("/"===t.serviceUrl[t.serviceUrl.length-1]?"":"/")+e).indexOf("://");return o>=0?n=n.substr(0,o)+"://"+n.substr(o+3).replace("//","/"):n.replace("//","/"),"/"===n[n.length-1]&&(n=n.substr(0,n.length-1)),n},i.getRestServiceAdmUrl=function(e){var r,n=(r=l?t[l]+("/"===t[l][t[l].length-1]?"":"/")+e:t.serviceAdmUrl+("/"===t.serviceAdmUrl[t.serviceAdmUrl.length-1]?"":"/")+e).indexOf("://");return n>=0?r=r.substr(0,n)+"://"+r.substr(n+3).replace("//","/"):r.replace("//","/"),"/"===r[r.length-1]&&(r=r.substr(0,r.length-1)),r},i.baseUrl=i.getRestServiceUrl(n),i.propertyId=o,i.objectEnclosure=c,i.createModel=function(r){var t=new(e.Model.extend({urlRoot:i.baseUrl,customURL:function(e,r,t){return"create"===e?{url:i.baseUrl,type:"PUT"}:"update"===e?{url:i.baseUrl+"?"+o+"="+t.recordID,type:"PUT"}:"get"===e?{url:i.baseUrl+"?"+o+"="+t.recordID,type:"GET"}:"delete"===e?{url:i.baseUrl+"?"+o+"="+t.recordID,type:"DELETE"}:void 0},idAttribute:i.propertyId,parse:function(e){var r={};for(var t in e)e.hasOwnProperty(t)&&(e[t]&&e[t].hasOwnProperty("@nil")&&"true"===e[t]["@nil"]?r[t]=void 0:r[t]=e[t]);return r},parseSave:function(e){if(i.objectEnclosure){var r={};return r[i.objectEnclosure]=[e],r}return e}}));if(r)for(var n in r)r.hasOwnProperty(n)&&(t.attributes[n]=r[n]);return t},i.createCollection=function(){return new(e.Collection.extend({url:i.baseUrl,model:new i.createModel,fetchSize:i.fetchSize,parse:function(e){return i.objectEnclosure?e.hasOwnProperty(i.objectEnclosure)?e[i.objectEnclosure]:void 0:e},customURL:function(e,r,t){var n="";if("read"===e){if(t.query)for(var o in t.query)""!==n&&(n+="&"),t.query.hasOwnProperty(o)&&(n+=o+"="+t.query[o]);return{url:i.baseUrl+(""!==n?"?"+n:""),type:"GET"}}return null}}))},i.fetchAsLOV=function(e,t){return new Promise(function(n,o){var c=i.createCollection();c.fetch({success:function(o,u){var l=c.toJSON(),i=[];r.utils.arrayForEach(l,function(r){if(!r.hasOwnProperty("active")||"Y"===r.active){var n=r[e],o=r[t];i.push({label:n,value:o})}}),n(i)},error:function(e,r){o("failed")}})})},i.fetchAsLOVForSRPSPB=function(e,t,n){return new Promise(function(o,c){var u=i.createCollection();u.fetch({success:function(c,l){var i=u.toJSON(),s=[];r.utils.arrayForEach(i,function(r){if("Y"===r.active){var o=r[e];if("SRP"===(c=r[t])){o="MGP SRP";var c="mgprate"===n?"MGP SRP":r.prodId;s.push({label:o,value:c})}else"SPB"===c&&(o="MGP SPB",c="mgprate"===n?"MGP SPB":r.prodId,s.push({label:o,value:c}))}}),o(s)},error:function(e,r){c("failed")}})})}}});
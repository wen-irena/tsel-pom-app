!function(t,e){"object"==typeof exports&&"string"!=typeof exports.nodeName?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("blobjs requires a window with a document");return e(t)}:e(t)}(window||this,function(t,e){"use strict";var n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(t.URL=t.URL||t.webkitURL,t.Blob&&t.URL&&!n)try{return new t.Blob,"function"==typeof define&&define.amd&&define("blobjs",[],function(){return t.Blob}),t.Blob}catch(t){}var o=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||function(t){var e=function(t){return Object.prototype.toString.call(t).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},o=function(t,e,n){this.data=t,this.size=t.length,this.type=e,this.encoding=n},i=n.prototype,r=o.prototype,a=t.FileReaderSync,c=function(t){this.code=this[this.name=t]},u="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),d=u.length,s=t.URL||t.webkitURL||t,l=s.createObjectURL,f=s.revokeObjectURL,p=s,b=t.btoa,R=t.atob,h=t.ArrayBuffer,g=t.Uint8Array,w=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(o.fake=r.fake=!0;d--;)c.prototype[u[d]]=d+1;return s.createObjectURL||(p=t.URL=function(t){var e,n=document.createElementNS("http://www.w3.org/1999/xhtml","a");return n.href=t,"origin"in n||("data:"===n.protocol.toLowerCase()?n.origin=null:(e=t.match(w),n.origin=e&&e[1])),n}),p.createObjectURL=function(t){var e,n=t.type;return null===n&&(n="application/octet-stream"),t instanceof o?(e="data:"+n,"base64"===t.encoding?e+";base64,"+t.data:"URI"===t.encoding?e+","+decodeURIComponent(t.data):b?e+";base64,"+b(t.data):e+","+encodeURIComponent(t.data)):l?l.call(s,t):void 0},p.revokeObjectURL=function(t){"data:"!==t.substring(0,5)&&f&&f.call(s,t)},i.append=function(t){var n=this.data;if(g&&(t instanceof h||t instanceof g)){for(var i="",r=new g(t),u=0,d=r.length;u<d;u++)i+=String.fromCharCode(r[u]);n.push(i)}else if("Blob"===e(t)||"File"===e(t)){if(!a)throw new c("NOT_READABLE_ERR");var s=new a;n.push(s.readAsBinaryString(t))}else t instanceof o?"base64"===t.encoding&&R?n.push(R(t.data)):"URI"===t.encoding?n.push(decodeURIComponent(t.data)):"raw"===t.encoding&&n.push(t.data):("string"!=typeof t&&(t+=""),n.push(unescape(encodeURIComponent(t))))},i.getBlob=function(t){return arguments.length||(t=null),new o(this.data.join(""),t,"raw")},i.toString=function(){return"[object BlobBuilder]"},r.slice=function(t,e,n){var i=arguments.length;return i<3&&(n=null),new o(this.data.slice(t,i>1?e:this.data.length),n,this.encoding)},r.toString=function(){return"[object Blob]"},r.close=function(){this.size=0,delete this.data},n}(t),i=function(t,e){var n=e&&e.type||"",i=new o;if(t)for(var r=0,a=t.length;r<a;r++)Uint8Array&&t[r]instanceof Uint8Array?i.append(t[r].buffer):i.append(t[r]);var c=i.getBlob(n);return!c.slice&&c.webkitSlice&&(c.slice=c.webkitSlice),c},r=Object.getPrototypeOf||function(t){return t.__proto__};return i.prototype=r(new t.Blob),"function"==typeof define&&define.amd&&define("blobjs",[],function(){return i}),void 0===e&&(t.Blob=i),i});
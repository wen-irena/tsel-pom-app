import parseCode from"./parseCode";import extend from"./extend";import projections from"./projections";import{sphere as dc_sphere,eccentricity as dc_eccentricity}from"./deriveConstants";import Datum from"./constants/Datum";import datum from"./datum";import match from"./match";function Projection(e,t){if(!(this instanceof Projection))return new Projection(e);t=t||function(e){if(e)throw e};var o=parseCode(e);if("object"==typeof o){var r=Projection.projections.get(o.projName);if(r){if(o.datumCode&&"none"!==o.datumCode){var i=match(Datum,o.datumCode);i&&(o.datum_params=i.towgs84?i.towgs84.split(","):null,o.ellps=i.ellipse,o.datumName=i.datumName?i.datumName:o.datumCode)}o.k0=o.k0||1,o.axis=o.axis||"enu",o.ellps=o.ellps||"wgs84";var s=dc_sphere(o.a,o.b,o.rf,o.ellps,o.sphere),a=dc_eccentricity(s.a,s.b,s.rf,o.R_A),m=o.datum||datum(o.datumCode,o.datum_params,s.a,s.b,a.es,a.ep2);extend(this,o),extend(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=m,this.init(),t(null,this)}else t(e)}else t(e)}Projection.projections=projections,Projection.projections.start();export default Projection;
import mlfn from"../common/mlfn";import e0fn from"../common/e0fn";import e1fn from"../common/e1fn";import e2fn from"../common/e2fn";import e3fn from"../common/e3fn";import gN from"../common/gN";import adjust_lon from"../common/adjust_lon";import adjust_lat from"../common/adjust_lat";import imlfn from"../common/imlfn";import{HALF_PI,EPSLN}from"../constants/values";export function init(){this.sphere||(this.e0=e0fn(this.es),this.e1=e1fn(this.es),this.e2=e2fn(this.es),this.e3=e3fn(this.es),this.ml0=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0))};export function forward(t){var s,i,a=t.x,h=t.y;if(a=adjust_lon(a-this.long0),this.sphere)s=this.a*Math.asin(Math.cos(h)*Math.sin(a)),i=this.a*(Math.atan2(Math.tan(h),Math.cos(a))-this.lat0);else{var n=Math.sin(h),e=Math.cos(h),o=gN(this.a,this.e,n),m=Math.tan(h)*Math.tan(h),r=a*Math.cos(h),f=r*r,l=this.es*e*e/(1-this.es);s=o*r*(1-f*m*(1/6-(8-m+8*l)*f/120)),i=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,h)-this.ml0+o*n/e*f*(.5+(5-m+6*l)*f/24)}return t.x=s+this.x0,t.y=i+this.y0,t};export function inverse(t){t.x-=this.x0,t.y-=this.y0;var s,i,a=t.x/this.a,h=t.y/this.a;if(this.sphere){var n=h+this.lat0;s=Math.asin(Math.sin(n)*Math.cos(a)),i=Math.atan2(Math.tan(a),Math.cos(n))}else{var e=this.ml0/this.a+h,o=imlfn(e,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-HALF_PI)<=EPSLN)return t.x=this.long0,t.y=HALF_PI,h<0&&(t.y*=-1),t;var m=gN(this.a,this.e,Math.sin(o)),r=m*m*m/this.a/this.a*(1-this.es),f=Math.pow(Math.tan(o),2),l=a*this.a/m,M=l*l;s=o-m*Math.tan(o)/r*l*l*(.5-(1+3*f)*l*l/24),i=l*(1-M*(f/3+(1+3*f)*f*M/15))/Math.cos(o)}return t.x=adjust_lon(i+this.long0),t.y=adjust_lat(s),t};export var names=["Cassini","Cassini_Soldner","cass"];export default{init:init,forward:forward,inverse:inverse,names:names};
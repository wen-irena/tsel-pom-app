import adjust_lon from"../common/adjust_lon";import adjust_lat from"../common/adjust_lat";import pj_enfn from"../common/pj_enfn";var MAX_ITER=20;import pj_mlfn from"../common/pj_mlfn";import pj_inv_mlfn from"../common/pj_inv_mlfn";import{EPSLN,HALF_PI}from"../constants/values";import asinz from"../common/asinz";export function init(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=pj_enfn(this.es)};export function forward(t){var s,i,n=t.x,h=t.y;if(n=adjust_lon(n-this.long0),this.sphere){if(this.m)for(var a=this.n*Math.sin(h),o=MAX_ITER;o;--o){var r=(this.m*h+Math.sin(h)-a)/(this.m+Math.cos(h));if(h-=r,Math.abs(r)<EPSLN)break}else h=1!==this.n?Math.asin(this.n*Math.sin(h)):h;s=this.a*this.C_x*n*(this.m+Math.cos(h)),i=this.a*this.C_y*h}else{var m=Math.sin(h),e=Math.cos(h);i=this.a*pj_mlfn(h,m,e,this.en),s=this.a*n*e/Math.sqrt(1-this.es*m*m)}return t.x=s,t.y=i,t};export function inverse(t){var s,i,n,h;return t.x-=this.x0,n=t.x/this.a,t.y-=this.y0,s=t.y/this.a,this.sphere?(s/=this.C_y,n/=this.C_x*(this.m+Math.cos(s)),this.m?s=asinz((this.m*s+Math.sin(s))/this.n):1!==this.n&&(s=asinz(Math.sin(s)/this.n)),n=adjust_lon(n+this.long0),s=adjust_lat(s)):(s=pj_inv_mlfn(t.y/this.a,this.es,this.en),(h=Math.abs(s))<HALF_PI?(h=Math.sin(s),i=this.long0+t.x*Math.sqrt(1-this.es*h*h)/(this.a*Math.cos(s)),n=adjust_lon(i)):h-EPSLN<HALF_PI&&(n=this.long0)),t.x=n,t.y=s,t};export var names=["Sinusoidal","sinu"];export default{init:init,forward:forward,inverse:inverse,names:names};
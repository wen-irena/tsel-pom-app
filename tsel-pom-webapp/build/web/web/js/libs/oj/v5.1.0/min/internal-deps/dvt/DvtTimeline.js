"use strict";define(["./DvtToolkit","./DvtTimeAxis","./DvtOverview","./DvtTimeComponent"],function(e){return function(e){e.TimelineOverview=function(e,t,i){this.Init(e,t,i)},e.Obj.createSubclass(e.TimelineOverview,e.Overview),e.TimelineOverview.ENABLED_STATE="_",e.TimelineOverview.HOVER_STATE="_h",e.TimelineOverview.SELECTED_STATE="_s",e.TimelineOverview.ACTIVE_SELECTED_STATE="_as",e.TimelineOverview.BORDER_STYLE="bs",e.TimelineOverview.BORDER_COLOR="bc",e.TimelineOverview.BORDER_WIDTH="bw",e.TimelineOverview.DURATION_BORDER_STYLE="dbs",e.TimelineOverview.DURATION_BORDER_COLOR="dbc",e.TimelineOverview.DURATION_BORDER_WIDTH="dbw",e.TimelineOverview.BORDER_OFFSET="bof",e.TimelineOverview.BORDER_OPACITY="bo",e.TimelineOverview.GLOW_COLOR="gc",e.TimelineOverview.GLOW_OPACITY="go",e.TimelineOverview.FILL_COLOR="fc",e.TimelineOverview.newInstance=function(t,i,r){return new e.TimelineOverview(t,i,r)},e.TimelineOverview.prototype.Init=function(t,i,r){e.TimelineOverview.superclass.Init.call(this,t,i,r);var s=[e.ColorUtils.getPound(e.ColorUtils.getBrighter("#aadd77",.35)),"#aadd77",e.ColorUtils.getPound(e.ColorUtils.getDarker("#aadd77",.5))];e.OverviewUtils.supportsTouch()&&(s=["#aadd77"]),this._defColors=s,this._markerBorderFill=e.SolidFill.invisibleFill(),this._markerSize=12},e.Overview.prototype.initDefaults=function(){this.Defaults=new t},e.TimelineOverview.prototype.render=function(t,i,r){"string"==typeof t?e.TimelineOverview.superclass.render.call(this,this._getConvertedOptions(t),i,r):e.TimelineOverview.superclass.render.call(this,t,i,r)},e.TimelineOverview.prototype._getConvertedOptions=function(t){for(var i=new Object,r=new e.XmlParser(this.getCtx()).parse(t),s=r.getAttributes(),n=0;n<s.length;n++){var a=s[n];i[a.name]=a.value}var o=r.getChildNodes(),l=[],h=o[0].getChildNodes();for(n=0;n<h.length;n++){var _=new Object;s=h[n].getAttributes();for(var c=0;c<s.length;c++)_[(a=s[c]).name]=a.value;l.push(_)}i.axisTicks=l;var u=[],g=o[1].getChildNodes();for(n=0;n<g.length;n++){var d=new Object;for(s=g[n].getAttributes(),c=0;c<s.length;c++)d[(a=s[c]).name]=a.value;u.push(d)}if(i.markers=u,o.length>2){var m=[],v=o[2].getChildNodes();for(n=0;n<v.length;n++){var S=new Object;for(s=v[n].getAttributes(),c=0;c<s.length;c++)S[(a=s[c]).name]=a.value;m.push(S)}i.formattedTimeRanges=m}return i},e.TimelineOverview.prototype.getParser=function(e){return new i(this)},e.TimelineOverview.prototype._applyParsedProperties=function(t){if(e.TimelineOverview.superclass._applyParsedProperties.call(this,t),this._selectionMode=t.selectionMode,this._markers=t.markers,this._seriesIds=t.seriesIds,this._defaultMarkerStyles=t.defaultMarkerStyles,this._borderStyles=s.getDefaultMarkerBorderStyles(this.Options),this._durationColors=e.CSSStyle.COLORS_ALTA,t.labelStyle&&(this._labelStyle=new e.CSSStyle(t.labelStyle)),"solid"==this.getStyle(e.TimelineOverview.ENABLED_STATE,e.TimelineOverview.BORDER_STYLE))var i=parseInt(this.getStyle(e.TimelineOverview.ENABLED_STATE,e.TimelineOverview.BORDER_OFFSET),10);else i=1;if("solid"==this.getStyle(e.TimelineOverview.ACTIVE_SELECTED_STATE,e.TimelineOverview.BORDER_STYLE))var r=parseInt(this.getStyle(e.TimelineOverview.ACTIVE_SELECTED_STATE,e.TimelineOverview.BORDER_OFFSET),10);else r=1;if("solid"==this.getStyle(e.TimelineOverview.SELECTED_STATE,e.TimelineOverview.BORDER_STYLE))var n=parseInt(this.getStyle(e.TimelineOverview.SELECTED_STATE,e.TimelineOverview.BORDER_OFFSET),10);else n=1;this.isItemSelectionEnabled()?this._markerSpacingOffset=Math.max(r,n,i,1)/2+1:this._markerSpacingOffset=1,this._defOpacity=this.isVertical()?0:.75,this._defAlphas=[this._defOpacity,this._defOpacity,this._defOpacity],this._radialFill=new e.LinearGradientFill(250,this._defColors,this._defAlphas),this._linearFill=new e.LinearGradientFill(180,this._defColors,this._defAlphas);var a=this.isVertical()?0:1;this._border=new e.SolidStroke("#aadd77",a)},e.TimelineOverview.prototype.getSeriesIds=function(){return null==this._seriesIds?null:this._seriesIds.split(" ")},e.TimelineOverview.prototype.addLabel=function(t,i,r,s,n,a){e.TimelineOverview.superclass.addLabel.call(this,t,i,r,s,n,a,this._labelStyle)},e.TimelineOverview.prototype.isItemSelectionEnabled=function(){return"none"!=this._selectionMode},e.TimelineOverview.prototype.getDrawableById=function(e){for(var t="_mrk_"+e,i="_drn_"+e,r=this.getNumChildren(),s=0;s<r;s++){var n=this.getChildAt(s);if(null!=n&&(t==n.getId()||i==n.getId()))return n}return null},e.TimelineOverview.prototype.getItemId=function(e){return e.getId().substr(5)},e.TimelineOverview.prototype.getStyle=function(e,t){return this._borderStyles[e+t]},e.TimelineOverview.prototype.getX=function(e){return null!=e._node?e._node.getX():e.getMatrix().getTx()},e.TimelineOverview.prototype.getY=function(e){return null!=e._node?e._node.getY():e.getMatrix().getTy()},e.TimelineOverview.prototype.getScaleX=function(e){var t=e.getScaleX();return null==t&&(t=this.isVertical()?(this.Width-this.getTimeAxisWidth()-4)/2:1),t},e.TimelineOverview.prototype.getScaleY=function(e){var t=e.getScaleY();return null==t&&(t=1),t},e.TimelineOverview.prototype.parseDataXML=function(t,i){if(e.TimelineOverview.superclass.parseDataXML.call(this,t,i),null!=this._markers){for(var r=this._start,s=this._end,n=this.calculateOptimalSize(r,s,t,i,this._markerSize),a=[],o=0;o<this._markers.length;o++){var l=this._markers[o];null==l._endTime?this.addMarker(l,n):a[a.length]=l}this.prepareDurations(a),this.addDurations(a),this._markerSize=n}},e.TimelineOverview.prototype.prepareDurations=function(e){this._maxDurationY=0;var t=null;null==this._durationColorMap&&(this._durationColorMap=new Object);for(var i=0;i<e.length;i++){var r=e[i],s=r.getId(),n=s.substring(s.indexOf(":")+1,s.length);(n=n.substring(0,n.indexOf(":")))!=t&&(this._colorCount=0,t=n),r._durationLevel=this.calculateDurationY(r,e),null==r._durationFillColor&&(null==this._durationColorMap[s]?(this._durationColorMap[s]=this._colorCount,r._durationFillColor=this._durationColors[this._colorCount],this._colorCount++,this._colorCount==this._durationColors.length&&(this._colorCount=0)):r._durationFillColor=this._durationColors[this._durationColorMap[s]])}},e.TimelineOverview.prototype.getDurationColorMap=function(){return this._durationColorMap?this._durationColorMap:null},e.TimelineOverview.prototype.calculateOptimalSize=function(t,i,r,s,n){var a=new Object;a.max=1,a.arr=[];for(var o=this.isVertical()?s:r,l=0;l<this._markers.length;l++){var h=this._markers[l];if(null==h._endTime){if(this.calculateSize(h,t,i,o,n/2,a,s),a.max>s)break}else{var _=e.OverviewUtils.getDatePosition(t,i,h.getTime(),o);this.isHorizontalRTL()&&(_=o-_),h.setX(_)}}return a.max>s&&n>1?this.calculateOptimalSize(t,i,r,s,n-1):n},e.TimelineOverview.prototype.addMarker=function(t,i){var r="_mrk_"+t.getId(),s=t.getColor(),n=t.isGradient(),a=t.getOpacity();null==a&&0==(a=this._defOpacity)&&null!=s&&(a=1);var o=this.getScaleX(t),l=this.getScaleY(t),h=t.getShape();if(this.isVertical()){h=e.SimpleMarker.RECTANGLE;var _=2*o,c=2*l,u=t.getY()+_/2,g=t.getX()+c/2}else _=i*o,c=i*l,u=t.getX()+_/2,g=t.getY()+c/2;var d=new e.SimpleMarker(this.getCtx(),h,null,u,g,_,c,null,null,null,r);if(d._node=t,null==s&&a==this._defOpacity&&null==n)S=h==e.SimpleMarker.CIRCLE?this._radialFill:this._linearFill,p=this._border;else{var m=this._defColors;null!=s&&(m=e.OverviewUtils.supportsTouch()?[s]:[e.ColorUtils.getBrighter(s,.5),s,e.ColorUtils.getDarker(s,.5)]);var v=[a,a,a];if(null==n)if(h==e.SimpleMarker.CIRCLE)var S=new e.LinearGradientFill(250,m,v);else S=new e.LinearGradientFill(180,m,v);else S=new e.SolidFill(s,v[0]);var p=new e.SolidStroke(s,a)}d.setFill(S),d.setStroke(p),this.isItemSelectionEnabled()&&d.setSelectable(!0);var f=this.getNumChildren(),T=this.getChildAt(f-1);return f>this._lastChildIndex&&("tb"==T.getId()||"arr"==T.getId())?this.addChildAt(d,f-this._lastChildIndex):this.addChild(d),t.setDisplayable(d),this.applyState(d,e.TimelineOverview.ENABLED_STATE),!this.isVertical()&&h!=e.SimpleMarker.RECTANGLE&&h!=e.SimpleMarker.DIAMOND&&h!=e.SimpleMarker.TRIANGLE_UP&&h!=e.SimpleMarker.TRIANGLE_DOWN&&h!=e.SimpleMarker.PLUS||"false"==this._defaultMarkerStyles.pixelHinting||d.setPixelHinting(!0),d},e.TimelineOverview.prototype.addDurations=function(t){for(var i=this.getCtx(),r=this._maxDurationY;r>0;r--)for(var s=0;s<t.length;s++){var n=t[s];if(r==n._durationLevel){var a=e.OverviewUtils.getDatePosition(this._start,this._end,n.getTime(),this.isVertical()?this.Height:this.Width),o="_drn_"+n.getId(),l=9+5*n._durationLevel,h=e.OverviewUtils.getDatePosition(this._start,this._end,n.getEndTime(),this.isVertical()?this.Height:this.Width);if(this.isVertical())if(this.isRTL())var _=new e.Rect(i,0,a,l,h-a,o);else _=new e.Rect(i,this.Width-l,a,l,h-a,o);else _=this.isRTL()?new e.Rect(i,this.Width-h,this.Height-l-20,h-a,l,o):new e.Rect(i,a,this.Height-l-20,h-a,l,o);_.setFill(new e.SolidFill(n._durationFillColor));var c=new e.SolidStroke(this.getStyle(e.TimelineOverview.ENABLED_STATE,e.TimelineOverview.DURATION_BORDER_COLOR),1,1);_.setStroke(c),_.setPixelHinting(!0),_._node=n,this.addChild(_),n._durationBar=_,n._durationY=l-2}}this.removeChild(this._timeAxisTopBar),this.addChild(this._timeAxisTopBar)},e.TimelineOverview.prototype.calculateSize=function(t,i,r,s,n,a,o){var l=n*this.getScaleX(t)+this._markerSpacingOffset,h=n*this.getScaleY(t)+this._markerSpacingOffset,_=t.getTime(),c=e.OverviewUtils.getDatePosition(i,r,_,s);if(this.isHorizontalRTL()&&(c=s-c-2*l),this.isVertical()){var u=0;"solid"==this.getStyle(e.TimelineOverview.ENABLED_STATE,e.TimelineOverview.BORDER_STYLE)&&(u=parseInt(this.getStyle(e.TimelineOverview.ENABLED_STATE,e.TimelineOverview.BORDER_WIDTH),10)),g=this.isRTL()?u+4:this.Width-2*this.getScaleX(t)-u-4}else{var g=3;this.isOverviewAbove()&&(g+=this.getTimeAxisHeight());for(var d=0,m=[],v=0;v<a.arr.length;v++){var S=a.arr[v],p=S.getX(),f=this.getScaleX(S);Math.abs(c-p)<n*f+this._markerSpacingOffset+l&&m.push(S)}for(v=0;v<m.length;v++){var T=this.calculateY(m,t.getShape(),c,g,l,h,d,n,o);if(d=T.maxy,T.cy==g){g=T.cy;break}g=T.cy}}t.setX(c),t.setY(g),a.arr.push(t),d>a.max&&(a.max=d)},e.TimelineOverview.prototype.calculateY=function(t,i,r,s,n,a,o,l,h){for(var _=0;_<t.length;_++){var c=t[_],u=c.getX(),g=c.getY(),d=c.getShape(),m=this.getScaleX(c),v=this.getScaleY(c);if(i==e.SimpleMarker.CIRCLE&&d==e.SimpleMarker.CIRCLE&&n==a&&m==v)var S=Math.abs(r-u),p=l*m+this._markerSpacingOffset+n,f=Math.sqrt(p*p-S*S);else f=l*v+this._markerSpacingOffset+a;if(f>Math.abs(s-g)&&(s=g+f,o=Math.max(o,s+f),l>=1&&null!=h&&o>h))break}return{cy:s,maxy:o}},e.TimelineOverview.prototype.calculateDurationY=function(e,t){var i=t.length,r=e.getTime(),s=e._durationLevel;null==s&&(s=1);for(var n=0;n<i;n++){var a=t[n];if(a!=e){var o=a.getEndTime();if(null==o)continue;var l=a.getTime(),h=a._durationLevel;null==h&&(h=1),r>=l&&r<=o&&s==h&&(s=h+1,e._durationLevel=s,s=this.calculateDurationY(e,t))}}return s>this._maxDurationY&&(this._maxDurationY=s),s},e.TimelineOverview.prototype.HandleShapeMouseOver=function(t){var i=e.TimelineOverview.superclass.HandleShapeMouseOver.call(this,t);if(null!=i){if(null!=i._node){var r=i._node.getDescription();null!=r&&this.getCtx().getTooltipManager().showDatatip(t.pageX,t.pageY,r,"#000000"),this.isFlashEnvironment()&&this.setCursor("pointer")}if(this.isItemSelectionEnabled()){var s=!1;if(null!=this._selectedMarkers)for(var n=0;n<this._selectedMarkers.length;n++)if(i==this._selectedMarkers[n]){s=!0;break}if(!s){var a=this.getItemId(i),o=new e.TimelineOverviewEvent(e.TimelineOverviewEvent.SUBTYPE_HIGHLIGHT);o.setItemId(a),this.dispatchEvent(o),this.highlightMarker(i)}}}},e.TimelineOverview.prototype.HandleShapeMouseOut=function(t){var i=e.TimelineOverview.superclass.HandleShapeMouseOut.call(this,t);if(null!=i&&!this.isMovable(i)){this.getCtx().getTooltipManager().hideTooltip();var r=!1;if(null!=this._selectedMarkers)for(var s=0;s<this._selectedMarkers.length;s++)if(i==this._selectedMarkers[s]){r=!0;break}if(!r){var n=this.getItemId(i),a=new e.TimelineOverviewEvent(e.TimelineOverviewEvent.SUBTYPE_UNHIGHLIGHT);a.setItemId(n),this.dispatchEvent(a),this.unhighlightMarker(i)}}},e.TimelineOverview.prototype.HandleShapeClick=function(t,i,r){var s=e.TimelineOverview.superclass.HandleShapeClick.call(this,t,i,r);null!=s&&this.HandleMarkerClick(s,t.ctrlKey||t.shiftKey||e.Agent.isTouchDevice())},e.TimelineOverview.prototype.HandleMarkerClick=function(t,i){if(this.isItemSelectionEnabled()){this.selectItem(t,i);var r=t._node.getTime();if(null!=r){var s=new e.TimelineOverviewEvent(e.TimelineOverviewEvent.SUBTYPE_SCROLL_TIME);s.setTime(r),this.dispatchEvent(s);var n,a=this.getSlidingWindow();n=this.isVertical()?this.getX(t)-a.getHeight()/2:this.getX(t)-a.getWidth()/2,this.animateSlidingWindow(n)}}},e.TimelineOverview.prototype.updateSlidingWindowForZoom=function(t,i,r,s){this._start=i,this._end=r,this._width=s,this._renderStart=t;var n=s;if(this.isVertical())var a=this.Height;else a=this.Width;var o=e.OverviewUtils.getPositionDate(i,r,0,n),l=e.OverviewUtils.getPositionDate(i,r,a,n),h=e.OverviewUtils.getDatePosition(i,r,o,a),_=e.OverviewUtils.getDatePosition(i,r,l,a),c=e.OverviewUtils.getDatePosition(i,r,t,a),u=Math.max(e.Overview.MIN_WINDOW_SIZE,Math.min(a,_-h));c+u>a&&(c=Math.max(0,a-u)),this.isHorizontalRTL()&&(c=a-u-c),this.animateSlidingWindow(c,u),this._increment=this.calculateIncrement(a)},e.TimelineOverview.prototype.highlightItem=function(e){var t=this.getDrawableById(e);null!=t&&this.highlightMarker(t)},e.TimelineOverview.prototype.unhighlightItem=function(e){var t=this.getDrawableById(e);null!=t&&this.unhighlightMarker(t)},e.TimelineOverview.prototype.highlightMarker=function(t){if(null!=this._selectedMarkers)for(var i=0;i<this._selectedMarkers.length;i++)if(t==this._selectedMarkers[i])return;this.applyState(t,e.TimelineOverview.HOVER_STATE)},e.TimelineOverview.prototype.unhighlightMarker=function(t){if(null!=this._selectedMarkers)for(var i=0;i<this._selectedMarkers.length;i++)if(t==this._selectedMarkers[i])return;this.applyState(t,e.TimelineOverview.ENABLED_STATE)},e.TimelineOverview.prototype.selSelectItem=function(e){var t=this.getDrawableById(e);null!=t&&this.addSelectedMarker(t)},e.TimelineOverview.prototype.selUnselectItem=function(e){var t=this.getDrawableById(e);null!=t&&this.removeSelectedMarker(t)},e.TimelineOverview.prototype.selectItem=function(t,i){var r=this.getItemId(t),s=new e.TimelineOverviewEvent(e.TimelineOverviewEvent.SUBTYPE_SELECTION);s.setItemId(r),s.setMultiSelect(i),this.dispatchEvent(s)},e.TimelineOverview.prototype.addSelectedMarker=function(t){null==this._selectedMarkers&&(this._selectedMarkers=[]);var i=null;this._selectedMarkers.length>0&&(i=this._selectedMarkers[this._selectedMarkers.length-1]),this._selectedMarkers.push(t),null!=i&&this.applyState(i,e.TimelineOverview.SELECTED_STATE),this.applyState(t,e.TimelineOverview.ACTIVE_SELECTED_STATE)},e.TimelineOverview.prototype.removeSelectedMarker=function(t){if(null!=this._selectedMarkers){for(var i=-1,r=0;r<this._selectedMarkers.length;r++)if(t==this._selectedMarkers[r]){i=r;break}-1!=i&&(this.applyState(t,e.TimelineOverview.ENABLED_STATE),this._selectedMarkers.splice(i,1))}},e.TimelineOverview.prototype.removeAllSelectedMarkers=function(){if(null!=this._selectedMarkers){for(var t=0;t<this._selectedMarkers.length;t++){var i=this._selectedMarkers[t];this.applyState(i,e.TimelineOverview.ENABLED_STATE)}delete this._selectedMarkers,this._selectedMarkers=null}},e.TimelineOverview.prototype.applyState=function(t,i){if(t instanceof e.SimpleMarker){var r=!1,s=!1;if("solid"==this.getStyle(i,e.TimelineOverview.BORDER_STYLE)){r=!0;var n=this.getStyle(i,e.TimelineOverview.BORDER_COLOR);null==n&&(n="#000000");var a=this.getStyle(i,e.TimelineOverview.GLOW_COLOR);null!=a&&"none"!=a&&(s=!0)}var o=t._borderMarker,l=t._glowMarker;r||null==o?s||null==l||(this.removeChild(l),t._glowMarker=null):(this.removeChild(o),t._borderMarker=null,null!=l&&(this.removeChild(l),t._glowMarker=null));var h=t.getType();if(r){var _=parseInt(this.getStyle(i,e.TimelineOverview.BORDER_WIDTH),10),c=parseInt(this.getStyle(i,e.TimelineOverview.BORDER_OFFSET),10);if(null==o){if(h==e.SimpleMarker.CIRCLE){this.isFlashEnvironment()&&(c=0);var u=(t.getDimensions().w+2*c)*t.getScaleX(),g=(t.getDimensions().h+2*c)*t.getScaleY(),d=this.getX(t)-c+u/2,m=this.getY(t)-c+g/2}else this.isVertical()?(u=(t.getDimensions().w+(_+1))*t.getScaleX(),g=(t.getDimensions().h+(_+1))*t.getScaleY(),d=this.getY(t)-(_+1)/2+u/2,m=this.getX(t)-(_+1)/2+g/2):(u=(t.getDimensions().w+2*c)*t.getScaleX(),g=(t.getDimensions().h+2*c)*t.getScaleY(),d=this.getX(t)-c+u/2,m=this.getY(t)-c+g/2);o=new e.SimpleMarker(this.getCtx(),h,null,d,m,u,g,null,null,null,t.getId()+"_border"),this.addChildAt(o,this.getChildIndex(t)),t._borderMarker=o,o.setFill(this._markerBorderFill)}var v=new e.SolidStroke(n,this.getStyle(i,e.TimelineOverview.BORDER_OPACITY),_);if(o.setStroke(v),!this.isVertical()&&h!=e.SimpleMarker.RECTANGLE&&h!=e.SimpleMarker.DIAMOND&&h!=e.SimpleMarker.TRIANGLE_UP&&h!=e.SimpleMarker.TRIANGLE_DOWN&&h!=e.SimpleMarker.PLUS||"false"==this._defaultMarkerStyles.pixelHinting||o.setPixelHinting(!0),s){if(null==l){var S=c-_;h==e.SimpleMarker.CIRCLE?(this.isFlashEnvironment()&&(S=0),u=(t.getDimensions().w+2*S)*t.getScaleX(),g=(t.getDimensions().h+2*S)*t.getScaleY(),d=this.getX(t)-S+u/2,m=this.getY(t)-S+g/2):this.isVertical()?(u=(t.getDimensions().w+3)*t.getScaleX(),g=(t.getDimensions().h+3)*t.getScaleY(),d=this.getY(t)+u/2,m=this.getX(t)-1+g/2):(u=(t.getDimensions().w+2*S)*t.getScaleX(),g=(t.getDimensions().h+2*S)*t.getScaleY(),d=this.getX(t)-S+u/2,m=this.getY(t)-S+g/2),l=new e.SimpleMarker(this.getCtx(),h,null,d,m,u,g,null,null,null,t.getId()+"_glow"),this.addChildAt(l,this.getChildIndex(o)),t._glowMarker=l,l.setFill(this._markerBorderFill)}var p=new e.SolidStroke(a,this.getStyle(i,e.TimelineOverview.GLOW_OPACITY),4);l.setStroke(p),!this.isVertical()&&h!=e.SimpleMarker.RECTANGLE&&h!=e.SimpleMarker.DIAMOND&&h!=e.SimpleMarker.TRIANGLE_UP&&h!=e.SimpleMarker.TRIANGLE_DOWN&&h!=e.SimpleMarker.PLUS||"false"==this._defaultMarkerStyles.pixelHinting||l.setPixelHinting(!0)}}}else{var f=t.getId();f&&"_drn_"==f.substring(0,5)&&this.applyDurationState(t,i)}},e.TimelineOverview.prototype.applyDurationState=function(t,i){var r=this.getStyle(i,e.TimelineOverview.DURATION_BORDER_COLOR);null==r&&(r="#000000");var s=parseInt(this.getStyle(i,e.TimelineOverview.DURATION_BORDER_WIDTH),10);t.setStroke(new e.SolidStroke(r,1,s))},e.TimelineOverview.prototype.orderInsert=function(e){if(0==this._markers.length)this._markers.push(e);else for(var t=this._markers.length-1;t>=0;t--){var i=this._markers[t];if(e.getTime()>i.getTime()){this._markers.splice(t+1,0,e);break}0==t&&this._markers.splice(0,0,e)}},e.TimelineOverview.prototype.handleAutoPPRInsert=function(e){var t=new i(this).parseMarker(e);this.orderInsert(t);var r=this._start,s=this._end,n=this.Width,a=this.Height,o=this.calculateOptimalSize(r,s,n,a,this._markerSize);if(null==t._endTime)this.addMarker(t,o);else{var l=[];l[0]=t,this.prepareDurations(l),this.addDurations(l)}},e.TimelineOverview.prototype.handleAutoPPRDelete=function(e){this.removeMarker(e)},e.TimelineOverview.prototype.handleAutoPPRUpdate=function(e,t){var r=this.findMarkerByRowKey(e);if(null!=r){var s=r.marker,n=s.getId(),a=this.getDrawableById(n),o=this.isMarkerSelected(a);this.removeMarker(e);var l=new i(this).parseMarker(t);this.orderInsert(l);var h=this._start,_=this._end,c=this.Width,u=this.Height,g=this.calculateOptimalSize(h,_,c,u,this._markerSize);if(null==l._endTime){var d=this.addMarker(l,g);o&&this.addSelectedMarker(d)}else{var m=[];m[0]=s,this.prepareDurations(m),this.addDurations(m)}}},e.TimelineOverview.prototype.findMarkerByRowKey=function(e){for(var t=0;t<this._markers.length;t++){var i=this._markers[t];if(i.getRowKey()==e)return{index:t,marker:i}}return null},e.TimelineOverview.prototype.removeMarker=function(e){var t=this.findMarkerByRowKey(e);if(null!=t){var i=t.marker;if(null!=i.getDisplayable())var r=i.getDisplayable();else{var s=i.getId();r=this.getDrawableById(s)}if(null!=r){this.removeSelectedMarker(r),this.removeChild(r),this._markers.splice(t.index,1);var n=r._borderMarker;null!=n&&this.removeChild(n);var a=r._glowMarker;null!=a&&this.removeChild(a)}}return null},e.TimelineOverview.prototype.isMarkerSelected=function(e){if(null!=this._selectedMarkers)for(var t=0;t<this._selectedMarkers.length;t++)if(e==this._selectedMarkers[t])return!0;return!1},e.TimelineOverview.prototype.getAutomation=function(){return this._Automation||(this._Automation=new n(this)),this._Automation},e.TimelineOverview.prototype.getMarkers=function(){return this._markers};var t=function(){this.Init({alta:t.VERSION_1})};e.Obj.createSubclass(t,e.BaseComponentDefaults),t.VERSION_1={overviewPosition:"below",style:{borderTopStyle:"none",currentTimeIndicatorColor:"#c000d1",handleFillColor:"#ffffff",handleTextureColor:"#b3c6db",leftFilterPanelAlpha:.7,leftFilterPanelColor:"#ffffff",overviewBackgroundColor:"#e6ecf3",rightFilterPanelAlpha:.7,rightFilterPanelColor:"#ffffff",timeAxisBarColor:"#d9dfe3",timeAxisBarAlpha:0,timeIndicatorColor:"#bcc7d2",windowBackgroundAlpha:1,windowBackgroundColor:"#ffffff",windowBorderBottomColor:"#4f4f4f",windowBorderBottomStyle:"solid",windowBorderLeftColor:"#4f4f4f",windowBorderLeftStyle:"solid",windowBorderRightColor:"#4f4f4f",windowBorderRightStyle:"solid",windowBorderTopColor:"#4f4f4f",windowBorderTopStyle:"solid"},_fc:"#aadd77",_do:0,_bc:"#648baf",_bof:"0px",_bs:"solid",_bw:"1px",_dbc:"#648baf",_dbs:"solid",_dbw:"1px",_hbc:"#85bbe7",_hbs:"solid",_hbw:"2px",_hbof:"0px",_hgc:"#ebeced",_hgo:1,_hdbs:"solid",_hdbc:"#85bbe7",_hdbw:"2px",_sbs:"solid",_sbc:"#000000",_sbw:"2px",_sbof:"0px",_sbo:1,_sdbs:"solid",_sdbc:"#000000",_sdbw:"2px",_asbs:"solid",_asbc:"#000000",_asbw:"2px",_asbof:"0px",_asbo:1,_asgc:"#e4f0fa",_asgo:1,_asdbs:"solid",_asdbc:"#000000",_asdbw:"2px",_aoc:"off"};var i=function(e){this.Init(e)};e.Obj.createSubclass(i,e.OverviewParser),i.prototype.Init=function(t){this._view=t,this._parser=new e.XmlParser(t.getCtx())},i.prototype.parse=function(e){var t=this.ParseRootAttributes(e);return t.timeAxisInfo=this._parseTimeAxis(e.axisTicks),t.markers=this._parseDataNode(e.markers,t.defaultMarkerStyles),t.formattedTimeRanges=e.formattedTimeRanges,t},i.prototype.parseMarker=function(e){for(var t=this._parser.parse(e),i=new Object,s=t.getAttributes(),n=0;n<s.length;n++){var a=s[n];i[a.name]=a.value}var o=this.ParseNodeAttributes(i,this._view._defaultMarkerStyles);return new r(this._view,o)},i.prototype.ParseRootAttributes=function(e){var t=i.superclass.ParseRootAttributes.call(this,e);t.start=parseInt(e.start),t.end=parseInt(e.end),t.width=parseInt(e.width),t.renderStart=parseInt(e.renstart),t.currentTime=parseInt(e.ocd),t.orientation=e.orn,t.selectionMode=e.selmode,t.isRtl=e.rtl.toString(),t.seriesIds=e.sid,t.animationOnClick=e._aoc;var r=new Object;return r.shape=s.getDefaultMarkerShape(e),r.scaleX=s.getDefaultMarkerScaleX(e),r.scaleY=s.getDefaultMarkerScaleY(e),r.opacity=s.getDefaultMarkerOpacity(e),r.color=s.getDefaultMarkerFillColor(e),r.pixelHinting=s.getDefaultMarkerPixelHinting(e),t.defaultMarkerStyles=r,t.labelStyle=e._ls,t},i.prototype._parseDataNode=function(e,t){if(e){for(var i=new Array,s=0;s<e.length;s++){var n=this.ParseNodeAttributes(e[s],t),a=new r(this._view,n);i.push(a)}return i}return null},i.prototype.ParseNodeAttributes=function(e,t){var i=new Object,r="true"==e._sd;return i.id=e.tid,i.rowKey=e.rk,i.time=e.t,i.endTime=e.et,i.shape=e.s,r&&null==i.shape&&(i.shape=t.shape),i.desc=e.d,i.color=e.c,i.durationFillColor=e.dfc,r&&null==i.color&&(i.color=t.color),i.scaleX=e.sx,r&&null==i.scaleX&&(i.scaleX=t.scaleX),i.scaleY=e.sy,r&&null==i.scaleY&&(i.scaleY=t.scaleY),i.gradient=e.g,i.opacity=e.o,r&&null==i.opacity&&(i.opacity=t.opacity),i},i.prototype._parseTimeAxis=function(e){if(e){var t=new Object;return t.width=null,t.height=null,t.ticks=e,t}return null};var r=function(e,t){this.Init(e,t)};e.Obj.createSubclass(r,e.Obj),r.prototype.Init=function(t,i){this._view=t,this._rowKey=i.rowKey,this._id=i.id,this._time=parseInt(i.time),this._endTime=null==i.endTime?null:parseInt(i.endTime),this._shape=e.SimpleMarker.CIRCLE,"square"==i.shape?this._shape=e.SimpleMarker.RECTANGLE:"plus"==i.shape?this._shape=e.SimpleMarker.PLUS:"diamond"==i.shape?this._shape=e.SimpleMarker.DIAMOND:"triangleUp"==i.shape?this._shape=e.SimpleMarker.TRIANGLE_UP:"triangleDown"==i.shape&&(this._shape=e.SimpleMarker.TRIANGLE_DOWN),this._desc=i.desc,this._color=i.color,this._gradient=i.gradient,null!=i.opacity&&(this._opacity=parseFloat(i.opacity)),null!=i.scaleX&&(this._scaleX=parseFloat(i.scaleX)),null!=i.scaleY&&(this._scaleY=parseFloat(i.scaleY)),null!=i.durationFillColor&&(this._durationFillColor=i.durationFillColor)},r.prototype.getId=function(){return this._id},r.prototype.getRowKey=function(){return this._rowKey},r.prototype.getTime=function(){return this._time},r.prototype.getEndTime=function(){return this._endTime},r.prototype.getScaleX=function(){return this._scaleX},r.prototype.getScaleY=function(){return this._scaleY},r.prototype.getDescription=function(){return this._desc},r.prototype.getColor=function(){return this._color},r.prototype.isGradient=function(){return this._gradient},r.prototype.getShape=function(){return this._shape},r.prototype.getOpacity=function(){return this._opacity},r.prototype.getDisplayable=function(){return this._displayable},r.prototype.setDisplayable=function(e){this._displayable=e},r.prototype.getX=function(){return this._x},r.prototype.setX=function(e){this._x=e},r.prototype.getY=function(){return this._y},r.prototype.setY=function(e){this._y=e},e.TimelineOverviewEvent=function(t){this.Init(e.TimelineOverviewEvent.TYPE),this._subtype=t},e.Obj.createSubclass(e.TimelineOverviewEvent,e.OverviewEvent),e.TimelineOverviewEvent.TYPE="timeline",e.TimelineOverviewEvent.SUBTYPE_HIGHLIGHT="highlight",e.TimelineOverviewEvent.SUBTYPE_UNHIGHLIGHT="unhighlight",e.TimelineOverviewEvent.SUBTYPE_SELECTION="selection",e.TimelineOverviewEvent.SUBTYPE_SCROLL_TIME=e.OverviewEvent.SUBTYPE_SCROLL_TIME,e.TimelineOverviewEvent.SUBTYPE_SCROLL_POS=e.OverviewEvent.SUBTYPE_SCROLL_POS,e.TimelineOverviewEvent.SUBTYPE_RANGECHANGE=e.OverviewEvent.SUBTYPE_RANGECHANGE,e.TimelineOverviewEvent.SUBTYPE_RANGECHANGING="rangeChanging",e.TimelineOverviewEvent.SUBTYPE_DROPCALLBACK=e.OverviewEvent.SUBTYPE_PRE_RANGECHANGE,e.TimelineOverviewEvent.ITEM_ID_KEY="itemId",e.TimelineOverviewEvent.MULTI_SELECT_KEY="multiSelect",e.TimelineOverviewEvent.START_POS=e.OverviewEvent.START_POS,e.TimelineOverviewEvent.END_POS=e.OverviewEvent.END_POS,e.TimelineOverviewEvent.prototype.setItemId=function(t){this.addParam(e.TimelineOverviewEvent.ITEM_ID_KEY,t)},e.TimelineOverviewEvent.prototype.getItemId=function(){return this.getParamValue(e.TimelineOverviewEvent.ITEM_ID_KEY)},e.TimelineOverviewEvent.prototype.setMultiSelect=function(t){this.addParam(e.TimelineOverviewEvent.MULTI_SELECT_KEY,t)},e.TimelineOverviewEvent.prototype.isMultiSelect=function(){var t=this.getParamValue(e.TimelineOverviewEvent.MULTI_SELECT_KEY);return null!=t&&t};var s=new Object;e.Obj.createSubclass(s,e.Obj),s.getDefaultMarkerShape=function(e){return e._ds},s.getDefaultMarkerScaleX=function(e){return e._dsx},s.getDefaultMarkerScaleY=function(e){return e._dsy},s.getDefaultMarkerOpacity=function(e){return e._do},s.getDefaultMarkerFillColor=function(e){return e._fc},s.getDefaultMarkerPixelHinting=function(e){return e._ph},s.getDefaultMarkerBorderStyles=function(e){var t=new Object;return t._bs=e._bs,t._bc=e._bc,t._bw=e._bw,t._bof=e._bof,t._bo=e._bo,t._gc=e._gc,t._go=e._go,t._dbs=e._dbs,t._dbc=e._dbc,t._dbw=e._dbw,t._hbs=e._hbs,t._hbc=e._hbc,t._hbw=e._hbw,t._hbof=e._hbof,t._hbo=e._hbo,t._hgc=e._hgc,t._hgo=e._hgo,t._hdbs=e._hdbs,t._hdbc=e._hdbc,t._hdbw=e._hdbw,t._sbs=e._sbs,t._sbc=e._sbc,t._sbw=e._sbw,t._sbof=e._sbof,t._sbo=e._sbo,t._sgc=e._sgc,t._sgo=e._sgo,t._sdbs=e._sdbs,t._sdbc=e._sdbc,t._sdbw=e._sdbw,t._asbs=e._asbs,t._asbc=e._asbc,t._asbw=e._asbw,t._asbof=e._asbof,t._asbo=e._asbo,t._asgc=e._asgc,t._asgo=e._asgo,t._asdbs=e._asdbs,t._asdbc=e._asdbc,t._asdbw=e._asdbw,t};var n=function(e){this._overview=e};e.Obj.createSubclass(n,e.Automation),n.NODE_ID_PREFIX="marker",n.WINDOW_ID="range_window",n.START_HANDLE_ID="range_start_handle",n.END_HANDLE_ID="range_end_handle",n.AUTOMATION_NO_EVENT=-1,n.AUTOMATION_MOUSE_CLICK=0,n.prototype.GetSubIdForDomElement=function(t){var i=t.getId();if(t instanceof e.SimpleMarker){var r=i.split(":");if(4!=r.length)return null;var s=this._overview.getSeriesIds();if(null!=s){var a=e.ArrayUtils.getIndex(s,r[1]);if(a>-1)return"marker["+a+"]["+r[2]+"]"}}else{if("window"==i)return n.WINDOW_ID;if("lh"==i||"lhb"==i||"lbgrh"==i)return n.START_HANDLE_ID;if("rh"==i||"rhb"==i||"rbgrh"==i)return n.END_HANDLE_ID;if("grpy"==i){var o=t.getParent().getChildBefore(t);return this.GetSubIdForDomElement(o)}}return null},n.prototype.getDomElementForSubId=function(e){var t=n._convertSubIdToArray(e);if(t&&3==t.length&&t[0]==n.NODE_ID_PREFIX){var i=this._overview.getSeriesIds();if(null!=i){var r=parseInt(t[1],10);if(r>-1&&r<i.length){var s=n._findMarker(this._overview.getMarkers(),i[r],t[2]);return s?s.getDisplayable().getElem():null}}}else{if(e==n.WINDOW_ID)return this._overview.getSlidingWindow().getElem();if(e==n.START_HANDLE_ID)return this._overview.getLeftHandle().getElem();if(e==n.END_HANDLE_ID)return this._overview.getRightHandle().getElem()}return null},n.prototype.click=function(e){this.processSubId(e,n.AUTOMATION_MOUSE_CLICK)},n.prototype.processSubId=function(e,t){if(void 0===t&&(t=n.AUTOMATION_NO_EVENT),null!=e&&t!=n.AUTOMATION_NO_EVENT&&t==n.AUTOMATION_MOUSE_CLICK){var i=n._convertSubIdToArray(e);if(i&&3==i.length&&i[0]==n.NODE_ID_PREFIX){var r=n._findMarker(this._overview.getMarkers(),i[1],i[2]);r&&this._overview.HandleMarkerClick(r.getDisplayable(),!1)}}},n._convertSubIdToArray=function(e){for(var t=e.split("["),i=t.length,r=1;r<i;r++){var s=t[r],n=s.substr(0,s.length-1),a=parseFloat(n);n=isNaN(a)?n:a,t[r]=n}return t},n._findMarker=function(e,t,i){for(var r="tl1:"+t+":"+i+":",s=0;s<e.length;s++){var n=e[s],a=n.getId();if(null!=a&&0==a.indexOf(r))return n}return null},e.exportProperty(e,"TimelineOverview",e.TimelineOverview),e.exportProperty(e.TimelineOverview,"newInstance",e.TimelineOverview.newInstance),e.exportProperty(e.TimelineOverview.prototype,"render",e.TimelineOverview.prototype.render),e.exportProperty(e.TimelineOverview.prototype,"getAutomation",e.TimelineOverview.prototype.getAutomation),e.exportProperty(e.TimelineOverview.prototype,"getDurationColorMap",e.TimelineOverview.prototype.getDurationColorMap),e.exportProperty(n.prototype,"getDomElementForSubId",n.prototype.getDomElementForSubId)}(e),function(e){var t=new Object;t.supportsTouch=function(){return e.Agent.isTouchDevice()},e.Obj.createSubclass(t,e.Obj),t.getDatePosition=function(e,t,i,r){var s=(i-e)*r,n=t-e;return 0==s||0==n?0:s/n},t.getPositionDate=function(e,t,i,r){var s=i*(t-e);return 0==s||0==r?e:s/r+e};var i=function(e){this.Init(e)};e.Obj.createSubclass(i,e.TimeComponentKeyboardHandler),i.getNextNavigable=function(t,r,s){var n=t.getSeries(),a=t.getSeriesIndex(),o=e.Agent.isRightToLeft(n.getCtx()),l=n.isVertical(),h=s.length>1;if(!o&&e.KeyboardEvent.RIGHT_ARROW==r.keyCode||o&&e.KeyboardEvent.LEFT_ARROW==r.keyCode){if(!l)return i.getNextItem(t,s[a],!0);if(h&&1!=a)return i.getClosestItem(t,s[1])}else if(!o&&e.KeyboardEvent.LEFT_ARROW==r.keyCode||o&&e.KeyboardEvent.RIGHT_ARROW==r.keyCode){if(!l)return i.getNextItem(t,s[a],!1);if(h&&0!=a)return i.getClosestItem(t,s[0])}else if(e.KeyboardEvent.DOWN_ARROW==r.keyCode){if(l)return i.getNextItem(t,s[a],!0);if(h&&1!=a)return i.getClosestItem(t,s[1])}else if(e.KeyboardEvent.UP_ARROW==r.keyCode){if(l)return i.getNextItem(t,s[a],!1);if(h&&0!=a)return i.getClosestItem(t,s[0])}return null},i.getNextItem=function(t,i,r){var s=e.ArrayUtils.getIndex(i,t)+(r?1:-1);return s>=0&&s<i.length?i[s]:null},
i.getClosestItem=function(e,t){if(t.length>0){for(var i=t[0],r=e.getLoc(),s=Math.abs(r-i.getLoc()),n=1;n<t.length;n++){var a=Math.abs(r-t[n].getLoc());a<s&&(s=a,i=t[n])}return i}return null};var r=function(e){r.superclass.constructor.call(this,e)};e.Obj.createSubclass(r,e.TimeComponentEventManager),r.prototype.addListeners=function(t){if(r.superclass.addListeners.call(this,t),!e.Agent.isTouchDevice()&&e.Agent.isPlatformIE()){var i=this.getCtx().getStage();i.addEvtListener("mouseenter",this.OnMouseEnter,!1,this),i.addEvtListener("mouseleave",this.OnMouseLeave,!1,this)}},r.prototype.RemoveListeners=function(t){if(r.superclass.RemoveListeners.call(this,t),!e.Agent.isTouchDevice()&&e.Agent.isPlatformIE()){var i=this.getCtx().getStage();i.removeEvtListener("mouseenter",this.OnMouseEnter,!1,this),i.removeEvtListener("mouseleave",this.OnMouseLeave,!1,this)}},r.prototype.PreOnMouseOver=function(t){this._mouseOutTimer&&this._mouseOutTimer.isRunning()&&this._mouseOutTimer.stop(),r.superclass.PreOnMouseOver.call(this,t),e.Agent.isPlatformIE()||this.isMouseOver||(this.isMouseOver=!0)},r.prototype.OnMouseEnter=function(e){this._mouseOutTimer&&this._mouseOutTimer.isRunning()&&this._mouseOutTimer.stop(),this.isMouseOver||(this.isMouseOver=!0)},r.prototype.OnMouseLeave=function(t){this._mouseOutTimer||(this._mouseOutTimer=new e.Timer(this.getCtx(),10,this._onMouseOutTimerEnd,this,1)),this._mouseOutTimer.reset(),this._mouseOutTimer.start()},r.prototype.PreOnMouseOut=function(t){r.superclass.PreOnMouseOut.call(this,t),e.Agent.isPlatformIE()||(this._mouseOutTimer||(this._mouseOutTimer=new e.Timer(this.getCtx(),10,this._onMouseOutTimerEnd,this,1)),this._mouseOutTimer.reset(),this._mouseOutTimer.start())},r.prototype._onMouseOutTimerEnd=function(){this.isMouseOver=!1},r.prototype.panBy=function(e,t){var i=this.getFocus();i&&(this._comp._dragPanSeries=i._series),r.superclass.panBy.call(this,e,t)},e.Timeline=function(e,t,i){this.Init(e,t,i)},e.Obj.createSubclass(e.Timeline,e.TimeComponent),e.Timeline.ORIENTATION_VERTICAL="vertical",e.Timeline.newInstance=function(t,i,r){return new e.Timeline(t,i,r)},e.Timeline.prototype.Init=function(t,s,a){e.Timeline.superclass.Init.call(this,t,s,a),this.Defaults=new n,this.EventManager=new r(this,t,s,a),this.EventManager.addListeners(this),e.Agent.isTouchDevice()?this._keyboardHandler=null:(this._keyboardHandler=new i(this.EventManager),this.EventManager.setKeyboardHandler(this._keyboardHandler))},e.Timeline.prototype.Parse=function(e){return this._parser=new a,this._parser.parse(e)},e.Timeline.prototype._applyParsedProperties=function(t){var i=this.Options.orientation;i&&i==e.Timeline.ORIENTATION_VERTICAL?this._isVertical=!0:this._isVertical=!1,this._hasOverview=t.hasOverview,this._viewStartTime=t.viewStart,this._viewEndTime=t.viewEnd,this._selectionMode=t.selectionMode,"single"==this._selectionMode?this.SelectionHandler=new e.SelectionHandler(this.getCtx(),e.SelectionHandler.TYPE_SINGLE):"multiple"==this._selectionMode?this.SelectionHandler=new e.SelectionHandler(this.getCtx(),e.SelectionHandler.TYPE_MULTIPLE):this.SelectionHandler=null,this.EventManager.setSelectionHandler(this.SelectionHandler),this._shortDesc=t.shortDesc,this._referenceObjects=t.referenceObjects,this._seriesScale=t.seriesScale,this._timeZoneOffsets=t.timeZoneOffsets,this._seriesScale?(this._seriesConverter=t.seriesConverter,this._seriesTimeAxis=new e.TimeAxis(this.getCtx(),null,null),this._seriesTimeAxis.setIsVertical(this._isVertical),this._seriesTimeAxis.setScale(this._seriesScale),this._seriesTimeAxis.setConverter(this._seriesConverter),this._seriesCustomFormatScales=t.seriesCustomFormatScales,this._dateFormatStrings=this._seriesTimeAxis.getDateFormatStrings(),this._isVertical?(this._seriesTimeAxis.setType("short",this._dateFormatStrings),this._seriesTimeAxis.setDefaultConverter(this._resources.converterVert)):(this._seriesTimeAxis.setType("long",this._dateFormatStrings),this._seriesTimeAxis.setDefaultConverter(this._resources.converter)),this._timeZoneOffsets&&this._seriesTimeAxis.setTimeZoneOffsets(this._timeZoneOffsets)):this._seriesTimeAxis=null,this._defaultInversions=[!1,!0],this._itemPosition=t.itemPosition,this._customTimeScales=t.customTimeScales,this._customFormatScales=t.customFormatScales,this._scale=t.scale,e.Timeline.superclass._applyParsedProperties.call(this,t)},e.Timeline.prototype.getTimeAxis=function(){return this._timeAxis},e.Timeline.prototype.getTimeAxisSize=function(){return this._timeAxis.getSize()},e.Timeline.prototype.getTimeAxisVisibleSize=function(e){return this._hasOverview||1!=e?this.getTimeAxisSize():this.getTimeAxisSize()-this._timeAxis.getBorderWidth()},e.Timeline.prototype.select=function(t){this.Options.selection=e.JsonUtils.clone(t),this.SelectionHandler&&this.applyInitialSelections()},e.Timeline.prototype._bundleTimeAxisOptions=function(e){this._timeAxisOptions={start:e.start,end:e.end,_resources:e._resources,shortDesc:e.shortDesc,_tzo:e._tzo,_ip:e._ip,_cts:this._customTimeScales,_cfs:this._customFormatScales,orientation:e.orientation};var t=this._timeAxisOptions._resources;if(t&&(t.borderTopVisible=!0,t.borderRightVisible=!0,t.borderBottomVisible=!0,t.borderLeftVisible=!0),e.styleDefaults&&e.styleDefaults.minorAxis){var i=e.styleDefaults.minorAxis;this._timeAxisOptions.backgroundColor=i.backgroundColor,this._timeAxisOptions.borderColor=i.borderColor,this._timeAxisOptions.separatorColor=i.separatorColor,this._timeAxisOptions.labelStyle=i.labelStyle}if(e.minorAxis){var r=e.minorAxis;this._timeAxisOptions.scale=r.scale,this._timeAxisOptions.converter=r.converter,this._timeAxisOptions.zoomOrder=r.zoomOrder,this._timeAxisOptions.style=r.style,r.svgStyle&&(this._timeAxisOptions.style=r.svgStyle)}},e.Timeline.prototype.render=function(t,i,r){if(t){this.SetOptions(t),this.StopAnimation(),this.Options&&(this._resources=this.Options._resources,null==this._resources&&(this._resources=[])),this.Width=i,this.Height=r;var s=this.Parse(this.Options);if(this._applyParsedProperties(s),this._fetchStartPos=0,this._isVertical?this._fetchEndPos=r:this._fetchEndPos=i,this.Options.styleDefaults&&(this._majorAxisStyleDefaults=this.Options.styleDefaults.majorAxis,this._seriesStyleDefaults=this.Options.styleDefaults.series),this._scale){this._bundleTimeAxisOptions(this.Options),this.applyAxisStyleValues(),this._timeAxis||(this._timeAxis=new e.TimeAxis(this.getCtx(),null,null)),this._isVertical?this._timeAxis.setBorderVisibility(!1,!0,!1,!0):this._timeAxis.setBorderVisibility(!0,!1,!0,!1),this._timeAxis.setCanvasSize(null);var n=this._timeAxis.getPreferredLength(this._timeAxisOptions,this._canvasLength);n&&this.setContentLength(n),this._timeAxis.hasValidOptions()&&this.prepareViewportLength()}this._populateSeries(),o.renderTimeline(this),this.UpdateAriaAttributes(),e.TimeAxis.supportsTouch()||this.getCtx().setKeyboardFocusArray([this]),this.Animation||this.RenderComplete()}else this._handleResize(i,r)},e.Timeline.prototype.hasValidSeriesItems=function(){for(var e=0;e<this._seriesOptions.length;e++){var t=this._seriesOptions[e];if(t.items)for(var i=0;i<t.items.length;i++){var r=t.items[i],s=new Date(r.start).getTime();if(!s)return!1;if(r.hasOwnProperty("end")){var n=new Date(r.end).getTime();if(!(n&&n>=s))return!1}}}return!0},e.Timeline.prototype.hasValidOptions=function(){var t=this._scale&&-1!=e.ArrayUtils.getIndex(e.TimeAxis._VALID_SCALES,this._scale),i=this._scale&&this._customTimeScales&&this._customTimeScales[this._scale],r=this._start&&this._end&&this._end>this._start,s=this._series&&this._series.length>0,n=!!s&&this.hasValidSeriesItems(),a=!this._seriesScale||-1!=e.ArrayUtils.getIndex(e.TimeAxis._VALID_SCALES,this._seriesScale),o=!this._seriesScale||this._customTimeScales&&this._customTimeScales[this._seriesScale],l=!this._viewStartTime||!this._viewEndTime||this._viewEndTime>this._viewStartTime,h=!this._viewStartTime||this._viewStartTime>=this._start&&this._viewStartTime<this._end,_=!this._viewEndTime||this._viewEndTime>this._start&&this._viewEndTime<=this._end;return(t||i)&&(a||o)&&r&&s&&n&&l&&h&&_},e.Timeline.prototype.GetComponentDescription=function(){return this._shortDesc?this._shortDesc:e.Bundle.getTranslatedString(e.Bundle.UTIL_PREFIX,"TIMELINE")},e.Timeline.prototype.applyStyleValues=function(){if(this._style=new e.CSSStyle(l.getTimelineStyle()),this.Options.styleDefaults){var t=this.Options.styleDefaults.borderColor;t&&this._style.parseInlineStyle("border-color:"+t+";")}if(this._hasOverview){this._overviewSize=this._isVertical?l.getOverviewWidth():l.getOverviewHeight();var i=this.Options.overview,r=i.svgStyle?i.svgStyle:i.style;if(r){var s=new e.CSSStyle(r),n=this._isVertical?s.getWidth():s.getHeight();null!=n&&(this._overviewSize=e.CSSStyle.toNumber(n))}}e.Timeline.superclass.applyStyleValues.call(this);var a=this._style.getBorderWidth(),o=2*a,h="border:"+o+"px;";this._style.parseInlineStyle(h),this.setStartXOffset(a),this.setStartYOffset(a),this.setBackgroundXOffset(0);var _=3*this.getScrollbarPadding();this.timeDirScrollbarStyles=this.getTimeDirScrollbarStyle(),this.contentDirScrollbarStyles=this.getContentDirScrollbarStyle(),this._backgroundWidth=this.Width,this._backgroundHeight=this.Height,this._isVertical?(this.isContentDirScrollbarOn()&&(this._backgroundHeight=this._backgroundHeight-e.CSSStyle.toNumber(this.contentDirScrollbarStyles.getHeight())-_),this._canvasLength=this._backgroundHeight-o,this._hasOverview?(this._canvasSize=this._backgroundWidth-this._overviewSize-o,this.isRTL()&&this.setStartXOffset(a+this._overviewSize)):(this.isTimeDirScrollbarOn()&&(this._backgroundWidth=this._backgroundWidth-e.CSSStyle.toNumber(this.timeDirScrollbarStyles.getWidth())-_),this._canvasSize=this._backgroundWidth-o,this.isRTL()&&(this.setBackgroundXOffset(this.Width-this._backgroundWidth),this.setStartXOffset(this.getStartXOffset()+this.getBackgroundXOffset())))):(this.isContentDirScrollbarOn()&&(this._backgroundWidth=this._backgroundWidth-e.CSSStyle.toNumber(this.contentDirScrollbarStyles.getWidth())-_),this._canvasLength=this._backgroundWidth-o,this.isRTL()&&(this.setBackgroundXOffset(this.Width-this._backgroundWidth),this.setStartXOffset(this.getStartXOffset()+this.getBackgroundXOffset())),this._hasOverview?this._canvasSize=this._backgroundHeight-this._overviewSize-o:(this.isTimeDirScrollbarOn()&&(this._backgroundHeight=this._backgroundHeight-e.CSSStyle.toNumber(this.timeDirScrollbarStyles.getHeight())-_),this._canvasSize=this._backgroundHeight-o))},e.Timeline.prototype.applyAxisStyleValues=function(){if(this._seriesStyleDefaults&&this._seriesStyleDefaults.backgroundColor){var t=this._seriesStyleDefaults.backgroundColor,i=e.ColorUtils.getRed(t),r=e.ColorUtils.getGreen(t),s=e.ColorUtils.getBlue(t);this._seriesBackgroundOverlayStyle="background-color:rgba("+i+","+r+","+s+",0.8);"}},e.Timeline.prototype._populateSeries=function(){var e=this.Options.series;if(e){var t=Math.min(e.length,2);if(this._seriesOptions=[],this._series){if(t!=this._series.length){for(var i=0;i<this._series.length;i++)this._timeZoomCanvas.removeChild(this._series[i]);this._series=[]}}else this._series=[];for(i=0;i<t;i++){var r=e[i];if(r.start=this._start,r.end=this._end,r.inverted=this._defaultInversions[i],r.orientation=this.Options.orientation,r.referenceObjects=this._referenceObjects,r.timeline=this,r.index=i,r.animationOnDisplay=this.Options.animationOnDisplay,r.animationOnDataChange=this.Options.animationOnDataChange,this.Options.majorAxis&&(r.scale=this.Options.majorAxis.scale,r.timeAxis=this._seriesTimeAxis,r._cfs=this._seriesCustomFormatScales),r.styleDefaults=this.Options.styleDefaults,this.Options.styleDefaults&&(r.seriesStyleDefaults=this._seriesStyleDefaults,r.axisStyleDefaults=this._majorAxisStyleDefaults),r._isRandomItemLayout="random"==this._itemPosition,r._cts=this.Options._cts,this._seriesOptions.push(r),null==this._series[i]){var s=new h(this.getCtx(),this.HandleEvent,this);this._series.push(s)}}}else this._series=[]},e.Timeline.prototype.onAnimationEnd=function(){this.AnimationStopped||this.RenderComplete(),this.EventManager.addListeners(this),this.Animation=null,this.AnimationStopped=!1},e.Timeline.prototype._getOverviewObject=function(){var e=new Object;e.start=this._start,e.end=this._end,e.renstart=this._viewStartTime,e.width=this._contentLength,e.selmode=this._selectionMode,e.rtl=this.isRTL(),e.sid="ts1";var t=l.getOverviewWindowBackgroundColor(this.Options);e._wbc=t,e._hfc=t;var i=l.getOverviewWindowBorderColor(this.Options);if(e._wbtc=i,e._wbrc=i,e._wbbc=i,e._wblc=i,e._ls=l.getOverviewLabelStyle(this.Options).toString(),e._obc=l.getOverviewBackgroundColor(this.Options),e._ctic=l.getReferenceObjectColor(this.Options),this._referenceObjects&&this._referenceObjects.length>0&&this._referenceObjects[0]&&(e.ocd=this._referenceObjects[0].getTime()),this._isVertical){e.orn="vertical";var r=this._resources.overviewHandleVert;r&&(e._hbi=r,e._hw=15,e._hh=3)}else e.orn="horizontal",(r=this._resources.overviewHandleHor)&&(e._hbi=r,e._hw=3,e._hh=15),e._ds="square",e._dsx="1.3d",e._dsy="0.9d";return e.axisTicks=this._getOverviewAxisOptions(),e.markers=this._getOverviewMarkerOptions(),e},e.Timeline.prototype._getOverviewAxisOptions=function(){var t=[];if(this._seriesTimeAxis){var i,r;if(this._customTimeScales&&this._customTimeScales[this._seriesScale]){var s=this._customTimeScales[this._seriesScale];i=s.times,r=s.labels}else if(this._seriesCustomFormatScales&&this._seriesCustomFormatScales[this._seriesScale]){var n=this._seriesCustomFormatScales[this._seriesScale];i=n.times,r=n.labels}else{i=[],r=[];for(var a=this._start,o=this._end,l=this._isVertical?this.Height:this.Width,h=e.TimeAxis.getPositionDate(a,o,this._fetchStartPos,l),_=this._seriesTimeAxis.adjustDate(h),c=e.TimeAxis.getDatePosition(a,o,_,l);c<this._fetchEndPos;)r.push(this._seriesTimeAxis.formatDate(_)),i.push(_.getTime()),_=this._seriesTimeAxis.getNextDate(_.getTime()),c=e.TimeAxis.getDatePosition(a,o,_,l)}for(var u=0;u<r.length;u++){var g=new Object;g.time=i[u],g.label=r[u],t.push(g)}}return t},e.Timeline.prototype._getOverviewMarkerOptions=function(){if(this._series){for(var e=[],t=this._series.length,i=0;i<t;i++)for(var r=this._series[i]._items,s=0;s<r.length;s++){var n=r[s],a=new Object;a.rk=s,a.tid=n.getId(),a.t=n.getStartTime(),a._sd=n.getMarkerSD(),this._isVertical||(n.getMarkerShape()&&(a.s=n.getMarkerShape()),n.getMarkerScaleX()&&(a.sx=n.getMarkerScaleX()),n.getMarkerScaleY()&&(a.sy=n.getMarkerScaleY())),n.getMarkerShortDesc()&&(a.d=n.getMarkerShortDesc()),n.getMarkerFillColor()&&(a.c=n.getMarkerFillColor()),n.getMarkerGradientFill()&&(a.g=n.getMarkerGradientFill()),n.getMarkerOpacity()&&(a.o=n.getMarkerOpacity());var o=n.getEndTime();if(o){a.et=o;var l=n.getDurationFillColor();l&&(a.dfc=l)}e.push(a)}return e}},e.Timeline.prototype.createViewportChangeEvent=function(){return e.EventFactory.newTimelineViewportChangeEvent(this._viewStartTime,this._viewEndTime,this._timeAxis.getScale())},e.Timeline.prototype.HandleTouchStart=function(e){1==e.touches.length&&(this._dragPanSeries=this._findSeries(e.target))},e.Timeline.prototype.HandleMouseWheel=function(t){if(e.Timeline.superclass.HandleMouseWheel.call(this,t),this.hasValidOptions()&&t.zoomWheelDelta){var i=this.getCtx().pageToStageCoords(t.pageX,t.pageY);if(this.getGraphicalAreaBounds().containsPoint(i.x,i.y)){var r=this.getContentLength()*t.zoomWheelDelta,s=t.zoomTime,n=t.zoomCompLoc;this.handleZoomWheel(r,s,n,!0)}}},e.Timeline.prototype.handleZoomWheel=function(t,i,r,s){t>this._timeAxis.getMaxContentLength()?(t=this._timeAxis.getMaxContentLength(),this.disableZoomButton(!0)):this.enableZoomButton(!0),this._canvasLength>t?(t=this._canvasLength,this.disableZoomButton(!1)):this.enableZoomButton(!1);var n=this.getContentLength()<=t;e.Timeline.superclass.handleZoomWheel.call(this,t,i,r,s);var a=this._timeAxis.getZoomLevelLengths();if(n)for(;this._timeAxis.getZoomLevelOrder()>0;){var l=a[this._timeAxis.getZoomLevelOrder()-1];if(!(this.getContentLength()>=l))break;this._timeAxis.setZoomLevelOrder(this._timeAxis.getZoomLevelOrder()-1),this._timeAxis.decreaseScale()}else for(;this._timeAxis.getZoomLevelOrder()<a.length-1&&(l=a[this._timeAxis.getZoomLevelOrder()],this.getContentLength()<l);)this._timeAxis.setZoomLevelOrder(this._timeAxis.getZoomLevelOrder()+1),this._timeAxis.increaseScale();if(this._hasOverview){if(this._isVertical)var h=this._overview.Height;else h=this._overview.Width;this._overview.setViewportRange(this._viewStartTime,this._viewEndTime,h)}if(this.isTimeDirScrollbarOn()&&this.timeDirScrollbar.setViewportRange(this._viewStartTime,this._viewEndTime),this.applyAxisStyleValues(),o._renderAxis(this,this._timeZoomCanvas),this.updateSeries(),this.isContentDirScrollbarOn())for(var _=0;_<this._series.length;_++)this.contentDirScrollbar[_].setViewportRange(0,this._seriesSize,0,Math.max(this._series[_]._maxOverflowValue,this._seriesSize));s&&this.dispatchEvent(this.createViewportChangeEvent())},e.Timeline.prototype.updateSeries=function(){if(this._series){var t=this._series.length,i=this.getTimeAxisVisibleSize(t);this._seriesSize=(this._canvasSize-i)/t;for(var r=0;r<t;r++){var s=this._series[r];s.setClipPath(null);var n=new e.ClipPath;if(this._isVertical){if(this.isRTL())var a=Math.abs(r-1);else a=r;if(this.isRTL()&&1==this._series.length){n.addRect(i,0,this._seriesSize,this.getContentLength());var o=new e.Matrix(1,0,0,1,i,0)}else n.addRect(a*(this._seriesSize+i),0,this._seriesSize,this.getContentLength()),o=new e.Matrix(1,0,0,1,a*(this._seriesSize+i),0);var l=this._seriesSize,h=this.getContentLength()}else n.addRect(0,r*(this._seriesSize+i),this.getContentLength(),this._seriesSize),o=new e.Matrix(1,0,0,1,0,r*(this._seriesSize+i)),l=this.getContentLength(),h=this._seriesSize;s.setClipPath(n),s.setMatrix(o),s.render(null,l,h)}}},e.Timeline.prototype._handleResize=function(e,t){if(this.Width=e,this.Height=t,this.applyStyleValues(),this._fetchStartPos=0,this._isVertical?this._fetchEndPos=t:this._fetchEndPos=e,this.prepareViewportLength(),o._renderBackground(this),this.hasValidOptions()){if(this.renderTimeZoomCanvas(this._canvas),this.applyAxisStyleValues(),this.updateSeries(),o._renderAxis(this,this._timeZoomCanvas),o._renderSeriesLabels(this),o._renderZoomControls(this),this._hasOverview&&(o._renderOverview(this),this.SelectionHandler)){var i=this.SelectionHandler.getSelectedIds();if(i&&0!=i.length)for(var r=0;r<i.length;r++)this._overview.selSelectItem(i[r])}(this.isTimeDirScrollbarOn()||this.isContentDirScrollbarOn())&&o._renderScrollbars(this)}else o._renderEmptyText(this);this.Animation||this.RenderComplete()},e.Timeline.prototype.HandleKeyDown=function(t){e.KeyboardEvent.RIGHT_ARROW!=t.keyCode&&e.KeyboardEvent.LEFT_ARROW!=t.keyCode&&e.KeyboardEvent.DOWN_ARROW!=t.keyCode&&e.KeyboardEvent.UP_ARROW!=t.keyCode||this.updateScrollForItemNavigation(this.EventManager.getFocus())},e.Timeline.prototype.HandleMouseDown=function(e){this._dragPanSeries=this._findSeries(e.target)},e.Timeline.prototype.endDragPan=function(){this._dragPanSeries=null,this.endPan()},e.Timeline.prototype.endPan=function(){this._triggerViewportChange&&(this._triggerViewportChange=!1,this.dispatchEvent(this.createViewportChangeEvent()))},e.Timeline.prototype.panBy=function(e,t){var i=this._series.length,r=this.getTimeAxisVisibleSize(i);if(this._isVertical){if(this._dragPanSeries){var s=this._dragPanSeries.getTranslateX()-e;if(this._series.length>1&&(!this.isRTL()&&this._dragPanSeries._isInverted||this.isRTL()&&!this._dragPanSeries._isInverted))var n=r+2*this._dragPanSeries.Width-this._dragPanSeries._maxOverflowValue,a=this._dragPanSeries.Width+r;else this.isRTL()&&!this._dragPanSeries._isInverted?(n=this._dragPanSeries.Width-this._dragPanSeries._maxOverflowValue+r,a=r):(n=0,a=this._dragPanSeries._maxOverflowValue-this._dragPanSeries.Width);if(s<n?s=n:s>a&&(s=a),this._dragPanSeries.setTranslateX(s),this.isContentDirScrollbarOn())if(this._series[0]==this._dragPanSeries)if(this.isRTL()){if(2==i)var o=this.getTimeAxisVisibleSize()+this._seriesSize-s;else o=this.getTimeAxisVisibleSize()-s;this.contentDirScrollbar[0].setViewportRange(o,o+this._seriesSize)}else this.contentDirScrollbar[0].setViewportRange(s,s+this._seriesSize);else this.isRTL()?this.contentDirScrollbar[1].setViewportRange(s,s+this._seriesSize):(o=this.getTimeAxisVisibleSize()+this._seriesSize-s,this.contentDirScrollbar[1].setViewportRange(o,o+this._seriesSize))}if(this.panZoomCanvasBy(t),this._hasOverview){var l=this._overview.Height;this._overview.setViewportRange(this._viewStartTime,this._viewEndTime,l)}this.isTimeDirScrollbarOn()&&this.timeDirScrollbar.setViewportRange(this._viewStartTime,this._viewEndTime)}else if(this.panZoomCanvasBy(e),this._hasOverview&&(l=this._overview.Width,this._overview.setViewportRange(this._viewStartTime,this._viewEndTime,l)),this.isTimeDirScrollbarOn()&&this.timeDirScrollbar.setViewportRange(this._viewStartTime,this._viewEndTime),this._dragPanSeries){var h=this._dragPanSeries.getTranslateY()-t;if(this._dragPanSeries._isInverted)var _=r+2*this._dragPanSeries.Height-this._dragPanSeries._maxOverflowValue,c=this._dragPanSeries.Height+r;else _=0,c=this._dragPanSeries._maxOverflowValue-this._dragPanSeries.Height;h<_?h=_:h>c&&(h=c),this._dragPanSeries.setTranslateY(h),this.isContentDirScrollbarOn()&&(this._series[0]==this._dragPanSeries?this.contentDirScrollbar[0].setViewportRange(h,h+this._seriesSize):(o=this.getTimeAxisVisibleSize()+this._seriesSize-h,this.contentDirScrollbar[1].setViewportRange(o,o+this._seriesSize)))}},e.Timeline.prototype.HandleEvent=function(t,i){var r=t.type;if((r=t.type)==e.SimpleScrollbarEvent.TYPE)t=this.processScrollbarEvent(t,i);else if("selection"==r||"action"==r)e.EventDispatcher.dispatchEvent(this._callback,this._callbackObj,this,t);else if("overview"==r){if("rangeChanging"==(c=t.getSubType())||"rangeChange"==c){var s=this._viewEndTime-this._viewStartTime;this._viewStartTime=t.getNewStartTime(),this._viewEndTime=t.getNewEndTime();var n=this._viewEndTime-this._viewStartTime;if(n>0){var a=this._canvasLength/n;this.setContentLength(a*(this._end-this._start)),this.setRelativeStartPos(a*(this._start-this._viewStartTime));var l=this._timeAxis.getZoomLevelLengths();if(s>n){for(var h=l[(_=l.length)-1];this.getContentLength()>=h&&_>0;)h=l[--_-1];_==l.length&&_--,this._timeAxis.setZoomLevelOrder(_),this._timeAxis.setScale(this._timeAxis.getZoomOrder()[_])}else{var _;for(h=l[_=0];this.getContentLength()<h&&_<l.length-1;)h=l[++_];this._timeAxis.setZoomLevelOrder(_),this._timeAxis.setScale(this._timeAxis.getZoomOrder()[_])}this.applyAxisStyleValues(),o._renderAxis(this,this._timeZoomCanvas),this.updateSeries(),this.applyTimeZoomCanvasPosition()}"rangeChange"==c&&this.dispatchEvent(this.createViewportChangeEvent())}"scrollPos"!=c&&"scrollTime"!=c||(this._viewStartTime=t.getNewStartTime(),this._viewEndTime=t.getNewEndTime(),a=this.getContentLength()/(this._end-this._start),this.setRelativeStartPos(a*(this._start-this._viewStartTime)),this.applyTimeZoomCanvasPosition(),this.dispatchEvent(this.createViewportChangeEvent()))}else if(r="timeline"){var c;if("selection"==(c=t.getSubType())){for(var u=t.getItemId(),g=t.isMultiSelect()&&"multiple"==this._selectionMode,d=0;d<this._series.length;d++)for(var m=this._series[d],v=0;v<m._items.length;v++)if((p=m._items[v]).getId()==u){this.EventManager.setFocusObj(p),this.updateScrollForItemSelection(p),this.SelectionHandler._addToSelection(p,g)&&this.EventManager.fireSelectionEvent(p);break}}else if("highlight"==c){var S=t.getItemId();for(d=0;d<this._series.length;d++)for(m=this._series[d],v=0;v<m._items.length;v++)if((p=m._items[v]).getId()==S){p.showHoverEffect(!0);break}}else if("unhighlight"==c)for(S=t.getItemId(),d=0;d<this._series.length;d++)for(m=this._series[d],v=0;v<m._items.length;v++){var p;if((p=m._items[v]).getId()==S){p.hideHoverEffect(!0);break}}}},e.Timeline.prototype.processScrollbarEvent=function(t,i){if(e.Timeline.superclass.processScrollbarEvent.call(this,t,i),i==this.contentDirScrollbar[0]){var r=t.getNewMin();this.isVertical()?2==this._series.length?this._series[0].setTranslateX(this.isRTL()?this.getTimeAxisVisibleSize()+this._seriesSize-r:r):this._series[0].setTranslateX(this.isRTL()?this.getTimeAxisVisibleSize()-r:r):this._series[0].setTranslateY(r)}else i==this.contentDirScrollbar[1]&&(r=t.getNewMin(),this.isVertical()?this._series[1].setTranslateX(this.isRTL()?r:this.getTimeAxisVisibleSize()+this._seriesSize-r):this._series[1].setTranslateY(this.getTimeAxisVisibleSize()+this._seriesSize-r))},e.Timeline.prototype.updateScrollForItemSelection=function(e){var t=this._viewEndTime-this._viewStartTime;this._viewStartTime=e.getStartTime()-t/2,this._viewStartTime<this._start?this._viewStartTime=this._start:this._viewStartTime+t>this._end&&(this._viewStartTime=this._end-t),this._viewEndTime=this._viewStartTime+t;var i=this.getContentLength()/(this._end-this._start);this.setRelativeStartPos(i*(this._start-this._viewStartTime)),this.applyTimeZoomCanvasPosition(),this.dispatchEvent(this.createViewportChangeEvent())},e.Timeline.prototype.updateScrollForItemNavigation=function(e){var t=this._isVertical?e.getHeight():e.getWidth(),i=l.getItemHoverStrokeWidth(),r=e.getLoc()-(this._isVertical?t/2+i:l.getBubbleOffset()+i),s=this.getRelativeStartPos();this.isRTL()&&!this._isVertical&&(r-=i);var n=r+t+2*i,a=s-this._canvasLength;-r>s?s=-r:-n<a&&(s=-n+this._canvasLength);var o=this.getContentLength()/(this._end-this._start),h=this._viewEndTime-this._viewStartTime;if(this._viewStartTime=this._start-s/o,this._viewStartTime<this._start&&(this._viewStartTime=this._start,s=(this._start-this._viewStartTime)*o),this._viewEndTime=this._viewStartTime+h,this._viewEndTime>this._end&&(this._viewEndTime=this._end,this._viewStartTime=this._viewEndTime-h,s=(this._start-this._viewStartTime)*o),this.setRelativeStartPos(s),this.applyTimeZoomCanvasPosition(),this._hasOverview){if(this._isVertical)var _=this._overview.Height;else _=this._overview.Width;this._overview.setViewportRange(this._viewStartTime,this._viewEndTime,_)}this.isTimeDirScrollbarOn()&&this.timeDirScrollbar.setViewportRange(this._viewStartTime,this._viewEndTime),this.dispatchEvent(this.createViewportChangeEvent())},e.Timeline.prototype.handleShapeClick=function(e){if(e){var t=this._findDrawable(e.target);t&&(this._findSeries(t),t._node&&this._findSeries(t).HandleItemAction(t._node))}},e.Timeline.prototype.applyInitialSelections=function(){if(this.Options.selection)for(var e=[],t=0;t<this._series.length;t++)for(var i=this._series[t],r=0;r<i._items.length;r++)e.push(i._items[r]);this.SelectionHandler.processInitialSelections(this.Options.selection,e)},e.Timeline.prototype._findSeries=function(e){if(this.hasValidOptions()&&e&&e!=this){var t=e.getId();return e==this._series[0]||this._series.length>1&&e==this._series[1]?e:t&&"_s0"==t.substring(t.length-3,t.length)?this._series[0]:t&&"_s1"==t.substring(t.length-3,t.length)?this._series[1]:this._findSeries(e.getParent())}return null},e.Timeline.prototype._findDrawable=function(e){if(e){var t=e.getId();if(t&&"_duration_"==t.substring(0,10)&&e._node)return e;var i=e.getParent();if(i){if(t&&"zoom"==t.substring(0,4))return e;if(t&&"_bubble_"==t.substring(0,8)&&i._node)return i;var r=i.getParent();if(r){if(t&&"_bubble_"==t.substring(0,8)&&r._node)return r;if((t=r.getId())&&"_bubble_"==t.substring(0,8)&&r.getParent())return r.getParent()}}}return null},e.Timeline.prototype.getAutomation=function(){return this.Automation||(this.Automation=new s(this)),this.Automation},e.Timeline.prototype.clearComponent=function(){e.Timeline.superclass.clearComponent.call(this),this.clearOverview()},e.Timeline.prototype.clearOverview=function(){this._overviewCanvas&&(this.removeChild(this._overviewCanvas),this._overviewCanvas=null)},e.Timeline.prototype.isTimeDirScrollbarOn=function(){return!this._hasOverview},e.Timeline.prototype.isContentDirScrollbarOn=function(){return!0},e.Timeline.prototype.getBackgroundXOffset=function(){return this._backgroundX},e.Timeline.prototype.setBackgroundXOffset=function(e){this._backgroundX=e};var s=function(e){this._timeline=e};e.Obj.createSubclass(s,e.Automation),s.TIMELINE_ITEM_STRING="timelineItem",s.prototype.GetSubIdForDomElement=function(t){var i=this._timeline.EventManager.GetLogicalObject(t);if(i&&i instanceof u)for(var r=0;r<this._timeline._series.length;r++){var n=this._timeline._series[r],a=e.ArrayUtils.getIndex(n._items,i);if(-1!=a)return s.TIMELINE_ITEM_STRING+"["+r+"]["+a+"]"}return null},s.prototype.getDomElementForSubId=function(e){if(e){var t=e.indexOf("[");if(t>0&&e.substring(0,t)===s.TIMELINE_ITEM_STRING){var i=e.indexOf("]");if(i>0){var r=parseInt(e.substring(t+1,i)),n=parseInt(e.substring(i+2,e.length-1)),a=this._timeline._series[r];if(a){var o=a._items[n];if(o)return o.getDisplayables()[0].getElem()}}}}return null};var n=function(){this.Init({alta:n.VERSION_1})};e.Obj.createSubclass(n,e.BaseComponentDefaults),n.VERSION_1={animationOnDataChange:"none",animationOnDisplay:"none",orientation:"horizontal",overview:{rendered:"off"},selectionMode:"none",styleDefaults:{animationDuration:500,borderColor:"#d9dfe3",item:{backgroundColor:"#ffffff",borderColor:"#648baf",descriptionStyle:new e.CSSStyle("font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-size: 12px; color: #084B8A; white-space: nowrap;"),hoverBorderColor:"#85bbe7",selectedBorderColor:"#000000",titleStyle:new e.CSSStyle("font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-size: 12px; font-weight: bold; color: #000000; white-space: nowrap;")},majorAxis:{labelStyle:new e.CSSStyle("font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-size: 14px; font-weight: bold; color: #4f4f4f; white-space: nowrap;"),separatorColor:"#bcc7d2"},minorAxis:{backgroundColor:"#f9f9f9",borderColor:"#d9dfe3",labelStyle:new e.CSSStyle("font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-size: 12px; color: #333333;"),separatorColor:"#bcc7d2"},overview:{backgroundColor:"#e6ecf3",labelStyle:new e.CSSStyle("font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-size: 12px; font-weight: bold; color: #4f4f4f;"),window:{backgroundColor:"#ffffff",borderColor:"#4f4f4f"}},referenceObject:{color:"#ff591f"},series:{backgroundColor:"#f9f9f9",colors:e.CSSStyle.COLORS_ALTA,emptyTextStyle:new e.CSSStyle("font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-size: 12px; font-weight: normal; color: #333333; white-space: nowrap;"),labelStyle:new e.CSSStyle("font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-size: 13px; font-weight: bold; color: #252525; white-space: nowrap;")}}};var a=function(){};e.Obj.createSubclass(a,e.Obj),a.prototype.parse=function(e){var t=new Object;t.start=new Date(e.start).getTime(),t.end=new Date(e.end).getTime(),e.viewportStart&&(t.viewStart=new Date(e.viewportStart).getTime()),e.viewportEnd&&(t.viewEnd=new Date(e.viewportEnd).getTime()),e.selectionMode?t.selectionMode=e.selectionMode:t.selectionMode="none",t.inlineStyle=e.style,e.svgStyle&&(t.inlineStyle=e.svgStyle);var i=e.minorAxis;if(i){var r=i.scale;t.scale=r,t.customFormatScales=i._cfs}var s=e.majorAxis;s&&(t.seriesScale=s.scale,t.seriesConverter=s.converter,t.seriesCustomFormatScales=s._cfs),t.shortDesc=e.shortDesc,t.orientation=e.orientation;var n=e.referenceObjects;if(n&&n.length>0){for(var a=[],o=0;o<n.length;o++)a.push(new Date(n[o].value));t.referenceObjects=a}var l=e.overview;return null!=l&&"on"==l.rendered?t.hasOverview=!0:t.hasOverview=!1,t.timeZoneOffsets=e._tzo,t.itemPosition=e._ip,t.customTimeScales=e._cts,t};var o=new Object;e.Obj.createSubclass(o,e.Obj),o.renderTimeline=function(t){if(o._renderBackground(t),o._renderScrollableCanvas(t),t.hasValidOptions()){t.renderTimeZoomCanvas(t._canvas);var i=t.getTimeZoomCanvas();if(o._renderSeries(t,i),o._renderSeriesLabels(t),o._renderAxis(t,i),t._hasOverview?o._renderOverview(t):t.clearOverview(),t._keyboardHandler)for(var r=0;r<t._series.length;r++)if((s=t._series[r])._items&&s._items.length>0){
t.EventManager.setFocusObj(s._items[0]);break}for((t.isTimeDirScrollbarOn()||t.isContentDirScrollbarOn())&&o._renderScrollbars(t),o._renderZoomControls(t),t.SelectionHandler&&t.applyInitialSelections(),e.TimeAxis.supportsTouch()&&t._setAriaProperty("flowto",t._series[0].getId()),r=0;r<t._series.length;r++){var s;(s=t._series[r]).triggerAnimations()}}else o._renderEmptyText(t)},o._renderBackground=function(t){t._background?(t._background.setClipPath(null),t._background.setWidth(t._backgroundWidth),t._background.setHeight(t._backgroundHeight)):t._background=new e.Rect(t.getCtx(),0,0,t._backgroundWidth,t._backgroundHeight,"bg");var i=t.getBackgroundXOffset();t._background.setTranslateX(i),t._background.setCSSStyle(t._style),t._background.setPixelHinting(!0);var r=new e.ClipPath;r.addRect(i,0,t._backgroundWidth,t._backgroundHeight),t._background.setClipPath(r),t._background.getParent()!=t&&t.addChild(t._background)},o._renderScrollableCanvas=function(t){t._canvas||(t._canvas=new e.Container(t.getCtx(),"canvas"),t.addChild(t._canvas))},o._renderSeries=function(t,i){var r=t.getTimeAxis();if(t._series){var s=t.getCtx(),n=e.Agent.isRightToLeft(s),a=t._series.length,o=t.getTimeAxisVisibleSize(a);t.isVertical()||a>1&&t._canvasSize%2!=o%2&&(r.setContentSize(r.getContentSize()+1),o=t.getTimeAxisVisibleSize(a)),t._seriesSize=(t._canvasSize-o)/a;for(var l=0;l<a;l++){var h=t._series[l];h.setClipPath(null);var _=new e.ClipPath;if(t.isVertical()){if(n)var c=Math.abs(l-1);else c=l;if(n&&1==t._series.length){_.addRect(o,0,t._seriesSize,t.getContentLength());var u=new e.Matrix(1,0,0,1,o,0)}else _.addRect(c*(t._seriesSize+o),0,t._seriesSize,t.getContentLength()),u=new e.Matrix(1,0,0,1,c*(t._seriesSize+o),0);var g=t._seriesSize,d=t.getContentLength()}else _.addRect(0,l*(t._seriesSize+o),t.getContentLength(),t._seriesSize),u=new e.Matrix(1,0,0,1,0,l*(t._seriesSize+o)),g=t.getContentLength(),d=t._seriesSize;h.setClipPath(_),h.setMatrix(u),h.getParent()!=i&&i.addChild(h),h.render(t._seriesOptions[l],g,d)}}},o._renderSeriesLabels=function(t){if(t._series){var i=t.getCtx(),r=e.Agent.isRightToLeft(i);if(t._seriesLabels)for(var s=0;s<t._seriesLabels.length;s++)t.removeChild(t._seriesLabels[s]);t._seriesLabels=[];var n=t._series.length,a=l.getSeriesLabelSpacing(),o=2*e.TransientButton._DEFAULT_RADIUS+6,h=2*a;for(s=0;s<n;s++){var _=t._series[s],c=_.getLabel();if(null!=c){var u=l.getSeriesLabelStyle(t.Options),g=new e.CSSStyle(l.getSeriesLabelBackgroundStyle());if(_._style){var d=_._style.getStyle(e.CSSStyle.BACKGROUND_COLOR);d&&g.setStyle(e.CSSStyle.BACKGROUND_COLOR,d)}var m=new e.OutputText(i,c,0,0,"sl_s"+s);m.setCSSStyle(u);var v=m.getDimensions();if(t.isVertical())var S=t._seriesSize;else S=t._canvasLength;var p=Math.min(v.w,S-(s-1)*-o-h),f=l.getSeriesLabelPadding(),T=new e.Rect(i,0,0,p+2*f,v.h+2*f,"slb_s"+s);if(T.setCSSStyle(g),T.setAlpha(l.getSeriesLabelBackgroundOpacity()),T.setCornerRadius(3),t.isVertical())O=r?Math.abs(s-1)*(t._canvasSize-p-h)+a+t._startX+(s-1)*o:s*(t._canvasSize-p-h)+a+t._startX+(s-1)*-o,b=t._startY+a;else{if(r)var O=t._canvasLength-p-a-(s-1)*-o;else O=t._startX+a+(s-1)*-o;var b=s*(t._canvasSize-v.h-h)+a+t._startY}var E=new e.Matrix(1,0,0,1,O,b);m.setMatrix(E),E=new e.Matrix(1,0,0,1,O-f,b-f),T.setMatrix(E),t.addChild(T),e.TextUtils.fitText(m,p,1/0,t),t._seriesLabels.push(T),t._seriesLabels.push(m)}if(_._isEmpty){var y=_.getEmptyText();if(null!=y){var w=new e.OutputText(i,y,0,0,"et_s"+s);w.setCSSStyle(l.getEmptyTextStyle(t.Options)),v=w.getDimensions(),E=new e.Matrix(1,0,0,1,(t._canvasLength-v.w)/2+t._startX,s*(t._seriesSize+t.getTimeAxisVisibleSize(n))+(t._seriesSize-v.h)/2+t._startY),w.setMatrix(E),t.addChild(w),t._seriesLabels.push(w)}}}}},o._renderAxis=function(t,i){var r=t.getCtx(),s=e.Agent.isRightToLeft(r),n=t.getTimeAxis(),a=t._series.length,l=t.getTimeAxisSize(),h=t.getTimeAxisVisibleSize(a),_=1==a?t._canvasSize-h:t._canvasSize/a-h/2;if(s&&t.isVertical()&&1==t._series.length&&(_=0),n.getParent()!==i&&i.addChild(n),t.isVertical()){var c=new e.Matrix(1,0,0,1,_,0);n.render(null,l,t.getContentLength())}else c=new e.Matrix(1,0,0,1,0,_),n.render(null,t.getContentLength(),l);n.setMatrix(c),o._renderSeriesTimeAxis(t,t._fetchStartPos,t._fetchEndPos,t.getTimeZoomCanvas(),t.getContentLength())},o._renderSeriesTimeAxis=function(t,i,r,s,n){var a=t.getCtx(),h=e.Agent.isRightToLeft(a);if(t._majorAxisLabels)for(var _=0;_<t._majorAxisLabels.length;_++)s.removeChild(t._majorAxisLabels[_]);if(t._majorAxisLabels=[],t._seriesScale){var c,u,g=t._start,d=t._end;if(t._customTimeScales&&t._customTimeScales[t._seriesScale]){var m=t._customTimeScales[t._seriesScale];c=m.times,u=m.labels}else if(t._seriesCustomFormatScales&&t._seriesCustomFormatScales[t._seriesScale]){var v=t._seriesCustomFormatScales[t._seriesScale];c=v.times,u=v.labels}else{c=[],u=[];var S=e.TimeAxis.getPositionDate(g,d,i,n),p=t._seriesTimeAxis.adjustDate(S),f=e.TimeAxis.getDatePosition(g,d,p,n);for(c.push(p.getTime());f<r;)u.push(t._seriesTimeAxis.formatDate(p)),p=t._seriesTimeAxis.getNextDate(p.getTime()),f=e.TimeAxis.getDatePosition(g,d,p,n),c.push(p.getTime())}var T=l.getSeriesAxisLabelStyle(t.Options),O=l.getSeriesAxisLabelPadding(),b=new e.CSSStyle(l.getSeriesAxisLabelBackgroundStyle());if(t._series[0]&&t._series[0]._style){var E=t._series[0]._style.getStyle(e.CSSStyle.BACKGROUND_COLOR);E&&b.setStyle(e.CSSStyle.BACKGROUND_COLOR,E)}var y=l.getSeriesAxisLabelBackgroundOpacity();for(_=0;_<u.length;_++){var w=u[_],C=c[_];f=e.TimeAxis.getDatePosition(g,d,C,n);var A=e.TimeAxis.getDatePosition(g,d,c[_+1],n)-f;if(h)D=t.isVertical()?o._addLabel(a,s,t._canvasSize-5,w,A,f+18,T,"o_label"+f+"_s0",!0,b,y,O,t._majorAxisLabels,h):o._addLabel(a,s,n-(f+5),w,A,t._seriesSize-2,T,"o_label"+f+"_s0",!0,b,y,O,t._majorAxisLabels,h);else if(t.isVertical())var D=o._addLabel(a,s,5,w,A,f+18,T,"o_label"+f+"_s0",!0,b,y,O,t._majorAxisLabels,h);else D=o._addLabel(a,s,f+5,w,A,t._seriesSize-2,T,"o_label"+f+"_s0",!0,b,y,O,t._majorAxisLabels,h);D.time=c[_]}}},o._renderOverview=function(t){var i=t.getCtx(),r=e.Agent.isRightToLeft(i);if(null==t._overviewCanvas){var s=!0;t._overviewCanvas=new e.Container(i,"oCanvas")}else t._overviewCanvas.removeChildren(),t._overviewCanvas.setClipPath(null);var n,a,o,l,h=t._style.getBorderWidth(),_=h/2;t.isVertical()?(n=t._overviewSize,a=t._backgroundHeight-h,l=_,o=r?_:t._backgroundWidth-t._overviewSize-_):(n=t._backgroundWidth-h,a=t._overviewSize,l=t._backgroundHeight-t._overviewSize-_,o=_+t.getBackgroundXOffset()),t._overviewCanvas.setTranslateX(o),t._overviewCanvas.setTranslateY(l);var c=new e.ClipPath;c.addRect(o,l,n,a),t._overviewCanvas.setClipPath(c),s&&t.addChild(t._overviewCanvas),t._overview=new e.TimelineOverview(i,t.HandleEvent,t),t._overviewCanvas.addChild(t._overview);var u=t._getOverviewObject();t._overview.render(u,n,a)},o._renderScrollbars=function(t){var i=t.getCtx(),r=t.getScrollbarPadding();if(null==t._scrollbarsCanvas?(t._scrollbarsCanvas=new e.Container(i,"sbCanvas"),t.addChild(t._scrollbarsCanvas)):(t._scrollbarsCanvas.removeChildren(),t.setTimeDirScrollbar(null),t.setContentDirScrollbar(null)),t.isTimeDirScrollbarOn()){if(t.isVertical()){if(e.Agent.isRightToLeft(t.getCtx()))var s=2*r+1;else s=t.Width-1.5*r;var n=t.getCanvasLength()}else s=t.getCanvasLength(),n=t.Height-1.5*r;var a=o._prerenderTimeDirScrollbar(t,t._scrollbarsCanvas,new e.Rectangle(0,0,s,n))}if(t.isContentDirScrollbarOn()){t.isVertical()?(s=t._seriesSize,n=t.Height-1.5*r):(s=e.Agent.isRightToLeft(t.getCtx())?2*r+1:t.Width-1.5*r,n=t._seriesSize);for(var l=t._series.length,h=[],_=0;_<l;_++)h[_]=o._prerenderContentDirScrollbar(t,t._scrollbarsCanvas,new e.Rectangle(0,0,s,n),_)}if(t.timeDirScrollbar){var c={};c.color=t.timeDirScrollbarStyles.getStyle(e.CSSStyle.COLOR),c.backgroundColor=t.timeDirScrollbarStyles.getStyle(e.CSSStyle.BACKGROUND_COLOR),c.min=t._start,c.max=t._end,t.isVertical()?(c.isReversed=!1,c.isHorizontal=!1,t.timeDirScrollbar.setTranslateY(t.getStartYOffset())):(c.isReversed=e.Agent.isRightToLeft(i),c.isHorizontal=!0,t.timeDirScrollbar.setTranslateX(t.getStartXOffset())),t.timeDirScrollbar.render(c,a.w,a.h),t.timeDirScrollbar.setViewportRange(t._viewStartTime,t._viewEndTime)}if(t.contentDirScrollbar)for(_=0;_<l;_++)(c={}).color=t.contentDirScrollbarStyles.getStyle(e.CSSStyle.COLOR),c.backgroundColor=t.contentDirScrollbarStyles.getStyle(e.CSSStyle.BACKGROUND_COLOR),c.isHorizontal=t.isVertical(),0==_?(c.min=0,c.max=Math.max(t._series[_]._maxOverflowValue,h[_].h),t.isVertical()?e.Agent.isRightToLeft(i)?(c.isReversed=!1,2==l?t.contentDirScrollbar[_].setTranslateX(t.getStartXOffset()+t._seriesSize+t.getTimeAxisVisibleSize(l)):t.contentDirScrollbar[_].setTranslateX(t.getStartXOffset()+t.getTimeAxisVisibleSize(l))):(c.isReversed=!0,t.contentDirScrollbar[_].setTranslateX(t.getStartXOffset())):(c.isReversed=!0,t.contentDirScrollbar[_].setTranslateY(t.getStartYOffset()))):(c.min=0,c.max=Math.max(t._series[_]._maxOverflowValue,h[_].h),t.isVertical()?e.Agent.isRightToLeft(i)?(c.isReversed=!0,t.contentDirScrollbar[_].setTranslateX(t.getStartXOffset())):(c.isReversed=!1,t.contentDirScrollbar[_].setTranslateX(t.getStartXOffset()+t._seriesSize+t.getTimeAxisVisibleSize(l))):(c.isReversed=!1,t.contentDirScrollbar[_].setTranslateY(t.getStartYOffset()+t._seriesSize+t.getTimeAxisVisibleSize(l)))),t.contentDirScrollbar[_].render(c,h[_].w,h[_].h),t.contentDirScrollbar[_].setViewportRange(0,t._seriesSize)},o._prerenderTimeDirScrollbar=function(t,i,r){if(t.setTimeDirScrollbar(new e.SimpleScrollbar(t.getCtx(),t.HandleEvent,t)),i.addChild(t.timeDirScrollbar),t.isVertical())var s="right",n=e.CSSStyle.toNumber(t.timeDirScrollbarStyles.getWidth()),a=r.h;else s="bottom",n=r.w,a=e.CSSStyle.toNumber(t.timeDirScrollbarStyles.getHeight());return e.LayoutUtils.position(r,s,t.timeDirScrollbar,n,a,0),new e.Dimension(n,a)},o._prerenderContentDirScrollbar=function(t,i,r,s){if(t.setContentDirScrollbar(new e.SimpleScrollbar(t.getCtx(),t.HandleEvent,t),s),i.addChild(t.contentDirScrollbar[s]),t.isVertical())var n="bottom",a=r.w,o=e.CSSStyle.toNumber(t.contentDirScrollbarStyles.getHeight());else n="right",a=e.CSSStyle.toNumber(t.contentDirScrollbarStyles.getWidth()),o=r.h;return e.LayoutUtils.position(r,n,t.contentDirScrollbar[s],a,o,0),new e.Dimension(a,o)},o._renderZoomControls=function(t){var i=t.getCtx(),r=t._resources,s=e.Agent.isRightToLeft(i),n={zoomInProps:{imageSize:16,cssUrl:r.zoomIn,cssUrlHover:r.zoomIn_h,cssUrlActive:r.zoomIn_a,cssUrlDisabled:r.zoomIn_d,enabledBackgroundColor:l.getZoomInButtonBackgroundColor(r),enabledBorderColor:l.getZoomInButtonBorderColor(r),hoverBackgroundColor:l.getZoomInButtonHoverBackgroundColor(r),hoverBorderColor:l.getZoomInButtonHoverBorderColor(r),activeBackgroundColor:l.getZoomInButtonActiveBackgroundColor(r),activeBorderColor:l.getZoomInButtonActiveBorderColor(r),disabledBackgroundColor:l.getZoomInButtonDisabledBackgroundColor(r),disabledBorderColor:l.getZoomInButtonDisabledBorderColor(r)},zoomOutProps:{imageSize:16,cssUrl:r.zoomOut,cssUrlHover:r.zoomOut_h,cssUrlActive:r.zoomOut_a,cssUrlDisabled:r.zoomOut_d,enabledBackgroundColor:l.getZoomOutButtonBackgroundColor(r),enabledBorderColor:l.getZoomOutButtonBorderColor(r),hoverBackgroundColor:l.getZoomOutButtonHoverBackgroundColor(r),hoverBorderColor:l.getZoomOutButtonHoverBorderColor(r),activeBackgroundColor:l.getZoomOutButtonActiveBackgroundColor(r),activeBorderColor:l.getZoomOutButtonActiveBorderColor(r),disabledBackgroundColor:l.getZoomOutButtonDisabledBackgroundColor(r),disabledBorderColor:l.getZoomOutButtonDisabledBorderColor(r)}},a=t.getStartXOffset()+l._DEFAULT_ZOOM_CONTROL_PADDING;s&&(t._isVertical&&t._hasOverview?a-=t._overviewSize:a-=t.getBackgroundXOffset(),a=t._backgroundWidth-a-l._DEFAULT_ZOOM_CONTROL_DIAMETER),n.zoomInProps.posX=a,n.zoomOutProps.posX=a;var o=t._startY+l._DEFAULT_ZOOM_CONTROL_PADDING;n.zoomInProps.posY=o,n.zoomOutProps.posY=o+l._DEFAULT_ZOOM_CONTROL_DIAMETER+l._DEFAULT_ZOOM_CONTROL_SPACING,t.renderZoomControls(n)},o._renderEmptyText=function(t){if(t.Options.series)var i=e.Bundle.getTranslatedString(e.Bundle.UTIL_PREFIX,"INVALID_DATA",null);else i=e.Bundle.getTranslatedString(e.Bundle.UTIL_PREFIX,"NO_DATA",null);t.clearComponent(),e.TextUtils.renderEmptyText(t._canvas,i,new e.Rectangle(0,0,t._backgroundWidth,t._backgroundHeight),t.EventManager,l.getEmptyTextStyle(t.Options))},o._addLabel=function(t,i,r,s,n,a,o,l,h,_,c,u,g,d){var m=new e.OutputText(t,s,r,0,l);null!=o&&m.setCSSStyle(o);var v=m.getDimensions();if(a-=v.h,m.setY(a),d&&m.setX(r-v.w),h){var S=Math.min(v.w+2*u,n);if(d)p=r-S+2*u;else var p=r;var f=new e.Rect(t,p-u,a-u,S,v.h+2*u,"ob_"+l);f.setCSSStyle(_),f.setCornerRadius(3),f.setAlpha(c),i.addChild(f),g&&g.push(f)}return e.TextUtils.fitText(m,n,1/0,i),g&&g.push(m),m};var l=new Object;e.Obj.createSubclass(l,e.Obj),l._DEFAULT_TIMELINE_STYLE="border:1px #d9dfe3;background-color:#f9f9f9;",l._DEFAULT_AXIS_STYLE="background-color:#f9f9f9;border:1px #d9dfe3;",l._DEFAULT_AXIS_SEPARATOR_STYLE="color:#bcc7d2;",l._DEFAULT_SERIES_STYLE="background-color:#f9f9f9;",l._DEFAULT_SERIES_LABEL_BACKGROUND_STYLE="background-color:#f9f9f9",l._DEFAULT_SERIES_LABEL_BACKGROUND_OPACITY=.8,l._DEFAULT_SERIES_LABEL_SPACING=20,l._DEFAULT_SERIES_LABEL_PADDING=2,l._DEFAULT_SERIES_AXIS_SEPARATOR_STYLE="color:#bcc7d2",l._DEFAULT_SERIES_AXIS_LABEL_BACKGROUND_STYLE="background-color:#f9f9f9",l._DEFAULT_SERIES_AXIS_LABEL_BACKGROUND_OPACITY=.8,l._DEFAULT_SERIES_AXIS_LABEL_PADDING=1,l._DEFAULT_OVERVIEW_WIDTH=60,l._DEFAULT_OVERVIEW_HEIGHT=100,l._DEFAULT_ITEM_ENABLED_STROKE_WIDTH=1,l._DEFAULT_ITEM_HOVER_STROKE_WIDTH=2,l._DEFAULT_ITEM_SELECTED_STROKE_WIDTH=2,l._DEFAULT_ITEM_INNER_FILL_COLOR="rgba(249,249,249,0)",l._DEFAULT_ITEM_ACTIVE_INNER_STROKE_COLOR="#e4f0fa",l._DEFAULT_ITEM_ENABLED_INNER_STROKE_COLOR="rgba(249,249,249,0)",l._DEFAULT_ITEM_INNER_STROKE_WIDTH=2,l._DEFAULT_BUBBLE_OFFSET=20,l._DEFAULT_BUBBLE_SPACING=15,l._DEFAULT_ITEM_CONTENT_SPACING=2,l._DEFAULT_DURATION_FEELER_OFFSET=10,l._DEFAULT_THUMBNAIL_WIDTH=32,l._DEFAULT_THUMBNAIL_HEIGHT=32,l._DEFAULT_ZOOM_CONTROL_BACKGROUND_COLOR="#ffffff",l._DEFAULT_ZOOM_CONTROL_BORDER_COLOR="#d6d7d8",l._DEFAULT_ZOOM_CONTROL_DIAMETER=31,l._DEFAULT_ZOOM_CONTROL_PADDING=10.5,l._DEFAULT_ZOOM_CONTROL_SPACING=9,l.getItemDescriptionStyle=function(t){var i=t._series.getOptions().styleDefaults.item.descriptionStyle,r=t.getStyle();if(r){var s=new e.CSSStyle(r);i.parseInlineStyle(s)}return i},l.getItemTitleStyle=function(t){var i=t._series.getOptions().styleDefaults.item.titleStyle,r=t.getStyle();if(r){var s=new e.CSSStyle(r);i.parseInlineStyle(s)}return i},l.getReferenceObjectColor=function(e){return e.styleDefaults.referenceObject.color},l.getSeriesLabelStyle=function(e){return e.styleDefaults.series.labelStyle},l.getSeriesLabelBackgroundStyle=function(){return l._DEFAULT_SERIES_LABEL_BACKGROUND_STYLE},l.getSeriesLabelBackgroundOpacity=function(){return l._DEFAULT_SERIES_LABEL_BACKGROUND_OPACITY},l.getSeriesLabelPadding=function(){return l._DEFAULT_SERIES_LABEL_PADDING},l.getSeriesLabelSpacing=function(){return l._DEFAULT_SERIES_LABEL_SPACING},l.getEmptyTextStyle=function(e){return e.styleDefaults.series.emptyTextStyle},l.getBubbleOffset=function(){return l._DEFAULT_BUBBLE_OFFSET},l.getBubbleSpacing=function(){return l._DEFAULT_BUBBLE_SPACING},l.getItemContentSpacing=function(){return l._DEFAULT_ITEM_CONTENT_SPACING},l.getItemFillColor=function(t){var i=t.getStyle();if(i){var r=new e.CSSStyle(i).getStyle(e.CSSStyle.BACKGROUND_COLOR);if(r)return r}return t._series.getOptions().styleDefaults.item.backgroundColor},l.getItemStrokeColor=function(t){var i=t.getStyle();if(i){var r=new e.CSSStyle(i).getStyle(e.CSSStyle.BORDER_COLOR);if(r)return r}return t._series.getOptions().styleDefaults.item.borderColor},l.getItemStrokeWidth=function(){return l._DEFAULT_ITEM_ENABLED_STROKE_WIDTH},l.getItemHoverFillColor=function(e){return e._series.getOptions().styleDefaults.item.hoverBackgroundColor||l.getItemFillColor(e)},l.getItemHoverStrokeColor=function(e){return e._series.getOptions().styleDefaults.item.hoverBorderColor||l.getItemStrokeColor(e)},l.getItemHoverStrokeWidth=function(){return l._DEFAULT_ITEM_HOVER_STROKE_WIDTH},l.getItemSelectedFillColor=function(e){return e._series.getOptions().styleDefaults.item.selectedBackgroundColor||l.getItemFillColor(e)},l.getItemSelectedStrokeColor=function(e){return e._series.getOptions().styleDefaults.item.selectedBorderColor||l.getItemStrokeColor(e)},l.getItemSelectedStrokeWidth=function(){return l._DEFAULT_ITEM_SELECTED_STROKE_WIDTH},l.getSeriesStyle=function(){return l._DEFAULT_SERIES_STYLE},l.getColorsArray=function(e){return e.styleDefaults.series.colors},l.getDurationFeelerOffset=function(){return l._DEFAULT_DURATION_FEELER_OFFSET},l.getThumbnailWidth=function(){return l._DEFAULT_THUMBNAIL_WIDTH},l.getThumbnailHeight=function(){return l._DEFAULT_THUMBNAIL_HEIGHT},l.getSeriesAxisSeparatorStyle=function(){return l._DEFAULT_SERIES_AXIS_SEPARATOR_STYLE},l.getItemInnerActiveStrokeColor=function(){return l._DEFAULT_ITEM_ACTIVE_INNER_STROKE_COLOR},l.getItemInnerFillColor=function(){return l._DEFAULT_ITEM_INNER_FILL_COLOR},l.getItemInnerStrokeColor=function(){return l._DEFAULT_ITEM_ENABLED_INNER_STROKE_COLOR},l.getItemInnerStrokeWidth=function(){return l._DEFAULT_ITEM_INNER_STROKE_WIDTH},l.getTimelineStyle=function(){return l._DEFAULT_TIMELINE_STYLE},l.getOverviewWidth=function(){return l._DEFAULT_OVERVIEW_WIDTH},l.getOverviewHeight=function(){return l._DEFAULT_OVERVIEW_HEIGHT},l.getOverviewWindowBackgroundColor=function(e){return e.styleDefaults.overview.window.backgroundColor},l.getOverviewWindowBorderColor=function(e){return e.styleDefaults.overview.window.borderColor},l.getOverviewBackgroundColor=function(e){return e.styleDefaults.overview.backgroundColor},l.getOverviewLabelStyle=function(e){return e.styleDefaults.overview.labelStyle},l.getSeriesAxisLabelStyle=function(e){return e.styleDefaults.majorAxis.labelStyle},l.getSeriesAxisLabelBackgroundStyle=function(){return l._DEFAULT_SERIES_AXIS_LABEL_BACKGROUND_STYLE},l.getSeriesAxisLabelBackgroundOpacity=function(){return l._DEFAULT_SERIES_AXIS_LABEL_BACKGROUND_OPACITY},l.getAxisSeparatorStyle=function(){return l._DEFAULT_AXIS_SEPARATOR_STYLE},l.getSeriesAxisLabelPadding=function(){return l._DEFAULT_SERIES_AXIS_LABEL_PADDING},l.getAnimationDuration=function(t){return e.StyleUtils.getTimeMilliseconds(t.styleDefaults.animationDuration)/1e3},l.getZoomInButtonBackgroundColor=function(e){return e.zoomIn_bgc?e.zoomIn_bgc:l._DEFAULT_ZOOM_CONTROL_BACKGROUND_COLOR},l.getZoomInButtonActiveBackgroundColor=function(e){return e.zoomIn_a_bgc?e.zoomIn_a_bgc:l._DEFAULT_ZOOM_CONTROL_BACKGROUND_COLOR},l.getZoomInButtonHoverBackgroundColor=function(e){return e.zoomIn_h_bgc?e.zoomIn_h_bgc:l._DEFAULT_ZOOM_CONTROL_BACKGROUND_COLOR},l.getZoomInButtonDisabledBackgroundColor=function(e){return e.zoomIn_d_bgc?e.zoomIn_d_bgc:l._DEFAULT_ZOOM_CONTROL_BACKGROUND_COLOR},l.getZoomInButtonBorderColor=function(e){return e.zoomIn_bc?e.zoomIn_bc:l._DEFAULT_ZOOM_CONTROL_BORDER_COLOR},l.getZoomInButtonActiveBorderColor=function(e){return e.zoomIn_a_bc?e.zoomIn_a_bc:l._DEFAULT_ZOOM_CONTROL_BORDER_COLOR},l.getZoomInButtonHoverBorderColor=function(e){return e.zoomIn_h_bc?e.zoomIn_h_bc:l._DEFAULT_ZOOM_CONTROL_BORDER_COLOR},l.getZoomInButtonDisabledBorderColor=function(e){return e.zoomIn_d_bc?e.zoomIn_d_bc:l._DEFAULT_ZOOM_CONTROL_BORDER_COLOR},l.getZoomOutButtonBackgroundColor=function(e){return e.zoomOut_bgc?e.zoomOut_bgc:l._DEFAULT_ZOOM_CONTROL_BACKGROUND_COLOR},l.getZoomOutButtonActiveBackgroundColor=function(e){return e.zoomOut_a_bgc?e.zoomOut_a_bgc:l._DEFAULT_ZOOM_CONTROL_BACKGROUND_COLOR},l.getZoomOutButtonHoverBackgroundColor=function(e){return e.zoomOut_h_bgc?e.zoomOut_h_bgc:l._DEFAULT_ZOOM_CONTROL_BACKGROUND_COLOR},l.getZoomOutButtonDisabledBackgroundColor=function(e){return e.zoomOut_d_bgc?e.zoomOut_d_bgc:l._DEFAULT_ZOOM_CONTROL_BACKGROUND_COLOR},l.getZoomOutButtonBorderColor=function(e){return e.zoomOut_bc?e.zoomOut_bc:l._DEFAULT_ZOOM_CONTROL_BORDER_COLOR},l.getZoomOutButtonActiveBorderColor=function(e){return e.zoomOut_a_bc?e.zoomOut_a_bc:l._DEFAULT_ZOOM_CONTROL_BORDER_COLOR},l.getZoomOutButtonHoverBorderColor=function(e){return e.zoomOut_h_bc?e.zoomOut_h_bc:l._DEFAULT_ZOOM_CONTROL_BORDER_COLOR},l.getZoomOutButtonDisabledBorderColor=function(e){return e.zoomOut_d_bc?e.zoomOut_d_bc:l._DEFAULT_ZOOM_CONTROL_BORDER_COLOR};var h=function(e,t,i){this.Init(e,t,i)};e.Obj.createSubclass(h,e.BaseComponent),h.prototype.Init=function(e,t,i){h.superclass.Init.call(this,e),this._callback=t,this._callbackObj=i,this._blocks=[],this._renderedReferenceObjects=[],this._seriesTicksArray=[]},h.prototype.triggerAnimations=function(){var t=this.getCtx();if(this._rmAnimationElems&&0!=this._rmAnimationElems.length){this._callbackObj.EventManager.removeListeners(this._callbackObj);var i=new e.ParallelPlayable(t,new e.AnimFadeOut(t,this._rmAnimationElems,l.getAnimationDuration(this.Options)));e.Playable.appendOnEnd(i,this._onRmAnimationEnd,this),this._callbackObj.Animation=i,i.play()}else if(this._mvAnimator&&this._hasMvAnimations)this._callbackObj.EventManager.removeListeners(this._callbackObj),e.Playable.appendOnEnd(this._mvAnimator,this._onMvAnimationEnd,this),this._callbackObj.Animation=this._mvAnimator,this._mvAnimator.play();else if(this._frAnimationElems&&0!=this._frAnimationElems.length){this._callbackObj.EventManager.removeListeners(this._callbackObj);var r=new e.ParallelPlayable(t,new e.AnimFadeIn(t,this._frAnimationElems,l.getAnimationDuration(this.Options),(this._isInitialRender,0)));e.Playable.appendOnEnd(r,this._onAnimationEnd,this),this._callbackObj.Animation=r,r.play()}},h.prototype._onRmAnimationEnd=function(){for(var t=0;t<this._rmAnimationElems.length;t++){var i=this._rmAnimationElems[t],r=i.getParent();r&&r.removeChild(i)}this._mvAnimator&&this._hasMvAnimations?(this._callbackObj.Animation=this._mvAnimator,e.Playable.appendOnEnd(this._mvAnimator,this._onMvAnimationEnd,this),this._mvAnimator.play()):this._onMvAnimationEnd()},h.prototype._onMvAnimationEnd=function(){if(this._frAnimationElems&&0!=this._frAnimationElems.length){var t=new e.ParallelPlayable(this.getCtx(),new e.AnimFadeIn(this.getCtx(),this._frAnimationElems,l.getAnimationDuration(this.Options),(this._isInitialRender,0)));e.Playable.appendOnEnd(t,this._onAnimationEnd,this),this._callbackObj.Animation=t,t.play()}else this._onAnimationEnd()},h.prototype._onAnimationEnd=function(){this._callbackObj.onAnimationEnd()},h.prototype.render=function(t,i,r){if(t){this.SetOptions(t),this.Width?this._isInitialRender=!1:this._isInitialRender=!0,this.Width=i,this.Height=r;var s=this.Options.orientation;if(s&&s==e.Timeline.ORIENTATION_VERTICAL?(0==this._isVertical?this._allowUpdates=!1:this._allowUpdates=!0,this._isVertical=!0):(this._isVertical?this._allowUpdates=!1:this._allowUpdates=!0,this._isVertical=!1),this.Options){var n=this.Parse(this.Options);this._applyParsedProperties(n)}this._fetchStartPos=0,this._isVertical?(this._fetchEndPos=r,this._maxOverflowValue=i,this._length=r,this._size=i):(this._fetchEndPos=i,this._maxOverflowValue=r,this._length=i,this._size=r),this._isInverted=this.Options.inverted,this._colorCount=0,this._maxDurationSize=0,d.renderSeries(this,i,r),e.TimeAxis.supportsTouch()&&this._items.length>0&&this._setAriaProperty("flowto","_bt_"+this._items[0].getId());var a=this.GetComponentDescription();a&&(e.ToolkitUtils.setAttrNullNS(this.getElem(),"role","group"),e.ToolkitUtils.setAttrNullNS(this.getElem(),"aria-label",e.StringUtils.processAriaLabel(a)))}else this._handleResize(i,r)},h.prototype.GetComponentDescription=function(){var t=[e.Bundle.getTranslatedString(e.Bundle.UTIL_PREFIX,"TIMELINE_SERIES")];return this._label?t.push(this._label):t.push(this.Options.index+1),e.Bundle.getTranslatedString(e.Bundle.UTIL_PREFIX,"COLON_SEP_LIST",t)},h.prototype._handleResize=function(e,t){this._canvas.setTranslateY(0),this._canvas.setTranslateX(0),this.Width=e,this.Height=t,this._fetchStartPos=0,this._isVertical?(this._fetchEndPos=t,this._maxOverflowValue=e,this._length=t,this._size=e):(this._fetchEndPos=e,this._maxOverflowValue=t,this._length=e,this._size=t),this._background.setWidth(e),this._background.setHeight(t),d.updateSeriesForZoom(this)},h.prototype.applyStyleValues=function(){if(this._style=new e.CSSStyle(l.getSeriesStyle()),this._seriesStyleDefaults=this.Options.seriesStyleDefaults,this._axisStyleDefaults=this.Options.axisStyleDefaults,this._colors=l.getColorsArray(this.Options),this._referenceObjects=this.Options.referenceObjects,this._seriesStyleDefaults){var t=this._seriesStyleDefaults.backgroundColor;t&&this._style.parseInlineStyle("background-color:"+t+";")}this._style.parseInlineStyle(this._inlineStyle)},h.prototype.SetOptions=function(e){this.Options=e},h.prototype.Parse=function(e){return this._parser=new g,this._parser.parse(e,this._items)},h.prototype._applyParsedProperties=function(t){this._items&&(this._oldItems=this._items),this._items=t.items,this._items&&this._items.length>0?this._isEmpty=!1:this._isEmpty=!0,this._isIRAnimationEnabled=t.isIRAnimationEnabled,this._isDCAnimationEnabled=t.isDCAnimationEnabled,this._label=t.label,this._timeAxis=t.timeAxis,this._emptyText=t.emptyText,null==this._emptyText&&(this._emptyText=e.Bundle.getTranslatedString(e.Bundle.UTIL_PREFIX,"NO_DATA",null)),this._isTopToBottom=t.isTopToBottom,this._isRandomItemLayout=t.isRandomItemLayout,this._customTimeScales=t.customTimeScales,this._customFormatScales=t.customFormatScales,this._start=t.start,this._end=t.end,this._inlineStyle=t.inlineStyle,this._scale=t.scale,this._converter=t.converter,this.applyStyleValues()},h.prototype.calculateSpacing=function(e,t){if(null!=this._items&&0!=this._items.length){var i=this._maxOverflowValue,r=e.getSpacing();if(this._isRandomItemLayout){if(null==r){var s=e.getHeight(),n=this._initialSpacing,a=this._maxOverflowValue-s-n;a<0&&(a=0),r=Math.round(Math.random()*a)+n,this._maxOverflowValue<r+s&&(this._maxOverflowValue=r+s+l.getBubbleSpacing())}return r}if(null==r&&(r=this._initialSpacing),this._isVertical)for(u=0;u<t;u++)i<r+(g=(S=this._items[u]).getWidth()+10)&&(i=r+g);else{for(var o=e.getLoc(),h=e.getWidth()+10,_=l.getBubbleSpacing(),c=[],u=0;u<t;u++){var g=(S=this._items[u]).getWidth()+10,d=S.getLoc();(o>=d&&o<=d+g||d>=o&&d<=o+h)&&c.push(S)}for(u=0;u<c.length;u++){for(var m=!1,v=0;v<c.length;v++){var S,p=(S=c[v]).getHeight(),f=S.getSpacing();if(r>=f&&r<=f+p){r=f+p+_,e.setSpacing(r),m=!0;break}}if(!m)break}i<r+p&&(i=r+p)}return i>this._maxOverflowValue&&(this._maxOverflowValue=i+l.getBubbleSpacing()),r}},h.prototype.calculateDurationSize=function(e,t){if(null!=this._items&&0!=this._items.length){var i=e.getStartTime(),r=e.getEndTime();if(r&&r!=i){var s=e.getDurationLevel();null==s&&(s=1);for(var n=[],a=0;a<t;a++){var o=(c=this._items[a]).getStartTime(),l=c.getEndTime();l&&l!=o&&i>=o&&i<=l&&n.push(c)}for(a=0;a<n.length;a++){for(var h=!1,_=0;_<n.length;_++){var c,u=(c=n[_]).getDurationLevel();if(s==u){s=u+1,e.setDurationLevel(s),h=!0;break}}if(!h)break}return s>this._maxDurationSize&&(this._maxDurationSize=s),s}}},h.prototype.prepareDurations=function(e){for(var t=0;t<this._items.length;t++){var i=this._items[t],r=i.getStartTime(),s=i.getEndTime();s&&s!=r&&(i.setDurationLevel(this.calculateDurationSize(i,t)),i.setDurationSize(22+10*i.getDurationLevel()-5),null==i.getDurationFillColor()&&(i.setDurationFillColor(this._colors[this._colorCount]),this._colorCount++,this._colorCount==this._colors.length&&(this._colorCount=0)))}},h.prototype.prepareItems=function(t){this.isVertical()?this._initialSpacing=20*(this._maxDurationSize>0?1:0)+l.getBubbleSpacing()+10*this._maxDurationSize:this._initialSpacing=20+l.getBubbleSpacing()+10*this._maxDurationSize;for(var i=0;i<t.length;i++){var r=t[i],s=e.TimeAxis.getDatePosition(this._start,this._end,r.getStartTime(),this._length),n=r.getEndTime();if(n&&n!=r.getStartTime()){var a=e.TimeAxis.getDatePosition(this._start,this._end,n,this._length)-s;s+=Math.min(l.getDurationFeelerOffset(),a/2)}r.setLoc(s)}for(i=0;i<this._items.length;i++)r=this._items[i],(s=e.TimeAxis.getDatePosition(this._start,this._end,r.getStartTime(),this._length))<this._fetchStartPos||s>this._fetchEndPos||c.initializeItem(r,this,i)},h.prototype.getLabel=function(){return this._label},h.prototype.getEmptyText=function(){return this._emptyText},h.prototype.findItem=function(e){if(null!=this._items)for(var t=0;t<this._items.length;t++){var i=this._items[t];if(i.getId()==e)return i}return null},h.prototype.HandleItemAction=function(t){var i=t.getAction();if(i){var r=e.EventFactory.newActionEvent("action",i,t.getId());e.EventDispatcher.dispatchEvent(this._callback,this._callbackObj,this,r)}},h.prototype.isInverted=function(){return this._isInverted},h.prototype.isTopToBottom=function(){return this._isTopToBottom},h.prototype.isVertical=function(){return this._isVertical},h.prototype.addTick=function(t,i,r,s,n,a,o){var l=new e.Line(this.getCtx(),i,s,r,n,o);return l.setStroke(a),l.setPixelHinting(!0),t.addChild(l),l},h.prototype.setVScrollPos=function(e){null!=this._canvas&&this._canvas.setTranslateY(0-e)},h.prototype.setHScrollPos=function(e){null!=this._canvas&&this._canvas.setTranslateX(0-e)};var _=function(e,t){this.Init(e,t)};e.Obj.createSubclass(_,e.Container),_.ENABLED_STATE_KEY="en",_.SELECTED_STATE_KEY="sel",_.ACTIVE_SELECTED_STATE_KEY="asel",_.HOVER_STATE_KEY="hl",_.prototype.Init=function(e,t){_.superclass.Init.call(this,e,"g",t)},_.prototype.setSelected=function(e){this._isSelected!=e&&(this._isSelected=e,e?this._isShowingHoverEffect?this.applyState(_.ACTIVE_SELECTED_STATE_KEY):this.applyState(_.SELECTED_STATE_KEY):this.applyState(_.ENABLED_STATE_KEY))},_.prototype.showHoverEffect=function(e){this._isShowingHoverEffect||(this._isShowingHoverEffect=!0,this._isSelected&&e?this.applyState(_.ACTIVE_SELECTED_STATE_KEY):this._isSelected?this.applyState(_.SELECTED_STATE_KEY):this.applyState(_.HOVER_STATE_KEY))},_.prototype.hideHoverEffect=function(e){this._isSelected&&e?this.applyState(_.ACTIVE_SELECTED_STATE_KEY):this._isSelected?this.applyState(_.SELECTED_STATE_KEY):this.applyState(_.ENABLED_STATE_KEY),this._isShowingHoverEffect=!1},_.prototype.applyState=function(t){var i=this._node,r=i.getBubble();if(null!=r){var s=r.getChildAt(0),n=s.getChildAt(0),a=i.getDurationBar();if(t==_.ACTIVE_SELECTED_STATE_KEY)var o=l.getItemSelectedFillColor(i),h=l.getItemSelectedStrokeColor(i),c=l.getItemSelectedStrokeWidth(),u=l.getItemInnerActiveStrokeColor();else t==_.SELECTED_STATE_KEY?(o=l.getItemSelectedFillColor(i),h=l.getItemSelectedStrokeColor(i),c=l.getItemSelectedStrokeWidth(),u=l.getItemInnerStrokeColor()):t==_.HOVER_STATE_KEY?(o=l.getItemHoverFillColor(i),h=l.getItemHoverStrokeColor(i),c=l.getItemHoverStrokeWidth(),u=l.getItemInnerActiveStrokeColor()):(o=l.getItemFillColor(i),h=l.getItemStrokeColor(i),c=l.getItemStrokeWidth(),u=l.getItemInnerStrokeColor());var g=l.getItemInnerStrokeWidth(),d=new e.SolidStroke(h,1,c),m=new e.SolidStroke(u,1,g);s.setSolidFill(o),s.setStroke(d),n.setStroke(m);var v=i.getFeeler();v&&v.setStroke(d),a&&a.setStroke(d)}};var c=new Object;e.Obj.createSubclass(c,e.Obj),c.renderItem=function(e,t,i,r,s,n){e._content?(c._renderBubble(e,t,i,s),c._displayBubble(e,t,r,null,!1)):(t._hasMvAnimations=!0,c._displayBubble(e,t,r,n,!0)),t.isVertical()||(e.getFeeler()&&t._allowUpdates?c._updateFeeler(e,t,r,n):c._renderFeeler(e,t,i.feelers,r,s))},c.initializeItem=function(e,t,i){e.getBubble()&&t._allowUpdates?c._updateBubble(e,t,i):c._createBubble(e,t,i)},c._createBubble=function(e,t,i){var r=c._getBubbleContent(e,t);e.setWidth(r._w+10),e.setHeight(r._h+10),e._content=r;var s=t.calculateSpacing(e,i);e.setSpacing(s)},c._renderBubble=function(t,i,r,s){var n=i.getCtx(),a=e.Agent.isRightToLeft(n),o=t.getId(),h=t._content;t._content=null;var c=t.getWidth(),u=t.getHeight(),g="_bubble_"+o;if(i.isVertical()){var d=u/2,m=d-6,v=d+6
;if(!a&&i.isInverted()||a&&!i.isInverted())var S=[0,0,0,m,-6,d,0,v,0,u,c,u,c,0,0,0],p=[2,2,2,m,-4,d,2,v,2,u-2,c-2,u-2,c-2,2,2,2];else S=[0,0,0,u,c,u,c,v,c+6,d,c,m,c,0,0,0],p=[2,2,2,u-2,c-2,u-2,c-2,v,c+4,d,c-2,m,c-2,2,2,2]}else m=(d=a?c-l.getBubbleOffset():l.getBubbleOffset())-6,v=d+6,i.isInverted()?(S=[0,0,m,0,d,-6,v,0,c,0,c,u,0,u,0,0],p=[2,2,m,2,d,-4,v,2,c-2,2,c-2,u-2,2,u-2,2,2]):(S=[0,0,0,u,m,u,d,u+6,v,u,c,u,c,0,0,0],p=[2,2,2,u-2,m,u-2,d,u+4,v,u-2,c-2,u-2,c-2,2,2,2]);var f=new e.Polygon(n,S,g),T=new e.Polygon(n,p,g+"_i");T.setSolidFill(l.getItemInnerFillColor()),h.setTranslate(5,5),f.addChild(T),f.addChild(h);var O=new _(n,"_bt_"+o);s&&(O.setAlpha(0),s.push(O)),O.addChild(f),e.TimeAxis.supportsTouch()&&e.ToolkitUtils.setAttrNullNS(O._elem,"id",O._id),O._node=t,t.setBubble(O),O.applyState(_.ENABLED_STATE_KEY),t.getLoc()>=0&&r.addChild(O),O.setAriaRole("group"),i._callbackObj.EventManager.associate(O,t)},c._displayBubble=function(t,i,r,s,n){var a,o,h=i.getCtx(),c=e.Agent.isRightToLeft(h),u=t.getLoc(),g=t.getWidth(),d=t.getHeight(),m=t.getSpacing(),v=t.getBubble();n&&v.applyState(_.ENABLED_STATE_KEY),i.isVertical()?(o=u-d/2,c&&i.isInverted()||!c&&!i.isInverted()?a=i._size-(g+i._initialSpacing)+r:(a=i._initialSpacing,r=0)):(a=c?i._length-u-g+l.getBubbleOffset():u-l.getBubbleOffset(),i.isInverted()?(o=i.isTopToBottom()?m:i.Height-m-d+r+i._initialSpacing-l.getBubbleSpacing(),r=0):o=i.isTopToBottom()?m-i._initialSpacing+l.getBubbleSpacing():i.Height-m-d+r),s?(i.isVertical()?v.setTranslateX(v.getTranslateX()+i._canvasOffsetX+r):v.setTranslateY(v.getTranslateY()+i._canvasOffsetY+r),s.addProp(e.Animator.TYPE_NUMBER,v,v.getTranslateX,v.setTranslateX,a),s.addProp(e.Animator.TYPE_NUMBER,v,v.getTranslateY,v.setTranslateY,o)):v.setTranslate(a,o),t._updateAriaLabel()},c._getBubbleContent=function(t,i){var r=i.getCtx(),s=e.Agent.isRightToLeft(r),n=t.getTitle(),a=t.getDescription(),o=t.getThumbnail(),h=new e.Container(r),_=0,c=0,u=0,g=0,d=0;if(s){if(n&&((f=new e.OutputText(r,n,0,0)).setCSSStyle(l.getItemTitleStyle(t)),_=(T=f.getDimensions()).w,c=d=T.h,h.addChild(f)),a){(O=new e.OutputText(r,a,0,c)).setCSSStyle(l.getItemDescriptionStyle(t));var m=(T=O.getDimensions()).w;0!=_&&m!=_?m>_?(f.setX(m-_),_=m):O.setX(_-m):_=m,d=c+T.h,h.addChild(O)}o&&(v=l.getThumbnailWidth(),S=l.getThumbnailHeight(),_=0==_?0:_+l.getItemContentSpacing(),(p=new e.Image(r,o,_,0,v,S,"_tn")).setMouseEnabled(!1),h.addChild(p),u=v,g=S),h._w=_+u}else{if(o){var v=l.getThumbnailWidth(),S=l.getThumbnailHeight(),p=new e.Image(r,o,0,0,v,S,"_tn");p.setMouseEnabled(!1),h.addChild(p),_=v+l.getItemContentSpacing(),g=S}if(n){var f=new e.OutputText(r,n,_,0);f.setCSSStyle(l.getItemTitleStyle(t));var T=f.getDimensions();u=T.w,c=d=T.h,h.addChild(f)}if(a){var O=new e.OutputText(r,a,_,c);O.setCSSStyle(l.getItemDescriptionStyle(t)),T=O.getDimensions(),u=Math.max(u,T.w),d=c+T.h,h.addChild(O)}h._w=0==u?Math.max(_-l.getItemContentSpacing(),0):_+u}return h._h=Math.max(g,d),h},c._updateBubble=function(e,t,i){var r=t.calculateSpacing(e,i);e.setSpacing(r)},c._renderFeeler=function(t,i,r,s,n){var a,o=i.getCtx(),h=e.Agent.isRightToLeft(o),_=t.getId(),c=t.getLoc(),u=t.getSpacing(),g="_feeler_"+_;if(i.isInverted())d=t.getDurationSize(),m=i.isTopToBottom()?u:i.Height-u-t.getHeight()+s+i._initialSpacing-l.getBubbleSpacing();else{var d=i.Height+s-t.getDurationSize();if(i.isTopToBottom())m=u-i._initialSpacing+l.getBubbleSpacing()+t.getHeight();else var m=i.Height-u+s}a=h?i._length-c:c;var v=new e.Line(o,a,d,a,m,g);n&&(v.setAlpha(0),n.push(v)),r.addChild(v);var S=l.getItemStrokeWidth(),p=l.getItemStrokeColor(t),f=new e.SolidStroke(p,1,S);v.setStroke(f),v._node=t,t.setFeeler(v)},c._updateFeeler=function(t,i,r,s){if(i.isVertical())t.setFeeler(null);else{var n,a=i.getCtx(),o=e.Agent.isRightToLeft(a),h=t.getFeeler();if(i.isInverted())_=t.getDurationSize(),c=i.isTopToBottom()?t.getSpacing():i.Height-t.getSpacing()-t.getHeight()+r+i._initialSpacing-l.getBubbleSpacing(),r=0;else{var _=i.Height+r-t.getDurationSize();if(i.isTopToBottom())c=t.getSpacing()-i._initialSpacing+l.getBubbleSpacing()+t.getHeight();else var c=i.Height-t.getSpacing()+r}n=o?i._length-t.getLoc():t.getLoc(),s?(h.setY1(h.getY1()+i._canvasOffsetY+r),h.setY2(h.getY2()+i._canvasOffsetY+r),s.addProp(e.Animator.TYPE_NUMBER,h,h.getX1,h.setX1,n),s.addProp(e.Animator.TYPE_NUMBER,h,h.getY1,h.setY1,_),s.addProp(e.Animator.TYPE_NUMBER,h,h.getX2,h.setX2,n),s.addProp(e.Animator.TYPE_NUMBER,h,h.getY2,h.setY2,c)):(h.setX1(n),h.setY1(_),h.setX2(n),h.setY2(c))}},c.renderDuration=function(e,t,i,r,s,n){e.getDurationBar()?c._updateDuration(e,t,r,n):c._renderDuration(e,t,i,r,s)},c._renderDuration=function(t,i,r,s,n){var a=i.getCtx(),o=e.Agent.isRightToLeft(a),h=t.getStartTime(),_=t.getEndTime(),c=e.TimeAxis.getDatePosition(i._start,i._end,h,i._length),u="_duration_"+t.getId(),g=22+10*t.getDurationLevel(),d=e.TimeAxis.getDatePosition(i._start,i._end,_,i._length);if(i.isVertical()){if(!o&&!i.isInverted()||o&&i.isInverted())var m=new e.Rect(a,i._size-g+5,c,g,d-c,u);else m=new e.Rect(a,-5,c,g,d-c,u),s=0;m.setTranslateX(s),m.setY(c),m.setWidth(g),m.setHeight(d-c)}else{var v=d-c;if(o)S=i._length-c-v;else var S=c;i.isInverted()?(m=new e.Rect(a,S,-5,v,g,u)).setTranslateY(0):(m=new e.Rect(a,S,i._size-g+5,v,g,u)).setTranslateY(s)}n&&(m.setAlpha(0),n.push(m)),m.setCornerRadius(5),m.setSolidFill(t.getDurationFillColor());var p=l.getItemStrokeWidth(),f=l.getItemStrokeColor(t),T=new e.SolidStroke(f,1,p);m.setStroke(T),m._node=t,i._callbackObj.EventManager.associate(m,t),r.addChild(m),t.setDurationBar(m)},c._updateDuration=function(t,i,r,s){var n=i.getCtx(),a=e.Agent.isRightToLeft(n),o=t.getDurationBar();if(null!=o){var l=e.TimeAxis.getDatePosition(i._start,i._end,t.getStartTime(),i._length),h=22+10*t.getDurationLevel(),_=e.TimeAxis.getDatePosition(i._start,i._end,t.getEndTime(),i._length);if(i.isVertical()){var c=0;if(!a&&!i.isInverted()||a&&i.isInverted())var u=i._size-h+5;else u=-5,r=0;var g=r,d=l,m=h,v=_-l}else{g=0;var S=_-l;u=a?i._length-l-S:l,i.isInverted()?(r=0,c=0,d=-5,m=S,v=h):(c=r,d=i._size-h+5,m=S,v=h)}s?(i.isVertical()?o.setTranslateX(o.getTranslateX()+i._canvasOffsetX+r):o.setTranslateY(o.getTranslateY()+i._canvasOffsetY+r),s.addProp(e.Animator.TYPE_NUMBER,o,o.getTranslateX,o.setTranslateX,g),s.addProp(e.Animator.TYPE_NUMBER,o,o.getTranslateY,o.setTranslateY,c),s.addProp(e.Animator.TYPE_NUMBER,o,o.getX,o.setX,u),s.addProp(e.Animator.TYPE_NUMBER,o,o.getY,o.setY,d),s.addProp(e.Animator.TYPE_NUMBER,o,o.getWidth,o.setWidth,m),s.addProp(e.Animator.TYPE_NUMBER,o,o.getHeight,o.setHeight,v)):(o.setTranslateX(g),o.setTranslateY(c),o.setX(u),o.setY(d),o.setWidth(m),o.setHeight(v))}};var u=function(e,t,i){this.Init(e,t,i)};e.Obj.createSubclass(u,e.Obj),u.prototype.Init=function(e,t,i){this._timeline=e,this._seriesIndex=t,this._series=e._series[t],this._id=i.id,this._rowKey=i.rowKey,this._startTime=parseInt(i.startTime),i.endTime&&(this._endTime=parseInt(i.endTime)),this._title=i.title,this._desc=i.desc,this._thumbnail=i.thumbnail,this._style=i.style,this._data=i.data,this._action=i.action,this._durationFillColor=i.durationFillColor,this._durationSize=0,this._spbs=i.spbs,this._markerShape=i.markerShape,this._markerScaleX=i.markerScaleX,this._markerScaleY=i.markerScaleY,this._markerShortDesc=i.markerShortDesc,this._markerFillColor=i.markerFillColor,this._markerGradientFill=i.markerGradientFill,this._markerOpacity=i.markerOpacity,this._markerSD=i.markerSD},u.prototype.getId=function(){return this._id},u.prototype.getSeries=function(){return this._series},u.prototype.getSeriesIndex=function(){return this._seriesIndex},u.prototype.getRowKey=function(){return this._rowKey},u.prototype.getStartTime=function(){return this._startTime},u.prototype.setStartTime=function(e){this._startTime=e},u.prototype.getEndTime=function(){return this._endTime},u.prototype.setEndTime=function(e){this._endTime=e},u.prototype.getTitle=function(){return this._title},u.prototype.getDescription=function(){return this._desc},u.prototype.getThumbnail=function(){return this._thumbnail},u.prototype.getStyle=function(){return this._style},u.prototype.setStyle=function(e){this._style=e},u.prototype.getData=function(){return this._data},u.prototype.getBubble=function(){return this._displayable},u.prototype.setBubble=function(e){this._displayable=e},u.prototype.getFeeler=function(){return this._feeler},u.prototype.setFeeler=function(e){this._feeler=e},u.prototype.getDurationBar=function(){return this._durationBar},u.prototype.setDurationBar=function(e){this._durationBar=e},u.prototype.getLoc=function(){return this._loc},u.prototype.setLoc=function(e){this._loc=e},u.prototype.getSpacing=function(){return this._spacing},u.prototype.setSpacing=function(e){this._spacing=e},u.prototype.getDurationLevel=function(){return this._durationLevel},u.prototype.setDurationLevel=function(e){this._durationLevel=e},u.prototype.getDurationSize=function(){return this._durationSize},u.prototype.setDurationSize=function(e){this._durationSize=e},u.prototype.getDurationFillColor=function(){return this._durationFillColor},u.prototype.setDurationFillColor=function(e){this._durationFillColor=e},u.prototype.getLabel=function(){var t=this._timeline.getOptions(),i=this.getStartTime(),r=this._timeline.getTimeAxis().formatDate(new Date(i),null,"general"),s=e.Bundle.getTranslation(t,"accessibleItemStart",e.Bundle.UTIL_PREFIX,"ITEM_START",[r]),n=this.getEndTime();if(n&&n!=i){var a=this._timeline.getTimeAxis().formatDate(new Date(n),null,"general");s=s+" "+e.Bundle.getTranslation(t,"accessibleItemEnd",e.Bundle.UTIL_PREFIX,"ITEM_END",[a])}var o=this.getTitle();o&&""!=o&&(s=s+" "+e.Bundle.getTranslation(t,"accessibleItemTitle",e.Bundle.UTIL_PREFIX,"ITEM_TITLE",[o]));var l=this.getDescription();return l&&""!=l&&(s=s+" "+e.Bundle.getTranslation(t,"accessibleItemDesc",e.Bundle.UTIL_PREFIX,"ITEM_DESC",[l])),s},u.prototype.getWidth=function(){return this._w},u.prototype.setWidth=function(e){this._w=e},u.prototype.getHeight=function(){return this._h},u.prototype.setHeight=function(e){this._h=e},u.prototype.getAction=function(){return this._action},u.prototype.getMarkerShape=function(){return this._markerShape},u.prototype.getMarkerScaleX=function(){return this._markerScaleX},u.prototype.getMarkerScaleY=function(){return this._markerScaleY},u.prototype.getMarkerShortDesc=function(){return this._markerShortDesc},u.prototype.getMarkerFillColor=function(){return this._markerFillColor},u.prototype.getMarkerGradientFill=function(){return this._markerGradientFill},u.prototype.getMarkerOpacity=function(){return this._markerOpacity},u.prototype.getMarkerSD=function(){return this._markerSD},u.prototype.getNextNavigable=function(t){var r=this._timeline.EventManager.getKeyboardHandler();if(t.type==e.MouseEvent.CLICK||r.isMultiSelectEvent(t))return this;if(r.isNavigationEvent(t)){for(var s=[],n=0;n<this._timeline._series.length;n++)s.push(this._timeline._series[n]._items);return i.getNextNavigable(this,t,s)}return null},u.prototype.getTargetElem=function(){return this._displayable.getElem()},u.prototype.getKeyboardBoundingBox=function(e){return this._displayable.getDimensions(e)},u.prototype.showKeyboardFocusEffect=function(){this._isShowingKeyboardFocusEffect=!0,this.showHoverEffect(),this._timeline.updateScrollForItemNavigation(this)},u.prototype.hideKeyboardFocusEffect=function(){this._isShowingKeyboardFocusEffect=!1,this.hideHoverEffect()},u.prototype.isShowingKeyboardFocusEffect=function(){return this._isShowingKeyboardFocusEffect},u.prototype.getDisplayables=function(){return[this._displayable]},u.prototype.getAriaLabel=function(){var t=[];return this.isSelectable()&&t.push(e.Bundle.getTranslatedString(e.Bundle.UTIL_PREFIX,this.isSelected()?"STATE_SELECTED":"STATE_UNSELECTED")),e.Displayable.generateAriaLabel(this.getLabel(),t)},u.prototype.setSelectable=function(e){this._isSelectable=e},u.prototype.isSelectable=function(){return this._isSelectable},u.prototype.isSelected=function(){return this._isSelected},u.prototype.setSelected=function(e){this._isSelected=e,this._displayable.setSelected(e),this._updateAriaLabel(),this._timeline._hasOverview&&this._timeline._overview&&(e?this._timeline._overview.selSelectItem(this.getId()):this._timeline._overview.selUnselectItem(this.getId()))},u.prototype.showHoverEffect=function(e){var t=this._timeline.EventManager.getFocus()==this;this._displayable.showHoverEffect(t),!e&&this._timeline._hasOverview&&this._timeline._overview.highlightItem(this.getId()),(this._timeline._isVertical||this._series._isRandomItemLayout)&&(this._index||(this._index=this._series._blocks[0].getChildIndex(this.getBubble())),this._series._blocks[0].addChild(this.getBubble()))},u.prototype.hideHoverEffect=function(e){var t=this._timeline.EventManager.getFocus()==this;this._displayable.hideHoverEffect(t),!e&&this._timeline._hasOverview&&this._timeline._overview.unhighlightItem(this.getId()),(this._timeline._isVertical||this._series._isRandomItemLayout)&&this._index&&!this._isSelected&&this._series._blocks[0].addChildAt(this.getBubble(),this._index)},u.prototype.getShowPopupBehaviors=function(){if(!this._showPopupBehaviors&&(this._showPopupBehaviors=[],this._spbs))for(var t=this._spbs,i=0;i<t.length;i++)this._showPopupBehaviors.push(new e.ShowPopupBehavior(t[i].popupId,t[i].triggerType,t[i].alignId,t[i].align));return this._showPopupBehaviors},u.prototype._updateAriaLabel=function(){e.Agent.deferAriaCreation()||this._displayable.setAriaProperty("label",this.getAriaLabel())};var g=function(){};e.Obj.createSubclass(g,e.Obj),g.prototype.parse=function(e,t){var i=this.buildData(e),r=new Object;return r.start=new Date(e.start).getTime(),r.end=new Date(e.end).getTime(),r.inlineStyle=e.style,e.svgStyle&&(r.inlineStyle=e.svgStyle),r.scale=e.scale,r.timeAxis=e.timeAxis,r.label=e.label,r.emptyText=e.emptyText,r.isIRAnimationEnabled="auto"==e.animationOnDisplay,r.isDCAnimationEnabled="auto"==e.animationOnDataChange,r.items=this._parseDataNode(e.timeline,e.index,i.data,t,r.start,r.end),r.rtl="false",r.isRandomItemLayout=e._isRandomItemLayout,r.customTimeScales=e._cts,r.customFormatScales=e._cfs,null==e.itemLayout||"auto"==e.itemLayout?r.isTopToBottom=e.inverted:r.isTopToBottom="topToBottom"==e.itemLayout,r},g.prototype.buildData=function(e){var t={},i=[],r=e.items;if(r)for(var s=0;s<r.length;s++){var n=r[s];i.push(n)}return t.data=i,t},g.prototype._parseDataNode=function(t,i,r,s,n,a){var o=new Array,l=t._series[i];if(r)for(var h=0;h<r.length;h++){var _=this.ParseNodeAttributes(r[h],n,a);if(_){if(l._allowUpdates){var c=this._findExistingItem(_,s);if(c){var g=e.ArrayUtils.getIndex(s,c);s.splice(g,1),c.setSpacing(null),c.setDurationLevel(null),c.setLoc(null),c.setSelected(!1),c.setStartTime(_.startTime),c.setEndTime(_.endTime),c.setStyle(_.style)}else(c=new u(t,i,_)).setSelectable(!0)}else(c=new u(t,i,_)).setSelectable(!0);for(var d=c.getStartTime(),m=!0,v=0;v<o.length;v++)if(d<o[v].getStartTime()){o.splice(v,0,c),m=!1;break}m&&o.push(c)}}return o},g.prototype._findExistingItem=function(e,t){if(t)for(var i=0;i<t.length;i++){var r=t[i];if(e.id==r.getId()&&e.title==r.getTitle()&&e.desc==r.getDescription()&&e.thumbnail==r.getThumbnail())return r}},g.prototype.getDate=function(e){return null==e?null:e.getTime?e.getTime():isNaN(e)?new Date(e).getTime()+0:e},g.prototype.ParseNodeAttributes=function(e,t,i){var r=new Object;return r.id=e.id,r.rowKey=r.id,r.startTime=this.getDate(e.start),r.endTime=this.getDate(e.end),(r.endTime?r.endTime:r.startTime)<t||r.startTime>i?null:(r.title=e.title,r.desc=e.description,r.thumbnail=e.thumbnail,r.data=e,r.style=e.style,e.svgStyle&&(r.style=e.svgStyle),r.action=e.action,r.durationFillColor=e.durationFillColor,r.spbs=e.showPopupBehaviors,r.markerShape=e._markerShape,r.markerScaleX=e._markerScaleX,r.markerScaleY=e._markerScaleY,r.markerShortDesc=e._markerShortDesc,r.markerFillColor=e._markerFillColor,r.markerGradientFill=e._markerGradientFill,r.markerOpacity=e._markerOpacity,0==e._markerSD?r.markerSD="false":r.markerSD="true",r)};var d=new Object;e.Obj.createSubclass(d,e.Obj),d.renderSeries=function(t,i,r){if(d._renderBackground(t,i,r),d._renderScrollableCanvas(t),d._renderReferenceObjects(t,t._canvas),d._renderSeriesTicks(t),null!=t._items){if(0==t._blocks.length){var s=t.getCtx(),n=new e.Container(s,"itemBlock_"+t._fetchStartPos+"_"+t._fetchEndPos);n.startPos=t._fetchStartPos,n.endPos=t._fetchEndPos;var a=new e.Container(s,"feelers");n.addChild(a),n.feelers=a;var o=new e.Container(s,"durations");n.addChild(o),n.durations=o,t._canvas.addChild(n),t._blocks.push(n)}else n=t._blocks[0];t.prepareDurations(t._items),t.prepareItems(t._items),t._isInitialRender?(t._isIRAnimationEnabled?t._frAnimationElems=[]:t._frAnimationElems=null,t._mvAnimator=null,t._rmAnimationElems=null):t._allowUpdates&&t._isDCAnimationEnabled?(t._frAnimationElems=[],t._mvAnimator=new e.Animator(t.getCtx(),l.getAnimationDuration(t.Options),0,e.Easing.cubicInOut),t._rmAnimationElems=[]):(t._frAnimationElems=null,t._mvAnimator=null,t._rmAnimationElems=null),t._hasMvAnimations=!1;var h=Math.max(0,t._maxOverflowValue-t._size);t._overflowOffset=h,d._adjustBackground(t,h),t._oldItems&&d._removeItems(t._oldItems,t,n,t._rmAnimationElems),t._oldItems=null,t.isVertical()&&n.feelers.removeChildren(),d._renderItems(t._items,t,n,t._fetchStartPos,t._fetchEndPos,h,t._frAnimationElems,t._mvAnimator),t._callbackObj.SelectionHandler&&n.setCursor(e.SelectionEffectUtils.getSelectingCursor()),d._updateReferenceObjects(t),d._updateSeriesTicks(t)}},d.updateSeriesForZoom=function(e){d._updateItemsForZoom(e._items,e),d._updateReferenceObjects(e),d._updateSeriesTicks(e)},d._renderBackground=function(t,i,r){if(t._background){var s=!1;t._background.setWidth(i),t._background.setHeight(r)}else s=!0,t._background=new e.Rect(t.getCtx(),0,0,i,r,"bg");t._background.setCSSStyle(t._style),t._background.setPixelHinting(!0),s&&t.addChild(t._background)},d._adjustBackground=function(t,i){var r=t.getCtx(),s=e.Agent.isRightToLeft(r);i>0&&(t.isVertical()?t._background.setWidth(t._maxOverflowValue):t._background.setHeight(t._maxOverflowValue)),t.isVertical()?(!t.isInverted()&&!s||t.isInverted()&&s)&&(t._background.setTranslateX(-i),t.setHScrollPos(i)):t.isInverted()||(t._background.setTranslateY(-i),t.setVScrollPos(i))},d._renderScrollableCanvas=function(t){if(t._canvas)return t._canvasOffsetX=t._canvas.getTranslateX(),t._canvasOffsetY=t._canvas.getTranslateY(),t._canvas.setTranslateX(0),void t._canvas.setTranslateY(0);t._canvas=new e.Container(t.getCtx(),"canvas"),t.addChild(t._canvas)},d._renderItems=function(t,i,r,s,n,a,o,l){for(var h=0;h<t.length;h++){var _=t[h],u=e.TimeAxis.getDatePosition(i._start,i._end,_.getStartTime(),i._length);u<s||u>n||c.renderItem(_,i,r,a,o,l)}if(e.TimeAxis.supportsTouch())for(h=0;h<t.length-1;h++){var g=(_=t[h]).getBubble();if(g){var m=t[h+1];if(!m.getBubble())break;g._setAriaProperty("flowto","_bt_"+m.getId())}}d._renderDurations(t,i,r,a,o,l)},d._updateItemsForZoom=function(t,i){if(null!=t&&0!=t.length){var r=i._fetchStartPos,s=i._fetchEndPos,n=i._blocks[0];n.startPos=r,n.endPos=s,i.isVertical()?i._initialSpacing=20*(i._maxDurationSize>0?1:0)+l.getBubbleSpacing()+10*i._maxDurationSize:i._initialSpacing=20+l.getBubbleSpacing()+10*i._maxDurationSize;for(var a=0;a<t.length;a++){var o=(v=t[a]).getStartTime(),h=e.TimeAxis.getDatePosition(i._start,i._end,o,i._length),_=v.getEndTime();if(_&&_!=o){var u=e.TimeAxis.getDatePosition(i._start,i._end,_,i._length)-h;h+=Math.min(l.getDurationFeelerOffset(),u/2)}v.setLoc(h),i._isRandomItemLayout||v.setSpacing(null)}for(a=0;a<t.length;a++){var g=(v=t[a]).getStartTime();g<i._start||g>i._end||c._updateBubble(v,i,a)}var m=Math.max(0,i._maxOverflowValue-i._size);for(d._adjustBackground(i,m),a=0;a<t.length;a++){var v=t[a];c._displayBubble(v,i,m,null,!1),c._updateFeeler(v,i,m,null),c._updateDuration(v,i,m,null)}}},d._renderDurations=function(e,t,i,r,s,n){for(var a=i.durations,o=t._maxDurationSize;o>0;o--)for(var l=0;l<e.length;l++){var h=e[l],_=h.getStartTime(),u=h.getEndTime();u&&u!=_&&o==h.getDurationLevel()&&c.renderDuration(h,t,a,r,s,n)}},d._renderSeriesTicks=function(t){if(null==t._seriesTicks?(t._seriesTicks=new e.Container(t.getCtx()),t._canvas.addChild(t._seriesTicks)):(t._seriesTicks.removeChildren(),t._seriesTicksArray=[]),t._scale&&t._timeAxis){var i=new e.CSSStyle(l.getSeriesAxisSeparatorStyle());if(t._axisStyleDefaults){var r=t._axisStyleDefaults.separatorColor;r&&i.parseInlineStyle("color:"+r+";")}t._separatorStroke=new e.SolidStroke(i.getStyle(e.CSSStyle.COLOR)),t._separatorStroke.setStyle(e.Stroke.DASHED,3),d._renderSeriesTimeAxis(t,t._fetchStartPos,t._fetchEndPos,t._seriesTicks)}},d._updateSeriesTicks=function(t){for(var i=t.getCtx(),r=e.Agent.isRightToLeft(i),s=0;s<t._seriesTicksArray.length;s++){var n=t._seriesTicksArray[s];if(!t.isVertical()&&r)var a=t._length-e.TimeAxis.getDatePosition(t._start,t._end,n.time,t._length);else a=e.TimeAxis.getDatePosition(t._start,t._end,n.time,t._length);t.isVertical()?(n.setX1(0),n.setY1(a),n.setX2(t._maxOverflowValue),n.setY2(a)):(n.setX1(a),n.setY1(0),n.setX2(a),n.setY2(t._maxOverflowValue))}},d._renderSeriesTimeAxis=function(t,i,r,s){var n,a=t.getCtx(),o=e.Agent.isRightToLeft(a),l=t._start,h=t._end;if(t._customTimeScales&&t._customTimeScales[t._scale])n=t._customTimeScales[t._scale].times;else if(t._customFormatScales&&t._customFormatScales[t._scale])n=t._customFormatScales[t._scale].times;else{n=[];var _=e.TimeAxis.getPositionDate(l,h,i,t._length),c=t._timeAxis.adjustDate(_),u=e.TimeAxis.getDatePosition(l,h,c,t._length);for(n.push(c.getTime());u<r;)c=t._timeAxis.getNextDate(c.getTime()),u=e.TimeAxis.getDatePosition(l,h,c,t._length),n.push(c.getTime())}for(var g=0;g<n.length-1;g++){var d=n[g];if(u=e.TimeAxis.getDatePosition(l,h,d,t._length),!t.isVertical()&&o)var m=t._length-u;else m=u;if(t.isVertical())var v=0,S=m,p=t._maxOverflowValue,f=m;else v=m,S=0,p=m,f=t._maxOverflowValue;var T=t.addTick(s,v,p,S,f,t._separatorStroke,"o_tick"+u);T.time=d,t._seriesTicksArray.push(T)}},d._renderReferenceObjects=function(t,i){var r=t.getCtx(),s=e.Agent.isRightToLeft(r);null==t._refObjectsContainer&&(t._refObjectsContainer=new e.Container(r),i.addChild(t._refObjectsContainer));var n=t._referenceObjects;if(n)for(var a=Math.min(1,n.length),o=0;o<a;o++){var h=n[o];if(h){var _=e.TimeAxis.getDatePosition(t._start,t._end,h,t._length);if(0==t._renderedReferenceObjects.length){if(t.isVertical())var c=new e.Line(r,0,_,t._maxOverflowValue,_,"zoomOrder[i]");else s&&(_=t._length-_),c=new e.Line(r,_,0,_,t._maxOverflowValue,"zoomOrder[i]");var u=new e.SolidStroke(l.getReferenceObjectColor(t.Options));c.setStroke(u),c.setPixelHinting(!0),c.date=h,t._refObjectsContainer.addChild(c),t._renderedReferenceObjects[o]=c}else(c=t._renderedReferenceObjects[o]).date=h,_=e.TimeAxis.getDatePosition(t._start,t._end,c.date,t._length),t.isVertical()?(c.setX1(0),c.setY1(_),c.setX2(t._maxOverflowValue),c.setY2(_)):(s&&(_=t._length-_),c.setX1(_),c.setY1(0),c.setX2(_),c.setY2(t._maxOverflowValue))}}else t._refObjectsContainer.removeChildren(),t._renderedReferenceObjects=[]},d._updateReferenceObjects=function(t){for(var i=t.getCtx(),r=e.Agent.isRightToLeft(i),s=0;s<t._renderedReferenceObjects.length;s++){var n=t._renderedReferenceObjects[s],a=e.TimeAxis.getDatePosition(t._start,t._end,n.date,t._length);t.isVertical()?(n.setX1(0),n.setY1(a),n.setX2(t._maxOverflowValue),n.setY2(a)):(r&&(a=t._length-a),n.setX1(a),n.setY1(0),n.setX2(a),n.setY2(t._maxOverflowValue))}},d._removeItems=function(e,t,i,r){if(r)d._animateItemRemoval(e,t,r);else for(var s=0;s<e.length;s++){var n=e[s],a=n.getBubble();if(i.removeChild(a),!t.isVertical()){var o=i.feelers,l=n.getFeeler();o.removeChild(l)}var h=n.getStartTime(),_=n.getEndTime();if(_&&_!=h){var c=i.durations,u=n.getDurationBar();c.removeChild(u)}}},d._animateItemRemoval=function(e,t,i){for(var r=0;r<e.length;r++){var s=e[r],n=s.getBubble();if(t.isVertical()?n.setTranslateX(n.getTranslateX()+t._canvasOffsetX+t._overflowOffset):n.setTranslateY(n.getTranslateY()+t._canvasOffsetY+t._overflowOffset),i.push(n),!t.isVertical()){var a=s.getFeeler();a.setTranslateY(a.getTranslateY()+t._canvasOffsetY+t._overflowOffset),i.push(a)}var o=s.getStartTime(),l=s.getEndTime();if(l&&l!=o){var h=s.getDurationBar();t.isVertical()?h.setTranslateX(h.getTranslateX()+t._canvasOffsetX+t._overflowOffset):h.setTranslateY(h.getTranslateY()+t._canvasOffsetY+t._overflowOffset),i.push(h)}}},e.exportProperty(e,"Timeline",e.Timeline),e.exportProperty(e.Timeline,"newInstance",e.Timeline.newInstance),e.exportProperty(e.Timeline.prototype,"render",e.Timeline.prototype.render),e.exportProperty(e.Timeline.prototype,"getAutomation",e.Timeline.prototype.getAutomation),e.exportProperty(e.Timeline.prototype,"select",e.Timeline.prototype.select),e.exportProperty(s.prototype,"getDomElementForSubId",s.prototype.getDomElementForSubId)}(e),e});
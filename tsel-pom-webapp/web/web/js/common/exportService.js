define(["xlsx-js","file-saverjs","blobjs","ojs/ojcore"],function(e){return new function(){var t=this;t.datenum=function(e,t){return t&&(e+=1462),(Date.parse(e)-new Date(Date.UTC(1899,11,29)))/864e5},t.sheet_from_array_of_arrays=function(r,a,n){var o={},i=0,s=0;for(i=0;i<r.length;++i){var l={v:r[i].headerText},f=e.utils.encode_cell({c:i,r:0});null!==l.v&&("number"==typeof l.v?l.t="n":"boolean"==typeof l.v?l.t="b":l.v instanceof Date?(l.t="n",l.z=e.SSF._table[14],l.v=t.datenum(l.v)):l.t="s"),o[f]=l}for(s=0;s<a.length;++s)for(i=0,i=0;i<r.length;++i)if(r[i].field){var c=void 0,v=void 0,d=!1;if(r[i].field.indexOf(".")>-1){var u=r[i].field.split(".");v=a[s][u[0]][u[1]]}else v=a[s][r[i].field];if(v||0===v)if(n)c=n(r[i].field,v);else if(r[i].renderer){var m=r[i].renderer.toString().trim().toLowerCase();m.includes("datetime")?c=dateTimeFormat(v):m.includes("datelas")?c=dateLASForamt(v):m.includes("date")?(c=dateFormat(v),d=!0):c=m.includes("active")?"Y"===c?"Active":"Inactive":m.includes("fourdecimals")?fourDecimalsFormat(v):v}else c=v;if(l={v:c},f=e.utils.encode_cell({c:i,r:s+1}),null!==l.v)if("number"==typeof l.v)l.t="n",l.z="#,##0.00";else if("boolean"==typeof l.v)l.t="b";else if(l.v instanceof Date||d){l.t="n",l.z=e.SSF._table[15];const r=t.datenum(l.v);l.v=parseInt(r.toString().split(".")[0])}else l.t="s";o[f]=l}var b={s:{c:0,r:0},e:{c:i-1,r:s}};return b.s.c<1e7&&(o["!ref"]=e.utils.encode_range(b)),o},t.sheet_from_array_of_arrays1=function(r,a,n,o){var i={},s=0,l=0,f={v:"MGP FI Summary Report",t:"s"};for(i.A1=f,s=0;s<a.length;++s)f={v:a[s].headerText},e.utils.encode_cell({c:s,r:0}),null!==f.v&&("number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.t="n",f.z=e.SSF._table[14],f.v=t.datenum(f.v)):f.t="s"),"multiple"!=r?0==s?i.A3=f:1==s?i.A4=f:2==s?i.A5=f:3==s?i.A6=f:4==s?i.A7=f:5==s?i.A8=f:6==s?i.A9=f:7==s?i.A10=f:8==s?i.A11=f:9==s?i.A12=f:10==s?i.D3=f:11==s?i.D4=f:12==s?i.D5=f:13==s?i.D6=f:14==s?i.D7=f:15==s?i.D8=f:16==s?i.D9=f:17==s?i.D10=f:18==s&&(i.D11=f):0==s?i.A3=f:1==s?i.A4=f:2==s?i.A5=f:3==s?i.A6=f:4==s?i.A7=f:5==s?i.A8=f:6==s?i.A9=f:8==s?i.A10=f:9==s?i.A11=f:10==s?i.D3=f:11==s?i.D4=f:12==s?i.D5=f:13==s?i.D6=f:14==s?i.D7=f:15==s?i.D8=f:16==s?i.D9=f:17==s?i.D10=f:18==s&&(i.D11=f);for(l=0;l<n.length;++l)for(s=0,s=0;s<a.length;++s)if(a[s].field){var c=void 0,v=void 0;if(a[s].field.indexOf(".")>-1){var d=a[s].field.split(".");v=n[l][d[0]][d[1]]}else v=n[l][a[s].field];if(v)if(o)c=o(a[s].field,v);else if(a[s].renderer){var u=a[s].renderer.toString().trim().toLowerCase();c=u.includes("currency")?currencyFormat(v):u.includes("datetime")?dateTimeFormat(v):u.includes("datelas")?dateLASForamt(v):u.includes("date")?dateFormat(v):u.includes("active")?"Y"===c?"Active":"Inactive":u.includes("fourdecimals")?fourDecimalsFormat(v):v}else c=v;f={v:c},e.utils.encode_cell({c:s,r:l+1}),null!==f.v&&("number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.t="n",f.z=e.SSF._table[14],f.v=t.datenum(f.v)):f.t="s"),"multiple"!=r?0==s?i.B3=f:1==s?i.B4=f:2==s?i.B5=f:3==s?i.B6=f:4==s?i.B7=f:5==s?i.B8=f:6==s?i.B9=f:7==s?i.B10=f:8==s?i.B11=f:9==s?i.B12=f:10==s?i.E3=f:11==s?i.E4=f:12==s?i.E5=f:13==s?i.E6=f:14==s?i.E7=f:15==s?i.E8=f:16==s?i.E9=f:17==s?i.E10=f:18==s&&(i.E11=f):0==s?i.B3=f:1==s?i.B4=f:2==s?i.B5=f:3==s?i.B6=f:4==s?i.B7=f:5==s?i.B8=f:6==s?i.B9=f:8==s?i.B10=f:9==s?i.B11=f:10==s?i.E3=f:11==s?i.E4=f:12==s?i.E5=f:13==s?i.E6=f:14==s?i.E7=f:15==s?i.E8=f:16==s?i.E9=f:17==s?i.E10=f:18==s&&(i.E11=f)}var m={s:{c:0,r:0},e:{c:18,r:13}};return m.s.c<1e7&&(i["!ref"]=e.utils.encode_range(m)),i},t.Workbook=function(){if(!(this instanceof t.Workbook))return new e.Workbook;this.SheetNames=[],this.Sheets={}},t.s2ab=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a<e.length;++a)r[a]=255&e.charCodeAt(a);return t},t.export=function(r,a,n,o,i){var s=new t.Workbook,l=t.sheet_from_array_of_arrays(r,a,i),f=void 0;if("csv"===n){f="text/plain";var c=e.utils.sheet_to_csv(l);saveAs(new Blob([t.s2ab(c)],{type:f}),o)}else"xlsx"===n&&(f="application/octet-stream",s.SheetNames.push("Data"),s.Sheets.Data=l,c=e.write(s,{bookType:n,bookSST:!0,type:"binary"}),saveAs(new Blob([t.s2ab(c)],{type:f}),o))},t.export1=function(r,a,n,o,i,s){var l=new t.Workbook,f=t.sheet_from_array_of_arrays1(r,a,n,s),c=void 0;if("csv"===o){c="text/plain";var v=e.utils.sheet_to_csv(f);saveAs(new Blob([t.s2ab(v)],{type:c}),i)}else"xlsx"===o&&(c="application/octet-stream",l.SheetNames.push("Data"),l.Sheets.Data=f,v=e.write(l,{bookType:o,bookSST:!0,type:"binary"}),saveAs(new Blob([t.s2ab(v)],{type:c}),i))},t.import=function(t){var r=e.read(t,{type:"array"}),a={};return r.SheetNames.forEach(function(t){var n=e.utils.sheet_to_row_object_array(r.Sheets[t]);n.length>0&&(a.data=n)}),a}}});
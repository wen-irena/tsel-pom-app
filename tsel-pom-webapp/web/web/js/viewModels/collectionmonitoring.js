define(["ojs/ojcore","knockout","jquery","../appController","common/constants","common/restService","common/rendererService","common/userInfo","libs/cm/lib/codemirror","libs/cm/mode/htmlmixed/htmlmixed","libs/cm/mode/xml/xml","libs/cm/addon/hint/show-hint","libs/cm/addon/hint/html-hint","libs/cm/addon/mode/loadmode","libs/cm/addon/selection/active-line","libs/cm/addon/edit/matchbrackets","libs/cm/addon/display/autorefresh","libs/vkbeautify/vkbeautify.0.99.00.beta","ojs/ojdatetimepicker","ojs/ojaccordion","ojs/ojcheckboxset","ojs/ojswitcher"],function(o,e,t,l,r,n,i,a,s){const m=this;return function(){m.collmonitoring_passedParam=o.Router.rootInstance.retrieve(),console.log(m.collmonitoring_passedParam),m.collmonitoring_isReadOnly=e.observable(a.isRoleReadOnly()),m.collmonitoring_customerID=e.observable(),m.collmonitoring_subscriberID=e.observable(),m.collmonitoring_msisdn=e.observable(),m.collmonitoring_actionStatus=e.observableArray(),m.collmonitoring_actionLOV=e.observableArray(),m.collmonitoring_statusStatus=e.observableArray(),m.collmonitoring_statusLOV=e.observableArray(),m.collmonitoring_target=e.observableArray(),m.collmonitoring_targetLOV=e.observableArray(),m.collmonitoring_requestPayload=e.observableArray(),m.collmonitoring_responsePayload=e.observableArray(),m.collmonitoring_errorMessage=e.observableArray();var l=new Date;l.setHours(l.getHours()-1,l.getMinutes(),0,0);var r=new Date;m.collmonitoring_startDate=e.observable(m.collmonitoring_passedParam?m.collmonitoring_passedParam.startDate:i.backenddateTimeConverter.format(o.IntlConverterUtils.dateToLocalIso(l))),m.collmonitoring_endDate=e.observable(m.collmonitoring_passedParam?m.collmonitoring_passedParam.endDate:i.backenddateTimeConverter.format(o.IntlConverterUtils.dateToLocalIso(r))),m.collmonitoring_action=function(){getRestData(n.getLOV,["lovName"],["LOV_COLMNT_ACTION"],function(o){if(o){let e=o.filter(o=>o.enable).map(o=>({label:o.lookupValue2,value:o.lookupValue2}));m.collmonitoring_actionLOV(e)}})},m.collmonitoring_action(),m.collmonitoring_status=function(){getRestData(n.getLOV,["lovName"],["LOV_COLMNT_STATUS"],function(o){if(o){let e=o.filter(o=>o.enable).map(o=>({label:o.lookupValue2,value:o.lookupValue2}));m.collmonitoring_statusLOV(e)}})},m.collmonitoring_status(),m.collmonitoring_targetFnc=function(){getRestData(n.getLOV,["lovName"],["LOV_COLMNT_TARGET"],function(o){if(o){let e=o.filter(o=>o.enable).map(o=>({label:o.lookupValue2,value:o.lookupValue2}));m.collmonitoring_targetLOV(e)}})},m.collmonitoring_targetFnc(),m.collmonitoring_fetchSize=e.observable("1000"),m.collmonitoring_dateTimeConverter=i.dateTimeConverter2,m.collmonitoring_dateTimeRenderer=function(o){return i.dateTimeRenderer(o)},m.collmonitoring_dateTimeRenderer2=function(o){return o?i.dateTimeRendererX(o):"-"},m.collmonitoring_columns=[{headerText:"",template:"action-template",sortable:"disabled"},{headerText:"Status",template:"status-template"},{headerText:"Customer ID",field:"customerId"},{headerText:"Subscriber ID",field:"subscriberId"},{headerText:"MSISDN",field:"msisdn"},{headerText:"Action",field:"action"},{headerText:"Target",field:"target"},{headerText:"Trx Date",field:"trxDate",renderer:m.collmonitoring_dateTimeRenderer}],m.collmonitoring_allData=e.observableArray(),m.collmonitoring_tableWidth=e.observable("100%"),m.collmonitoring_display="grid",m.collmonitoring_columnsDefault={sortable:"auto"},m.collmonitoring_scrollPolicy="loadMoreOnScroll",m.collmonitoring_scrollPolicyOptions={fetchSize:10},m.collmonitoring_rootAttributes={style:"width:100%;overflow-x: auto; overflow-y: hidden;"},m.collmonitoring_selectionMode={row:"single"},m.collmonitoring_datasource=new o.PagingTableDataSource(new o.ArrayTableDataSource(m.collmonitoring_allData,{idAttribute:"seq"})),m.selectedItems=e.observable([]),m.getIndexInSelectedItems=function(o){for(var e=0;e<m.selectedItems().length;e++){var t=m.selectedItems()[e],l=t.startIndex.row,r=t.endIndex.row;if(o>=l&&o<=r)return e}return-1},m.collmonitoring_viewDetail=function(o){t(".CodeMirror-wrap").remove(),t("#collmonitoring_requestPayload").val(vkbeautify.xml(o.requestPayload?o.requestPayload:"-")),s.fromTextArea(document.getElementById("collmonitoring_requestPayload"),{mode:"text/xml",theme:"default",lineNumbers:!0,lineWrapping:!0,readOnly:!0,autoRefresh:!0}).setSize("60vw","300px"),t("#collmonitoring_responsePayload").val(vkbeautify.xml(o.responsePayload?o.responsePayload:"-")),s.fromTextArea(document.getElementById("collmonitoring_responsePayload"),{mode:"text/xml",theme:"default",lineNumbers:!0,lineWrapping:!0,readOnly:!0,autoRefresh:!0}).setSize("60vw","300px"),t("#collmonitoring_errorMessage").val(vkbeautify.xml(o.errorMsg?o.errorMsg:"-")),m.collmonitoring_requestPayload(o.requestPayload),m.collmonitoring_responsePayload(o.responsePayload),m.collmonitoring_errorMessage(o.errorMsg),"ERROR"!==o.status?t(".error-message-area").hide():t(".error-message-area").show(),t("#detailDialog").ojDialog("open")},this.selectedItemOrders=e.observable("ori"),this.valueChangedHandler=function(o){var e=o.detail.value,l=o.detail.previousValue;t("#demo-container").addClass("demo-edge-"+e).removeClass("demo-edge-"+l)},m.collmonitoring_refreshData=function(){var o=[],e=[];m.collmonitoring_customerID&&m.collmonitoring_customerID()&&(o.push("customerId"),e.push(m.collmonitoring_customerID())),m.collmonitoring_subscriberID&&m.collmonitoring_subscriberID()&&(o.push("subscriberId"),e.push(m.collmonitoring_subscriberID())),m.collmonitoring_msisdn&&m.collmonitoring_msisdn()&&(o.push("msisdn"),e.push(m.collmonitoring_msisdn())),m.collmonitoring_actionStatus&&m.collmonitoring_actionStatus()&&(o.push("action"),e.push(m.collmonitoring_actionStatus())),m.collmonitoring_statusStatus&&m.collmonitoring_statusStatus()&&(o.push("status"),e.push(m.collmonitoring_statusStatus())),m.collmonitoring_target&&m.collmonitoring_target()&&(o.push("target"),e.push(m.collmonitoring_target())),m.collmonitoring_startDate&&m.collmonitoring_startDate()&&(o.push("startTrxDate"),e.push(m.collmonitoring_startDate())),m.collmonitoring_endDate&&m.collmonitoring_endDate()&&(o.push("endTrxDate"),e.push(m.collmonitoring_endDate())),getRestData(n.getCollectionMonitoring,o,e,function(o,e){"ERROR"!==o&&m.collmonitoring_allData(o.content)})},m.collmonitoring_onSearch=function(){m.collmonitoring_refreshData()},m.collmonitoring_onReset=function(){m.collmonitoring_customerID(void 0),m.collmonitoring_subscriberID(void 0),m.collmonitoring_msisdn(void 0),m.collmonitoring_actionStatus(""),m.collmonitoring_statusStatus("");var e=new Date;e.setHours(e.getHours()-1,e.getMinutes(),0,0);var t=new Date;m.collmonitoring_startDate(i.backenddateTimeConverter.format(o.IntlConverterUtils.dateToLocalIso(e))),m.collmonitoring_endDate(i.backenddateTimeConverter.format(o.IntlConverterUtils.dateToLocalIso(t))),m.collmonitoring_refreshData()},m.collmonitoring_msisdn(m.collmonitoring_passedParam?m.collmonitoring_passedParam.msisdn:null),m.collmonitoring_actionStatus(m.collmonitoring_passedParam?m.collmonitoring_passedParam.action:null),m.collmonitoring_target(m.collmonitoring_passedParam?m.collmonitoring_passedParam.target:null),m.collmonitoring_statusStatus(m.collmonitoring_passedParam?m.collmonitoring_passedParam.status:null),m.collmonitoring_refreshData()}});
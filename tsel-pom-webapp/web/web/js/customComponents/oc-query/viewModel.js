define(["knockout","jquery","common/exportService","ojs/ojcheckboxset"],function(o,e,l){function t(o,e,l){localStorage.setItem(encodeURIComponent(o),encodeURIComponent(e))}return function(r){var s=this;s.props,s.id=o.observable(),s.columns=o.observableArray(),s.columnList=o.observableArray(),s.columnDisplayed=o.observableArray(),s.componentOptions=o.observable(),s.showExport=o.observable(!1),s.showPrint=o.observable(!1),s.showColDisp=o.observable(!0),s.props=r.properties,s.tableId=o.pureComputed(function(){return"myTable"+s.props.id});var p=s.props.columns,n=s.props.slot;if(n){var a=n.toString();s.showExport(a.includes("export")),s.showPrint(a.includes("print")),s.showColDisp(a.includes("colDisp"))}s.columns(p);for(var i,d=[],u=[],c=[],f=JSON.parse((i=s.tableId(),localStorage.getItem(i)?decodeURIComponent(localStorage.getItem(i)):null)),m=0;m<p.length;m++)if(p[m].field&&d.push({label:p[m].headerText,field:p[m].field}),null!==f){if(p[m].field)for(var b=0;b<f.length;++b)p[m].field===f[b].field&&(u.push(p[m].field),c.push(p[m]));else c.push(p[m]);s.props.columns=c}else u.push(p[m].field);s.columnList(d),s.columnDisplayed(u),s.activated=function(o){var e={component:"ojTable",data:s.props.data,columns:s.props.columns};e.display=s.props.display?s.props.display:"grid",e.rootAttributes=s.props.rootAttributes?s.props.rootAttributes:{style:"width:100%;overflow-x: auto; overflow-y: hidden;"},e.selectionMode=s.props.selectionMode?s.props.selectionMode:{row:"single"},e.scrollPolicyOptions=s.props.scrollPolicyOptions?s.props.scrollPolicyOptions:"auto",e.columnsDefault=s.props.columnsDefault?s.props.columnsDefault:{sortable:"auto"},s.props.editMode&&(e.editMode=s.props.editMode),s.props.beforeCurrentRow&&(e.beforeCurrentRow=s.props.beforeCurrentRow),s.props.rowTemplate&&(e.rowTemplate=s.props.rowTemplate),s.componentOptions(e)},s.printData=function(){printContent("myPrint,page-title")},s.exportxls=function(){l.export(e(s.tableId()).ojTable("option","columns"),s.props.data.Md?s.props.data.Md.Ca.data:s.props.data.Ca.data?s.props.data.Ca.data:[],"xlsx","Data.xlsx")},s.onChangedSelection=function(o,l){var r,p=[];if(l.value.length>0)for(var n=0;n<s.columns().length;n++){var a=s.columns()[n];if(a.field){for(var i=0;i<l.value.length;i++)if(l.value[i]===a.field){p.push(a),t(s.tableId(),JSON.stringify(p));break}}else p.push(a)}else r=s.tableId(),localStorage.removeItem(r),console.log("hide");e(s.tableId()).ojTable({columns:p})},s.onChangedSelectionAll=function(){for(var o=[],l=[],r=0;r<s.columns().length;r++){var p=s.columns()[r];p.field?(o.push(p),l.push(p.field),t(s.tableId(),JSON.stringify(o))):o.push(p)}l.length>0&&s.columnDisplayed(l),e(s.tableId()).ojTable({columns:o})}}});
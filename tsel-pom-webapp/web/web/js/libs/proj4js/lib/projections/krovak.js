import adjust_lon from"../common/adjust_lon";export function init(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq};export function forward(t){var s,h,i,a,n,M,o,e=t.x,r=t.y,f=adjust_lon(e-this.long0);return s=Math.pow((1+this.e*Math.sin(r))/(1-this.e*Math.sin(r)),this.alfa*this.e/2),h=2*(Math.atan(this.k*Math.pow(Math.tan(r/2+this.s45),this.alfa)/s)-this.s45),i=-f*this.alfa,a=Math.asin(Math.cos(this.ad)*Math.sin(h)+Math.sin(this.ad)*Math.cos(h)*Math.cos(i)),n=Math.asin(Math.cos(h)*Math.sin(i)/Math.cos(a)),M=this.n*n,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(a/2+this.s45),this.n),t.y=o*Math.cos(M)/1,t.x=o*Math.sin(M)/1,this.czech||(t.y*=-1,t.x*=-1),t};export function inverse(t){var s,h,i,a,n,M,o,e=t.x;t.x=t.y,t.y=e,this.czech||(t.y*=-1,t.x*=-1),n=Math.sqrt(t.x*t.x+t.y*t.y),a=Math.atan2(t.y,t.x)/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/n,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),s=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(a)),h=Math.asin(Math.cos(i)*Math.sin(a)/Math.cos(s)),t.x=this.long0-h/this.alfa,M=s,o=0;var r=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(s/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(M))/(1-this.e*Math.sin(M)),this.e/2))-this.s45),Math.abs(M-t.y)<1e-10&&(o=1),M=t.y,r+=1}while(0===o&&r<15);return r>=15?null:t};export var names=["Krovak","krovak"];export default{init:init,forward:forward,inverse:inverse,names:names};